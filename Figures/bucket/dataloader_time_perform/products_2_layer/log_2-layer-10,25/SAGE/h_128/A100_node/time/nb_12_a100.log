main start at this time 1728784691.8915849
-----------------------------------------before load data 
 Nvidia-smi: 0.85455322265625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.85455322265625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

load pickle file time  0.4464130401611328
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
get_in_degree_bucketing dst global nid length 196571
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
total indegree bucketing result ,  196571
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.11368513107299805
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0003581047058105469
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013580322265625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.11426043510437012
self.has_zero_indegree_seeds  False
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  1.986495018005371
self.buckets_partition() spend  sec:  0.12786006927490234
dataloader gen time  11.20578408241272
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.41681575775146484  GigaBytes
Max Memory Allocated: 0.41681575775146484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 20.392528533935547  GigaBytes
Max Memory Allocated: 20.765356063842773  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 20.395452976226807  GigaBytes
Max Memory Allocated: 20.765356063842773  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.2537841796875 GB
    Memory Allocated: 0.4505605697631836  GigaBytes
Max Memory Allocated: 20.765356063842773  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 35.8358154296875 GB
    Memory Allocated: 20.76009225845337  GigaBytes
Max Memory Allocated: 21.14204740524292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 35.8358154296875 GB
    Memory Allocated: 20.76340913772583  GigaBytes
Max Memory Allocated: 21.14204740524292  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 35.8358154296875 GB
    Memory Allocated: 0.4608449935913086  GigaBytes
Max Memory Allocated: 21.14204740524292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 35.8416748046875 GB
    Memory Allocated: 20.7544264793396  GigaBytes
Max Memory Allocated: 21.14204740524292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 35.8416748046875 GB
    Memory Allocated: 20.75731658935547  GigaBytes
Max Memory Allocated: 21.14204740524292  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 35.8416748046875 GB
    Memory Allocated: 0.47576284408569336  GigaBytes
Max Memory Allocated: 21.14204740524292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.837674617767334  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.840670585632324  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 0.48546266555786133  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.80476188659668  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.80850315093994  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 0.4919314384460449  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.351386070251465  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.354590892791748  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 0.5069665908813477  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.760035514831543  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.762917041778564  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 0.5164322853088379  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.64725160598755  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.65013313293457  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 0.5270943641662598  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.646190643310547  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.648980617523193  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 0.5387492179870605  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.58513307571411  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.58878803253174  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 0.5482878684997559  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.562750816345215  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.566001415252686  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 0.5570363998413086  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.461949825286865  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.464818477630615  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 0.5921311378479004  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.20463228225708
pure train time :  3.024116277694702
train time :  5.150883436203003
end to end time :  16.356683254241943
end to end time  16.803664445877075
load pickle file time  0.5703232288360596
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
get_in_degree_bucketing dst global nid length 196571
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
total indegree bucketing result ,  196571
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.1152803897857666
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.00033545494079589844
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015746355056762695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.11575698852539062
self.has_zero_indegree_seeds  False
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  1.9838387966156006
self.buckets_partition() spend  sec:  0.13152289390563965
dataloader gen time  10.550580501556396
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 0.4510483741760254  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.472334384918213  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.463250637054443  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 0.45442914962768555  GigaBytes
Max Memory Allocated: 21.218603134155273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.84171152114868  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.845322132110596  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 0.46560001373291016  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.8020281791687  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 20.805269718170166  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7381591796875 GB
    Memory Allocated: 0.47730112075805664  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.77052116394043  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.773574829101562  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.48737287521362305  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.725764751434326  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.728760719299316  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.4972519874572754  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.43480348587036  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.437772750854492  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5129570960998535  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.804905891418457  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.80783176422119  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5215940475463867  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.607113361358643  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.610251426696777  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5336928367614746  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.59598445892334  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.598820209503174  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5447959899902344  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.558106422424316  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.560889720916748  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5571041107177734  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.636539459228516  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.639665126800537  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5646615028381348  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.511813640594482  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.514610290527344  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5963668823242188  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.474184036254883
pure train time :  1.5082216262817383
train time :  3.4297754764556885
end to end time :  13.980387926101685
end to end time  14.613415479660034
load pickle file time  0.421764612197876
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
get_in_degree_bucketing dst global nid length 196571
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
total indegree bucketing result ,  196571
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.11821317672729492
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0005352497100830078
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.019389629364013672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1189432144165039
self.has_zero_indegree_seeds  False
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.0431017875671387
self.buckets_partition() spend  sec:  0.13835430145263672
dataloader gen time  10.326655864715576
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.44954967498779297  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.41375207901001  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.405985355377197  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.45520687103271484  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.83098268508911  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.833911418914795  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.46526193618774414  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.80148696899414  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.80472183227539  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.4777212142944336  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.813071727752686  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.816067695617676  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.4893317222595215  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.798974990844727  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.801944255828857  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.4963045120239258  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.42507028579712  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.428040504455566  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5117096900939941  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.763293266296387  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.766174793243408  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5229477882385254  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.70074987411499  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.703539848327637  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5310120582580566  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.57118272781372  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.574907779693604  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5440664291381836  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.627156734466553  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.630282402038574  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5526304244995117  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.509904861450195  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.512794017791748  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5653023719787598  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.514840126037598  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.51762294769287  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5982770919799805  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7354300022125244
pure train time :  1.5100512504577637
train time :  3.451948642730713
end to end time :  13.778620719909668
end to end time  14.263541221618652
load pickle file time  0.45729732513427734
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
get_in_degree_bucketing dst global nid length 196571
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
total indegree bucketing result ,  196571
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.11190080642700195
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0004012584686279297
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.020946979522705078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.11244487762451172
self.has_zero_indegree_seeds  False
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.0083420276641846
self.buckets_partition() spend  sec:  0.13341283798217773
dataloader gen time  10.71377420425415
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.44889020919799805  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.415072441101074  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.4065580368042  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.4544644355773926  GigaBytes
Max Memory Allocated: 21.22314214706421  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.84172487258911  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.844653606414795  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.4632749557495117  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.752649307250977  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.75570297241211  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.47464418411254883  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.77260446548462  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.77560043334961  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.4857807159423828  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.737125396728516  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.740151405334473  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.49500322341918945  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.410157203674316  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.413126468658447  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.512824535369873  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.764521598815918  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.767666339874268  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.521392822265625  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.643433094024658  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.646777153015137  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5317344665527344  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.655324459075928  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.658130168914795  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5428881645202637  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.651948928833008  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.65532159805298  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5540647506713867  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.583250045776367  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.586622714996338  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.5626645088195801  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.474541664123535  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.47776174545288  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.595421314239502  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2323992252349854
pure train time :  1.5048646926879883
train time :  3.4236133098602295
end to end time :  14.137406349182129
end to end time  14.660224437713623
load pickle file time  0.2950785160064697
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
get_in_degree_bucketing dst global nid length 196571
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
total indegree bucketing result ,  196571
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.11832380294799805
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0007386207580566406
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.018514156341552734
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.11924242973327637
self.has_zero_indegree_seeds  False
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.0148003101348877
self.buckets_partition() spend  sec:  0.13777875900268555
dataloader gen time  10.202255725860596
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.4505782127380371  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.466627597808838  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.457638263702393  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.45313453674316406  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.76706314086914  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 20.769991874694824  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 47.7479248046875 GB
    Memory Allocated: 0.4673895835876465  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 49.2830810546875 GB
    Memory Allocated: 20.82274055480957  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 49.2830810546875 GB
    Memory Allocated: 20.825669288635254  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 49.2830810546875 GB
    Memory Allocated: 0.47995662689208984  GigaBytes
Max Memory Allocated: 21.223155975341797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.889901638031006  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.892897605895996  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.48944950103759766  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.811144828796387  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.814114093780518  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.4985218048095703  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.37710428237915  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.38007354736328  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5145339965820312  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.722362518310547  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.725566387176514  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.524756908416748  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.686906337738037  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.68978786468506  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5350933074951172  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.568572521209717  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.571362495422363  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5478310585021973  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.60880184173584  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.61158514022827  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5593528747558594  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.578629970550537  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.581419944763184  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5694141387939453  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.514092922210693  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.516931533813477  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5998411178588867  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7787280082702637
pure train time :  1.515526533126831
train time :  3.404553174972534
end to end time :  13.60682463645935
end to end time  13.964574337005615
load pickle file time  0.3362908363342285
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
get_in_degree_bucketing dst global nid length 196571
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
total indegree bucketing result ,  196571
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.11688446998596191
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0004658699035644531
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0199282169342041
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.11751389503479004
self.has_zero_indegree_seeds  False
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.0080907344818115
self.buckets_partition() spend  sec:  0.13746166229248047
dataloader gen time  10.719725847244263
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.4494590759277344  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.437427043914795  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.43080711364746  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.45156002044677734  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.771063804626465  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.77399253845215  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.464292049407959  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.76701545715332  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.76990556716919  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.47536706924438477  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.834438800811768  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.83772325515747  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.48743104934692383  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.78201961517334  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.78498888015747  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.4935288429260254  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.38137197494507  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.385079860687256  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5100188255310059  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.81229066848755  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.816023349761963  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5203824043273926  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.624359607696533  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.627708911895752  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.529757022857666  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.547641277313232  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.550804138183594  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5409102439880371  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.624420166015625  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.62720012664795  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5544571876525879  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.578364849090576  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.581679344177246  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5647110939025879  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.55326509475708  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.556867122650146  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5964465141296387  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.55201256275177
pure train time :  1.5730326175689697
train time :  3.5816357135772705
end to end time :  14.301380634307861
end to end time  14.704748392105103
load pickle file time  0.2913992404937744
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
get_in_degree_bucketing dst global nid length 196571
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
total indegree bucketing result ,  196571
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.11943817138671875
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0003857612609863281
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01813983917236328
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.11997246742248535
self.has_zero_indegree_seeds  False
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.0160462856292725
self.buckets_partition() spend  sec:  0.13813328742980957
dataloader gen time  10.589255809783936
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.4480404853820801  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.42506504058838  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.417442321777344  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.45377063751220703  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.79277992248535  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.796040534973145  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.46331071853637695  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.736855506896973  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.739745616912842  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.47497987747192383  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.778470993041992  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.781466960906982  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.4880099296569824  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.76956033706665  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.77252960205078  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.49690866470336914  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.373894691467285  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.377670764923096  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5128293037414551  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.828367710113525  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.831249237060547  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5199041366577148  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.684722423553467  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.687639713287354  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5309734344482422  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.66142988204956  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.66433334350586  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5407705307006836  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.558912754058838  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.56192970275879  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5527739524841309  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.5558500289917  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.558629035949707  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5629816055297852  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.51961660385132  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.523000240325928  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.5945062637329102  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.395038366317749
pure train time :  1.4939112663269043
train time :  3.3788506984710693
end to end time :  13.968132257461548
end to end time  14.326221227645874
load pickle file time  0.17142820358276367
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
get_in_degree_bucketing dst global nid length 196571
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
total indegree bucketing result ,  196571
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.1201629638671875
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0007636547088623047
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.019917964935302734
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12111735343933105
self.has_zero_indegree_seeds  False
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.040398120880127
self.buckets_partition() spend  sec:  0.14105701446533203
dataloader gen time  10.334516286849976
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.4488973617553711  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.365050315856934  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.357439517974854  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.45360517501831055  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.777367115020752  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.780295848846436  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.46535682678222656  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.793031692504883  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 20.795921802520752  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.4998779296875 GB
    Memory Allocated: 0.4755239486694336  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.748297214508057  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.751293182373047  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.4867568016052246  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.81084966659546  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.81381893157959  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.49411487579345703  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.432838916778564  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.435808181762695  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5066747665405273  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.710299968719482  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.713181495666504  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5176448822021484  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.643817901611328  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.64669942855835  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5299439430236816  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.655158042907715  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.65793800354004  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5394883155822754  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.540501594543457  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.543280601501465  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5503296852111816  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.5755558013916  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.57833433151245  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5605182647705078  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.51460313796997  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.51790952682495  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5912504196166992  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2714508771896362
pure train time :  1.4971189498901367
train time :  3.3856077194213867
end to end time :  13.720141649246216
end to end time  13.958260297775269
load pickle file time  0.2940487861633301
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
get_in_degree_bucketing dst global nid length 196571
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
total indegree bucketing result ,  196571
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.11916780471801758
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0004189014434814453
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.019022464752197266
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.11974048614501953
self.has_zero_indegree_seeds  False
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.024371862411499
self.buckets_partition() spend  sec:  0.13949155807495117
dataloader gen time  10.344578504562378
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.4481382369995117  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.416019439697266  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.408550262451172  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.4541959762573242  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.813698291778564  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.816627025604248  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.4653759002685547  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.771218299865723  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.774108409881592  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.47856664657592773  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.82832622528076  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.831322193145752  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.48965024948120117  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.810282230377197  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.81364870071411  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.49842166900634766  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.445926666259766  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.44925594329834  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5133261680603027  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.77142095565796  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.774677753448486  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5217690467834473  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.682011604309082  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.68480157852173  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5326642990112305  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.628004550933838  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.63081932067871  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5440540313720703  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.556959629058838  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.559738636016846  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5539274215698242  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.555765628814697  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.558544635772705  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5644559860229492  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.50746726989746  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.510250091552734  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5966963768005371  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1767690181732178
pure train time :  1.5049846172332764
train time :  3.394432783126831
end to end time :  13.739028692245483
end to end time  14.100449800491333
load pickle file time  0.2996490001678467
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
get_in_degree_bucketing dst global nid length 196571
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
total indegree bucketing result ,  196571
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.11912012100219727
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0003523826599121094
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016435861587524414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.11962413787841797
self.has_zero_indegree_seeds  False
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.0405240058898926
self.buckets_partition() spend  sec:  0.13608026504516602
dataloader gen time  10.587780475616455
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.44901514053344727  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.385127067565918  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.376518726348877  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.4544534683227539  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.836153507232666  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.83908224105835  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.4655003547668457  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.798300743103027  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.80122947692871  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.47669458389282227  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.788135051727295  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.79175043106079  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.48844003677368164  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.779258251190186  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.78296709060669  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.49643802642822266  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.37767791748047  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.380603790283203  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5114517211914062  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.812716484069824  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.815598011016846  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5193867683410645  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.63899278640747  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.641782760620117  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.530663013458252  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.67906141281128  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.681841373443604  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5411920547485352  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.55366325378418  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.556442260742188  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.553410530090332  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.577670097351074  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.58117389678955  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5625133514404297  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.50896120071411  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 20.511744022369385  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 51.5018310546875 GB
    Memory Allocated: 0.5947747230529785  GigaBytes
Max Memory Allocated: 21.270814895629883  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0778132677078247
pure train time :  1.493321418762207
train time :  3.4242851734161377
end to end time :  14.012080430984497
end to end time  14.37712025642395
Total (block generation + training)time/epoch 14.29879982130868
Total (block generation + training)time/epoch all [16.803664445877075, 14.613415479660034, 14.263541221618652, 14.660224437713623, 13.964574337005615, 14.704748392105103, 14.326221227645874, 13.958260297775269, 14.100449800491333, 14.37712025642395]
pure train time per /epoch  [3.024116277694702, 1.5082216262817383, 1.5100512504577637, 1.5048646926879883, 1.515526533126831, 1.5730326175689697, 1.4939112663269043, 1.4971189498901367, 1.5049846172332764, 1.493321418762207]
pure train time average  1.5118228707994734
dataloader time  [11.20578408241272, 10.550580501556396, 10.326655864715576, 10.71377420425415, 10.202255725860596, 10.719725847244263, 10.589255809783936, 10.334516286849976, 10.344578504562378, 10.587780475616455]
dataloader time avg per epoch 10.463018774986267

input num list  [12584898, 12585491, 12583640, 12581644, 12586964, 12587046, 12584426, 12582118, 12585168, 12582637]
      backpack schedule time  [2.0394070148468018, 2.056173086166382, 2.120396137237549, 2.068483352661133, 2.0833373069763184, 2.0675179958343506, 2.081181287765503, 2.1017367839813232, 2.0829694271087646, 2.105834484100342]
------backpack schedule time avg 2.0870962142944336
		connection_check_time_list  [6.048874616622925, 5.414495229721069, 5.023376703262329, 5.581143379211426, 5.1799232959747314, 5.281519889831543, 5.6167051792144775, 5.235736846923828, 5.251426458358765, 5.538694620132446]
------connection_check time avg 5.350667715072632
		block_gen_time_list  [2.5559144020080566, 2.4984512329101562, 2.6201295852661133, 2.4919686317443848, 2.3819687366485596, 2.8108372688293457, 2.3439667224884033, 2.44692063331604, 2.468813419342041, 2.402283191680908]
------block gen time avg 2.47579832871755
