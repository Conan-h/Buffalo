main start at this time 1713749059.0842419
-----------------------------------------before load data 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
# Nodes: 111059956
# Edges: 1615685872
# Train: 1207179
# Val: 125265
# Test: 109727512
# Classes: 172

----------------------------------------start of run function 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  2.1966466903686523
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.0019061565399169922
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03702807426452637
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.1988871097564697
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  13.614519357681274
self.buckets_partition() spend  sec:  2.235945701599121
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.81927490234375 GB
    Memory Allocated: 0.5831727981567383  GigaBytes
Max Memory Allocated: 0.5831727981567383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.13958740234375 GB
    Memory Allocated: 25.606525421142578  GigaBytes
Max Memory Allocated: 26.272823333740234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 28.13958740234375 GB
    Memory Allocated: 25.626057624816895  GigaBytes
Max Memory Allocated: 26.272823333740234  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.61029052734375 GB
    Memory Allocated: 0.6277527809143066  GigaBytes
Max Memory Allocated: 26.272823333740234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 29.40521240234375 GB
    Memory Allocated: 25.476987838745117  GigaBytes
Max Memory Allocated: 26.272823333740234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 29.40521240234375 GB
    Memory Allocated: 25.494174003601074  GigaBytes
Max Memory Allocated: 26.272823333740234  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 29.40521240234375 GB
    Memory Allocated: 0.6461009979248047  GigaBytes
Max Memory Allocated: 26.272823333740234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.36029052734375 GB
    Memory Allocated: 25.73319721221924  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.36029052734375 GB
    Memory Allocated: 25.754748344421387  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 0.6520133018493652  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 25.371443271636963  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 25.387244701385498  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 0.6681747436523438  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 25.593688488006592  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 25.611726760864258  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 0.6779971122741699  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 25.434038639068604  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 25.45045042037964  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 0.696526050567627  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 25.665164470672607  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 25.685269832611084  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 0.6997241973876953  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 25.074965476989746  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 25.0895357131958  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82122802734375 GB
    Memory Allocated: 0.7200303077697754  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 25.48613977432251  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 25.50911235809326  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 0.7269010543823242  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 25.04004430770874  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 25.0549373626709  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 0.7283945083618164  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 24.945311546325684  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 24.95885705947876  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 0.7558960914611816  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 25.44916582107544  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 25.474135875701904  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 0.762688159942627  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 24.95591449737549  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 24.969836235046387  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 0.7593979835510254  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 24.8478946685791  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 24.86102056503296  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 0.7935914993286133  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 25.214113235473633  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 25.24120044708252  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 0.7948126792907715  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 24.516027450561523  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 24.528611183166504  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 0.7875633239746094  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 24.430686950683594  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 24.442920207977295  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 0.8402843475341797  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 25.076425075531006  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 25.106499195098877  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 0.8264303207397461  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 24.281747817993164  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 24.293604373931885  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82318115234375 GB
    Memory Allocated: 0.8582763671875  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82708740234375 GB
    Memory Allocated: 24.63882827758789  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82708740234375 GB
    Memory Allocated: 24.672749042510986  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82708740234375 GB
    Memory Allocated: 0.8938417434692383  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82708740234375 GB
    Memory Allocated: 24.186455249786377  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.82708740234375 GB
    Memory Allocated: 24.225494861602783  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.82708740234375 GB
    Memory Allocated: 0.9158148765563965  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 23.65263271331787  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 23.69982099533081  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.9293718338012695  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 22.838736534118652  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 22.900218963623047  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.9479374885559082  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 21.299204349517822  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 21.39003324508667  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

number of input  27712796
----------------------------------------after optimizer
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 1.0038471221923828  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.092710971832275
pure train time :  5.084465265274048
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  2.3041601181030273
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.0022399425506591797
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04594612121582031
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.306649684906006
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  14.188779592514038
self.buckets_partition() spend  sec:  2.3526370525360107
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.705683708190918  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.645463466644287  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.653305530548096  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.6352791786193848  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.460265636444092  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.47745180130005  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.6503410339355469  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.681727409362793  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.70327854156494  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.6621427536010742  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.428415775299072  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.444217205047607  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.671226978302002  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.579509258270264  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.59754753112793  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.6837401390075684  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.434160709381104  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.45057249069214  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.7005038261413574  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.641720294952393  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.66182565689087  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.7067413330078125  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.07539939880371  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.089969635009766  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.726776123046875  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.50402593612671  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.52699851989746  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.7348494529724121  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.076868534088135  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.091761589050293  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.7319340705871582  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 24.925344944000244  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 24.939823150634766  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.7683148384094238  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.48790454864502  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.513288021087646  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.7717857360839844  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 24.98022747039795  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 24.994149208068848  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.7701573371887207  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 24.896331787109375  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 24.909457683563232  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.8051438331604004  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.205586433410645  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.23267364501953  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.8039789199829102  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 24.54069995880127  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 24.55328369140625  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.7996382713317871  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 24.44877862930298  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 24.46101188659668  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.845339298248291  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.05205249786377  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 25.08212661743164  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.8347482681274414  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 24.260648250579834  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 24.272504806518555  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83099365234375 GB
    Memory Allocated: 0.8694338798522949  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83294677734375 GB
    Memory Allocated: 24.639729022979736  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83294677734375 GB
    Memory Allocated: 24.673710823059082  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83294677734375 GB
    Memory Allocated: 0.9054837226867676  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83489990234375 GB
    Memory Allocated: 24.208680629730225  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83489990234375 GB
    Memory Allocated: 24.24772024154663  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83489990234375 GB
    Memory Allocated: 0.9236302375793457  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83489990234375 GB
    Memory Allocated: 23.66936683654785  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83489990234375 GB
    Memory Allocated: 23.71655511856079  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83489990234375 GB
    Memory Allocated: 0.9429230690002441  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 22.891204833984375  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 22.95268726348877  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9547667503356934  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.305490970611572  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.39631986618042  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

number of input  27710988
----------------------------------------after optimizer
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 1.0047187805175781  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7520809173583984
pure train time :  3.2784359455108643
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  2.374220848083496
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.002878427505493164
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0616765022277832
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.377764940261841
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  14.239934206008911
self.buckets_partition() spend  sec:  2.4395174980163574
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7054800987243652  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.636001586914062  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.64392614364624  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6319561004638672  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.427462100982666  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.444648265838623  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6522407531738281  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.684603214263916  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.706154346466064  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.657351016998291  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.32685899734497  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.342660427093506  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6705060005187988  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.54469633102417  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.562734603881836  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6855559349060059  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.471881866455078  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.488293647766113  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7020363807678223  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.704468250274658  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.724573612213135  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7043471336364746  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.074435710906982  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.089005947113037  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7259807586669922  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.471232891082764  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.494205474853516  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7327728271484375  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.023080348968506  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.037973403930664  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7338380813598633  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.91500473022461  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.92948293685913  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7717761993408203  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.555630683898926  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.581061840057373  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7740850448608398  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.982940196990967  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.996861934661865  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7693614959716797  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.84354019165039  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.856666088104248  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8031888008117676  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.185914993286133  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.21300220489502  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8029994964599609  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.53853464126587  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.55111837387085  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7992591857910156  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.49287223815918  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.50545597076416  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8435850143432617  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.039727210998535  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.069801330566406  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8339858055114746  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.269121646881104  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.280978202819824  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8703994750976562  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.712093353271484  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.746178150177002  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.901850700378418  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.20814275741577  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.247182369232178  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9186530113220215  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 23.63383197784424  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 23.681020259857178  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9430127143859863  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 22.948144912719727  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 23.00962734222412  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9550004005432129  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.3475604057312  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.43838930130005  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

number of input  27706028
----------------------------------------after optimizer
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 1.0042452812194824  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.5525190830230713
pure train time :  3.316195487976074
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  2.1838037967681885
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.0032112598419189453
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03777909278869629
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.187361001968384
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  13.790035486221313
self.buckets_partition() spend  sec:  2.2252252101898193
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7045845985412598  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.636223316192627  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.64436674118042  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6358728408813477  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.456071376800537  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.473257541656494  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6538386344909668  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.710625648498535  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.732176780700684  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6591453552246094  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.412585258483887  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.428386688232422  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6755886077880859  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.6210880279541  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.639126300811768  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6825308799743652  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.417394161224365  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.4338059425354  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6996455192565918  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.680501461029053  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.70060682296753  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7065792083740234  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.084723949432373  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.099207401275635  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7261037826538086  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.473772525787354  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.496745109558105  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7300376892089844  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.999911308288574  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.014804363250732  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.733184814453125  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.924296379089355  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.938774585723877  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7653841972351074  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.502602100372314  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.528082847595215  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7693400382995605  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.987587928771973  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.00150966644287  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7672357559204102  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.82382297515869  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.83694887161255  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8067183494567871  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.27727746963501  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.304364681243896  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7994623184204102  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.493982791900635  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.506566524505615  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7946557998657227  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.426405906677246  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.438639163970947  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8438782691955566  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.046467781066895  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.076541900634766  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8340601921081543  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.235934257507324  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.247790813446045  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8675861358642578  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.63713026046753  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.670982360839844  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9029436111450195  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.197484493255615  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.23652410507202  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9207239151000977  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 23.65423822402954  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 23.70142650604248  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9399476051330566  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 22.86746597290039  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 22.928948402404785  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9561481475830078  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.30974245071411  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.40057134628296  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

number of input  27704787
----------------------------------------after optimizer
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 1.0058388710021973  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3699612617492676
pure train time :  3.3372817039489746
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  3.2416982650756836
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.002662181854248047
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027396440505981445
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2446346282958984
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  15.305855989456177
self.buckets_partition() spend  sec:  3.272067070007324
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7035231590270996  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.623072624206543  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.630671977996826  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6296100616455078  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.36458396911621  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.381770133972168  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6512856483459473  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.691973209381104  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.713524341583252  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6587390899658203  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.425930976867676  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.44173240661621  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6743478775024414  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.58220386505127  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.600242137908936  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6836452484130859  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.44587278366089  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.462284564971924  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6959295272827148  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.618021488189697  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.638126850128174  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7070298194885254  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.138171195983887  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.15265464782715  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7231183052062988  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.47227191925049  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.49524450302124  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7340340614318848  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.060242652893066  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.075135707855225  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7323098182678223  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.894758224487305  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.909236431121826  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7684512138366699  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.502779006958008  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.528269290924072  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7696285247802734  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.923277854919434  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.937199592590332  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7727313041687012  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.917885780334473  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.93101167678833  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8081564903259277  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.26313352584839  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.290220737457275  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8019814491271973  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.52197027206421  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.53455400466919  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7962284088134766  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.426976203918457  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.439209461212158  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8426141738891602  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.051020622253418  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.08109474182129  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8343620300292969  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.27940607070923  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.29126262664795  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8704423904418945  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.665921688079834  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.699708938598633  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9037976264953613  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.234140872955322  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.27318048477173  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9250617027282715  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 23.661753177642822  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 23.70894145965576  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9423003196716309  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 22.89527988433838  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 22.956762313842773  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9595861434936523  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.347000122070312  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.43782901763916  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

number of input  27709679
----------------------------------------after optimizer
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 1.0095462799072266  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.100684642791748
pure train time :  3.3259048461914062
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  2.2134737968444824
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.003060579299926758
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030817747116088867
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.2168056964874268
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  13.899744033813477
self.buckets_partition() spend  sec:  2.247663974761963
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7027807235717773  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.63786506652832  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.645407676696777  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6372103691101074  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.506133556365967  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.523319721221924  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6517062187194824  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.712329864501953  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.7338809967041  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6589722633361816  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.405319690704346  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.42112112045288  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6691403388977051  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.50053882598877  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.518577098846436  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6845302581787109  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.463293075561523  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.47970485687256  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.701085090637207  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.70415210723877  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.724257469177246  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7016620635986328  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.049630641937256  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.064114093780518  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.72564697265625  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.5246262550354  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.547598838806152  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7267847061157227  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.983872413635254  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.998765468597412  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7352142333984375  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.934756755828857  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.94923496246338  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7678346633911133  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.530877590179443  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.555847644805908  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.773902416229248  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.977975368499756  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.991897106170654  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7711620330810547  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.851722240447998  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.864848136901855  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8077058792114258  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.296671390533447  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.324313163757324  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8068752288818359  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.566608428955078  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.57919216156006  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7975835800170898  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.426025390625  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.43860912322998  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8443326950073242  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.02880859375  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.05888271331787  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8371458053588867  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.264946460723877  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.276803016662598  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8751425743103027  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.706298828125  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.73999834060669  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9034938812255859  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.158381462097168  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.19773244857788  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9218859672546387  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 23.661253929138184  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 23.708442211151123  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9401154518127441  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 22.857202529907227  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 22.91868495941162  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9563045501708984  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.313264846801758  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.404093742370605  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

number of input  27706010
----------------------------------------after optimizer
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 1.00620698928833  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.866791009902954
pure train time :  3.43239164352417
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  3.2252070903778076
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.002193927764892578
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02646017074584961
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2276487350463867
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  15.143800973892212
self.buckets_partition() spend  sec:  3.254143476486206
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7041735649108887  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.566039085388184  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.574260234832764  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6352672576904297  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.507503032684326  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.524689197540283  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6524357795715332  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.700766563415527  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.722317695617676  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6594252586364746  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.358359336853027  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.374160766601562  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.673151969909668  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.56317377090454  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.58174991607666  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6849737167358398  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.427593231201172  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.444005012512207  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7008013725280762  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.677944660186768  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.698050022125244  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7074875831604004  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.06642484664917  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.080995082855225  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7270627021789551  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.49817943572998  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.521152019500732  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7353019714355469  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.057478427886963  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.07237148284912  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.733924388885498  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.92365598678589  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.93813419342041  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7704386711120605  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.503700256347656  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.529064655303955  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7706451416015625  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.984135627746582  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.99805736541748  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7712888717651367  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.870063304901123  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.88318920135498  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8035187721252441  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.2064471244812  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.233534336090088  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8014640808105469  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.531888961791992  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.544472694396973  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7954483032226562  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.408477783203125  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.421061515808105  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8452515602111816  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.087664127349854  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.117738246917725  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8331818580627441  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.245778560638428  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.25763511657715  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8715238571166992  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.67185688018799  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.705934047698975  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9043402671813965  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.2201247215271  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.259164333343506  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9229326248168945  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 23.645788192749023  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 23.692976474761963  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9438018798828125  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 22.89921808242798  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 22.960700511932373  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9556632041931152  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.27374792098999  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.364576816558838  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

number of input  27705823
----------------------------------------after optimizer
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 1.0076098442077637  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6505613327026367
pure train time :  3.390972375869751
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  3.3080391883850098
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.0027701854705810547
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.031088590621948242
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3111021518707275
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  15.22034764289856
self.buckets_partition() spend  sec:  3.3422255516052246
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7044229507446289  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.581305027008057  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.587100982666016  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6361703872680664  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.495553970336914  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.51274013519287  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6529941558837891  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.70754098892212  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.729092121124268  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6578593254089355  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.39006996154785  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.405871391296387  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6719398498535156  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.539674282073975  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.55771255493164  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6855144500732422  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.425397872924805  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.44180965423584  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.6996974945068359  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.584370136260986  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.604475498199463  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7085022926330566  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.0893874168396  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.103957653045654  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7266340255737305  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.469026565551758  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.49199914932251  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7341175079345703  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.03732442855835  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.052217483520508  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7346973419189453  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.93291997909546  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.946465492248535  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7696475982666016  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.545152187347412  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.570122241973877  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7732276916503906  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.00211000442505  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.016031742095947  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7718815803527832  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.89160442352295  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.904730319976807  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8075871467590332  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.21314811706543  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.240235328674316  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8031907081604004  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.520506858825684  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.533090591430664  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7977924346923828  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.440911293029785  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.453144550323486  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8467717170715332  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.07191801071167  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 25.10199213027954  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8344855308532715  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.278376579284668  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.29023313522339  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.8688254356384277  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.687853813171387  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.721770763397217  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9019918441772461  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.170090675354004  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 24.20913028717041  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.919888973236084  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 23.621878147125244  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 23.669066429138184  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9417991638183594  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 22.92314577102661  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 22.984628200531006  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.9583444595336914  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.32087230682373  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 21.411701202392578  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

number of input  27708651
----------------------------------------after optimizer
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 1.0081119537353516  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5215704441070557
pure train time :  3.4326305389404297
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  2.9137423038482666
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.002168416976928711
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03598952293395996
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.9161782264709473
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  14.580956220626831
self.buckets_partition() spend  sec:  2.9521989822387695
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.83685302734375 GB
    Memory Allocated: 0.7088956832885742  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.65125274658203  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.658554077148438  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.6327142715454102  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.474578380584717  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.491764545440674  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.6529827117919922  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.719711780548096  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.741262912750244  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.6616654396057129  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.43110942840576  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.446910858154297  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.675227165222168  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.641984939575195  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.66002321243286  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.6840634346008301  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.437089920043945  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.45350170135498  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.6993575096130371  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.69477415084839  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.714879512786865  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.703223705291748  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.048226356506348  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.06270980834961  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.7258200645446777  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.52937936782837  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.55235195159912  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.7312154769897461  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.046874523162842  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.061767578125  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.7317547798156738  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.938512325286865  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.952990531921387  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.7665696144104004  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.531484127044678  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.55685806274414  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.7691531181335449  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.959359169006348  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.973280906677246  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.7607054710388184  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.7534441947937  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.76657009124756  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.8010468482971191  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.21768808364868  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.24477529525757  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.8015203475952148  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.54543924331665  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.55802297592163  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.7924113273620605  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.391374588012695  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.403607845306396  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.8378477096557617  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.010703086853027  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.0407772064209  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.8317503929138184  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.204873085021973  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.216729640960693  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.8661203384399414  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.653693199157715  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.687522411346436  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.9000658988952637  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.177792072296143  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 24.21683168411255  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.9177865982055664  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 23.626200199127197  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 23.673388481140137  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.9375677108764648  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 22.88078260421753  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 22.942265033721924  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.9567990303039551  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 21.33401107788086  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 21.424839973449707  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

number of input  27707390
----------------------------------------after optimizer
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 1.0063886642456055  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4962868690490723
pure train time :  3.467796802520752
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  3.182852029800415
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.004868268966674805
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030969858169555664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.18800950050354
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  14.93068242073059
self.buckets_partition() spend  sec:  3.219024658203125
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.704068660736084  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.6312575340271  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.638927936553955  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.6333961486816406  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.422844886779785  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 25.440031051635742  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.63372802734375 GB
    Memory Allocated: 0.6554160118103027  GigaBytes
Max Memory Allocated: 26.409430503845215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.76545476913452  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.78700590133667  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6590209007263184  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.364713668823242  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.380515098571777  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6719799041748047  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.57096529006958  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.589003562927246  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6856689453125  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.451297760009766  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.4677095413208  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.699699878692627  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.601317882537842  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.62142324447632  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7054839134216309  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.106157779693604  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.120728015899658  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7258071899414062  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.51359224319458  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.536564826965332  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7339749336242676  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.061495780944824  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.076388835906982  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.734896183013916  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.954402446746826  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.967947959899902  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7670121192932129  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.529469966888428  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.554861068725586  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7708601951599121  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.97905683517456  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.99297857284546  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7699265480041504  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.872429847717285  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.885555744171143  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.804419994354248  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.229304790496826  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.25727653503418  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8005084991455078  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.480640411376953  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.493224143981934  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7948522567749023  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.45052194595337  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.46275520324707  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.843043327331543  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.095946311950684  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.126020431518555  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.832005500793457  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.26982879638672  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.28168535232544  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8696112632751465  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.64300775527954  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.676852226257324  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9032859802246094  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.217588424682617  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.256628036499023  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9217958450317383  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.661423683166504  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.708611965179443  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9390988349914551  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.913551807403564  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.97503423690796  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9534554481506348  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.28717565536499  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.378004550933838  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

number of input  27704175
----------------------------------------after optimizer
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 1.0042986869812012  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.29379940032959
pure train time :  3.477670669555664
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  2.352586507797241
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.003889322280883789
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.028165102005004883
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.356721878051758
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  14.009159088134766
self.buckets_partition() spend  sec:  2.3849313259124756
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7031035423278809  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.5642147064209  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.57188892364502  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6350135803222656  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.445878982543945  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.463065147399902  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6515583992004395  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.71174192428589  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.733293056488037  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6584844589233398  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.363553524017334  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.37935495376587  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.673579216003418  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.54060411453247  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.558642387390137  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.684117317199707  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.459059715270996  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.47547149658203  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7016506195068359  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.650320053100586  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.670425415039062  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7076630592346191  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.102919101715088  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.117489337921143  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7272739410400391  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.500099658966064  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.523072242736816  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.731605052947998  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.05034637451172  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.065239429473877  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7342362403869629  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.930474758148193  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.944952964782715  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7682571411132812  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.50792694091797  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.533174991607666  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7694272994995117  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.927526473999023  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.941448211669922  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7722735404968262  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.891201972961426  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.904327869415283  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8056492805480957  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.204973697662354  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.23206090927124  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8052864074707031  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.575579166412354  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.588162899017334  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.796912670135498  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.42915964126587  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.44139289855957  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8469834327697754  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.042067050933838  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.07214117050171  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8304710388183594  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.225388526916504  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.237245082855225  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.868800163269043  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.659645557403564  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.69349765777588  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9027304649353027  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.20317840576172  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.242218017578125  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9245972633361816  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.715973377227783  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.763161659240723  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9429430961608887  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.871257305145264  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.932739734649658  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9544520378112793  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.285375118255615  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.37633514404297  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

number of input  27715234
----------------------------------------after optimizer
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 1.0049943923950195  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.21829891204834
pure train time :  3.3687522411346436
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  2.992281675338745
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.0040416717529296875
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026818037033081055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.996607542037964
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  15.055670738220215
self.buckets_partition() spend  sec:  3.0235190391540527
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7079463005065918  GigaBytes
Max Memory Allocated: 26.441688060760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.6906476020813  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.697627544403076  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6345887184143066  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.533296585083008  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.550482749938965  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.655390739440918  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.73163938522339  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.753190517425537  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.657412052154541  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.382501125335693  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.39830255508423  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6733555793762207  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.60256814956665  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.620606422424316  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6838898658752441  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.402676582336426  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.41908836364746  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7061886787414551  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.712797164916992  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.73290252685547  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.709007740020752  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.100163459777832  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.114733695983887  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7285571098327637  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.489312648773193  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.512285232543945  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7353854179382324  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.03241539001465  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.047308444976807  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7413802146911621  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.988849639892578  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.0033278465271  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7744574546813965  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.546021938323975  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.57115364074707  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7753567695617676  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.96663808822632  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.980559825897217  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7730317115783691  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.893914699554443  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.9070405960083  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8068056106567383  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.22271490097046  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.249802112579346  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8049464225769043  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.55060386657715  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.56318759918213  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8050017356872559  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.478329181671143  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.490912914276123  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8458833694458008  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.0208683013916  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.050942420959473  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8386802673339844  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.232330322265625  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.244186878204346  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8723459243774414  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.6358699798584  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.669886112213135  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9045758247375488  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.16882610321045  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.207865715026855  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9246711730957031  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.650409698486328  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.697597980499268  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9425158500671387  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.85189723968506  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.913379669189453  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9635109901428223  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.354206562042236  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.445035457611084  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

number of input  27715760
----------------------------------------after optimizer
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 1.0128908157348633  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.150167942047119
pure train time :  3.3589792251586914
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  3.2189078330993652
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.002415180206298828
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029981136322021484
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.22156023979187
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  14.973473310470581
self.buckets_partition() spend  sec:  3.2515788078308105
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7064752578735352  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.652328491210938  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.659809589385986  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.632084846496582  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.431723594665527  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.448909759521484  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6538138389587402  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.71882724761963  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.740378379821777  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6574282646179199  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.34794521331787  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.363746643066406  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6742563247680664  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.536356449127197  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.554394721984863  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6816067695617676  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.409284114837646  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.42569589614868  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7025747299194336  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.66365146636963  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.683756828308105  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7072625160217285  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.115047454833984  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.12961769104004  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.728208065032959  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.51746892929077  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.540441513061523  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7328009605407715  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.056328296661377  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.071221351623535  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7349090576171875  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.9528489112854  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.967327117919922  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7644205093383789  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.463830947875977  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.489153385162354  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7704358100891113  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.95605182647705  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.96997356414795  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.765192985534668  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.856226921081543  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.8693528175354  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8040590286254883  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.224745750427246  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.251832962036133  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8001108169555664  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.53073024749756  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.54331398010254  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7944464683532715  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.415714740753174  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.428298473358154  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8483085632324219  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.115910053253174  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.145984172821045  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8336763381958008  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.25660514831543  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.26846170425415  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8681941032409668  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.67598295211792  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.709712982177734  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9027819633483887  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.209998607635498  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.249038219451904  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9197278022766113  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.645942211151123  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.693130493164062  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9389915466308594  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.89030694961548  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.951789379119873  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9563488960266113  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.32554817199707  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.416377067565918  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

number of input  27714235
----------------------------------------after optimizer
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 1.0063481330871582  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.014282703399658
pure train time :  3.4710044860839844
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  3.3444981575012207
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.005700349807739258
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03222370147705078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3505711555480957
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  14.905181407928467
self.buckets_partition() spend  sec:  3.382904291152954
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7058124542236328  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.6035418510437  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.610947608947754  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6358175277709961  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.537234783172607  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.554420948028564  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6515021324157715  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.691016674041748  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.712567806243896  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6604366302490234  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.431347370147705  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.44714879989624  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6744494438171387  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.563495635986328  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.581533908843994  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6836414337158203  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.435084342956543  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.451496124267578  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.701418399810791  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.70277214050293  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.722877502441406  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7064857482910156  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.093843936920166  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.108327388763428  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.726921558380127  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.501938343048096  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.524910926818848  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7326488494873047  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.038681030273438  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.053574085235596  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7333440780639648  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.90224266052246  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.916720867156982  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7666654586791992  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.445138454437256  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.470474243164062  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7723078727722168  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.987730503082275  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.001652240753174  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7675976753234863  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.827717781066895  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.840843677520752  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8074607849121094  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.25287389755249  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.279961109161377  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8044314384460449  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.54922389984131  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.56180763244629  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7954702377319336  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.427359580993652  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.439592838287354  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8400368690490723  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.027522087097168  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.05759620666504  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8336200714111328  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.258100509643555  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.269957065582275  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8706989288330078  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.68002462387085  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.713956832885742  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9036517143249512  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.210113048553467  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.249152660369873  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9221358299255371  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.70418882369995  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.75137710571289  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9413161277770996  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.9215989112854  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.983081340789795  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.953211784362793  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.26982307434082  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.360651969909668  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

number of input  27710768
----------------------------------------after optimizer
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 1.0036287307739258  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9604891538619995
pure train time :  3.498832941055298
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  2.9708099365234375
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.0022249221801757812
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03160214424133301
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.973493814468384
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  14.915314674377441
self.buckets_partition() spend  sec:  3.005136251449585
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7041912078857422  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.63453483581543  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.640953063964844  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6324973106384277  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.436334133148193  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.45352029800415  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6490688323974609  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.668382167816162  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.68993330001831  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6575217247009277  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.365214824676514  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.38101625442505  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6741251945495605  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.599853515625  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.617891788482666  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.683957576751709  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.40127658843994  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.417688369750977  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.700263500213623  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.657371520996094  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.67747688293457  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7034263610839844  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.0415096282959  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.056079864501953  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7278389930725098  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.502384662628174  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.525357246398926  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7338027954101562  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.070417881011963  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.08531093597412  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7324104309082031  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.936007499694824  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.9495530128479  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7674012184143066  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.50203275680542  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.527578353881836  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7730321884155273  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.990497589111328  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.004419326782227  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7670688629150391  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.855812549591064  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.868938446044922  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8071389198303223  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.246307373046875  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.27339458465576  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8036041259765625  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.51683235168457  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.52941608428955  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7975401878356934  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.44139575958252  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.454439640045166  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.845881462097168  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.015111446380615  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.045185565948486  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8362212181091309  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.27341079711914  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.28526735305786  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.868412971496582  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.65812110900879  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.69268274307251  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9057760238647461  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.233725547790527  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.272765159606934  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9247941970825195  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.68804407119751  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.73523235321045  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9418797492980957  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.90097713470459  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.962459564208984  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9613304138183594  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.313865661621094  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.40469455718994  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

number of input  27714969
----------------------------------------after optimizer
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 1.010920524597168  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.914520025253296
pure train time :  3.4934873580932617
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  3.1593639850616455
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.002390623092651367
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.031127214431762695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1619975566864014
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  14.994940042495728
self.buckets_partition() spend  sec:  3.193157911300659
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7046327590942383  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.599870681762695  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.607056140899658  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6329331398010254  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.438785076141357  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.455971240997314  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6503839492797852  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.67222261428833  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.69377374649048  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6604743003845215  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.467610836029053  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.483412265777588  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6726837158203125  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.521670818328857  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.539709091186523  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6844754219055176  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.46466636657715  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.481078147888184  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.70208740234375  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.735429763793945  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.755535125732422  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.704993724822998  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.075825691223145  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.0903959274292  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7271299362182617  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.489179134368896  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.51215171813965  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7273712158203125  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.965564727783203  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.98045778274536  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7360577583312988  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.954313278198242  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.968791484832764  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7694292068481445  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.51371431350708  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.53924560546875  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7732582092285156  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.958927631378174  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.972849369049072  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7721872329711914  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.84540367126465  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.858529567718506  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.810422420501709  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.276022911071777  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.303954601287842  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8086643218994141  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.56474208831787  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.57732582092285  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7995891571044922  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.449966430664062  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.462550163269043  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8473124504089355  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.060418128967285  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.090492248535156  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8363795280456543  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.2715106010437  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.283367156982422  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8756141662597656  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.66522216796875  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.699345111846924  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9068365097045898  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.182835578918457  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.221875190734863  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9241094589233398  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.608224391937256  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.655412673950195  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9450254440307617  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.881881713867188  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.943364143371582  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9608078002929688  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.31069040298462  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.401519298553467  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

number of input  27706138
----------------------------------------after optimizer
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 1.0106120109558105  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8504830598831177
pure train time :  3.4138402938842773
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  3.231114149093628
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.002485990524291992
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029331207275390625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.233942985534668
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  15.060914993286133
self.buckets_partition() spend  sec:  3.263307571411133
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7042999267578125  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.59317684173584  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.600296020507812  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6320943832397461  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.411073684692383  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.42825984954834  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6523284912109375  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.696811199188232  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.71836233139038  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6561403274536133  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.34300994873047  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.358811378479004  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.670316219329834  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.539202213287354  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.55724048614502  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6832551956176758  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.46082830429077  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.477240085601807  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6984043121337891  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.64452028274536  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.664625644683838  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7022304534912109  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.060285568237305  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.07485580444336  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7261247634887695  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.518906116485596  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.541878700256348  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7308464050292969  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.021952152252197  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.036845207214355  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7368488311767578  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.992836475372314  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.00638198852539  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.768486499786377  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.52399492263794  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.54951572418213  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7732057571411133  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.989182472229004  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.003104209899902  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7709417343139648  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.92408561706543  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.937211513519287  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8025527000427246  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.26835584640503  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.295443058013916  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8017759323120117  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.534013748168945  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.546597480773926  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7965388298034668  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.45363187789917  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.46621561050415  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.842536449432373  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.040886402130127  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.070960521697998  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8339791297912598  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.271196365356445  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.283052921295166  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8678388595581055  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.652122020721436  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.686264038085938  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9058198928833008  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.224278450012207  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.263318061828613  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9252228736877441  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.669257164001465  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.716445446014404  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.943756103515625  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.89805793762207  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.959540367126465  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9585118293762207  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.313838005065918  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.404666900634766  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

number of input  27717791
----------------------------------------after optimizer
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 1.0080018043518066  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.803220272064209
pure train time :  3.4388325214385986
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  2.87894344329834
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.004736900329589844
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.031926870346069336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.8840720653533936
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  14.659072160720825
self.buckets_partition() spend  sec:  2.9160563945770264
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.704068660736084  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.646595001220703  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.654236316680908  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6346850395202637  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.472991943359375  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.490178108215332  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6531124114990234  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.70540761947632  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.726958751678467  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6583070755004883  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.39508295059204  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.410884380340576  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6695413589477539  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.53293228149414  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.550970554351807  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6832542419433594  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.426648139953613  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.44305992126465  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.701573371887207  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.70081615447998  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.720921516418457  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7024874687194824  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.064908504486084  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.07947874069214  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7236723899841309  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.51630687713623  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.539279460906982  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7296113967895508  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.032657623291016  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.047550678253174  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7357120513916016  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.95148468017578  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.965962886810303  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7678947448730469  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.50461435317993  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.530035972595215  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.770998477935791  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.978649139404297  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.992570877075195  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7699942588806152  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.892707347869873  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.90583324432373  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8046507835388184  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.21794080734253  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.245028018951416  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8032064437866211  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.53630018234253  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.54888391494751  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7983336448669434  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.457518100738525  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.469751358032227  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8459634780883789  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.050092697143555  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.080166816711426  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8344016075134277  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.217792510986328  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.22964906692505  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8683638572692871  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.686037063598633  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.720160007476807  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9071450233459473  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.227149486541748  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.266189098358154  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9229617118835449  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.63265371322632  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.679841995239258  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9421777725219727  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.869471549987793  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.930953979492188  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9603962898254395  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.33743143081665  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.428260326385498  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

number of input  27711670
----------------------------------------after optimizer
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 1.011284351348877  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7553341388702393
pure train time :  3.452130079269409
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  3.2352547645568848
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.004972219467163086
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02831721305847168
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2406487464904785
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  14.95842432975769
self.buckets_partition() spend  sec:  3.269007444381714
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7041640281677246  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.6180100440979  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.62367010116577  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6338772773742676  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.43565607070923  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.452842235565186  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6515846252441406  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.681374549865723  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.70292568206787  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6582427024841309  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.428828716278076  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.44463014602661  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6734251976013184  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.56743288040161  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.585471153259277  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.686042308807373  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.479374408721924  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.49578619003296  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7002320289611816  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.66066074371338  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.680962562561035  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7046980857849121  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.055686473846436  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.07025671005249  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.727442741394043  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.525346755981445  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.548319339752197  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.729619026184082  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.9869441986084  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.001837253570557  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.735318660736084  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.953321933746338  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.96780014038086  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7710533142089844  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.501453399658203  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.526423454284668  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7741093635559082  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.97697114944458  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.99089288711548  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7739787101745605  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.90163564682007  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.914761543273926  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8059816360473633  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.22648572921753  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.2540283203125  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.804405689239502  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.553580284118652  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.566164016723633  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7970714569091797  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.41160774230957  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.42419147491455  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.846834659576416  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.022414207458496  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.052488327026367  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8374671936035156  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.281708240509033  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.293564796447754  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8695030212402344  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.649524688720703  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.68388795852661  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9047946929931641  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.22390604019165  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.262945652008057  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9233174324035645  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.678887844085693  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.726076126098633  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9426183700561523  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.852660655975342  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.914143085479736  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9590287208557129  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.322139263153076  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.412968158721924  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

number of input  27705997
----------------------------------------after optimizer
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 1.008084774017334  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7252767086029053
pure train time :  3.449265956878662
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  6034
G_BUCKET_ID_list [[11], [13], [9], [15], [12], [14], [10], [17], [8], [16], [19], [7], [18], [20], [6], [21], [22], [5], [23], [4], [3], [2], [1], [0]]
G_BUCKET_ID_list length 24
backpack scheduling spend  3.1721882820129395
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  24
current group_mem  12.331283211708069
current group_mem  12.291315883398056
current group_mem  12.290575057268143
current group_mem  12.27837610244751
current group_mem  12.277820885181427
current group_mem  12.245237678289413
current group_mem  12.244043290615082
current group_mem  11.956209003925323
current group_mem  11.929776906967163
current group_mem  11.852061778306961
current group_mem  11.828669160604477
current group_mem  11.82545319199562
current group_mem  11.79813677072525
current group_mem  11.732278615236282
current group_mem  11.404848486185074
current group_mem  11.348880171775818
current group_mem  11.236764371395111
current group_mem  11.059522658586502
current group_mem  11.01661804318428
current group_mem  10.496867895126343
current group_mem  9.885402828454971
current group_mem  9.089418947696686
current group_mem  8.031363129615784
current group_mem  6.034170180559158
batches output list generation spend  0.0024445056915283203
self.weights_list  [0.024628493371736917, 0.022217914658886544, 0.027860822628624254, 0.020427790741886664, 0.023319656819742556, 0.02121640618334149, 0.0259920028429918, 0.018723818091600335, 0.02959047498341174, 0.019253151355349954, 0.017511073337094167, 0.03228104531308116, 0.01799733096748701, 0.016968486032311696, 0.03501800478636557, 0.016267678612699524, 0.01581455608488882, 0.03887990099231348, 0.015327470076931424, 0.04350804644547329, 0.05047055987554455, 0.06100503736397005, 0.07948531245159168, 0.11742500490813707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025995254516601562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.174872875213623
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  15.169710159301758
self.buckets_partition() spend  sec:  3.200904369354248
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7063765525817871  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.604477882385254  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.612127780914307  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6332192420959473  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.430288314819336  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.447474479675293  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6534805297851562  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.74964952468872  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.77120065689087  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6587343215942383  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.370190620422363  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.3859920501709  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.6715798377990723  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.580397129058838  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.598435401916504  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.685091495513916  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.45451068878174  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.470922470092773  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7020268440246582  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.678595066070557  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.698700428009033  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7062897682189941  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.0642728805542  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.078843116760254  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7284226417541504  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.49979543685913  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.522768020629883  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7346382141113281  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.063640594482422  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.07853364944458  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7344083786010742  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.944748878479004  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.959227085113525  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7707586288452148  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.48831605911255  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.51342487335205  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7732000350952148  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.975207328796387  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.989129066467285  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7697176933288574  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.863986492156982  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.87711238861084  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8047246932983398  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.253257274627686  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.280344486236572  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  15
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8036212921142578  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.537068367004395  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.549652099609375  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  16
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.7995491027832031  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.472031593322754  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.484615325927734  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  17
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8461675643920898  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.998520851135254  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 25.028594970703125  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  18
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.8340411186218262  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.266388416290283  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.278244972229004  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  19
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.871030330657959  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.696609497070312  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.73064088821411  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  20
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.903597354888916  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.17668867111206  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 24.215728282928467  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  21
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9197301864624023  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.625934600830078  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.673122882843018  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  22
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.947110652923584  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 22.946054458618164  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 23.00753688812256  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

step  23
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 0.9569902420043945  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.332733154296875  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 21.423562049865723  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

number of input  27705191
----------------------------------------after optimizer
 Nvidia-smi: 40.74310302734375 GB
    Memory Allocated: 1.0065608024597168  GigaBytes
Max Memory Allocated: 26.446723461151123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.68214750289917
pure train time :  3.413254737854004
epoch_time_list  [60.50718355178833, 60.5121123790741, 64.68432927131653, 58.9776337146759, 59.33989644050598, 59.18689703941345, 60.68141579627991, 59.59038519859314, 57.5934317111969, 58.012388706207275, 58.49581861495972, 59.018609046936035, 58.33949327468872, 57.43508291244507, 58.01439189910889, 58.156901359558105, 58.47224736213684, 57.941683530807495, 58.36523795127869, 60.42107796669006]

loading_time list   [0.6239516735076904, 0.7672238349914551, 0.7523777484893799, 1.078023910522461, 0.6350581645965576, 0.48853611946105957, 0.6075966358184814, 0.5068929195404053, 0.6981916427612305, 0.5570058822631836, 0.6801474094390869, 0.5908162593841553, 0.5891308784484863, 0.5037703514099121, 0.5322303771972656, 0.6030294895172119, 0.5145883560180664, 0.5212066173553467, 0.5158483982086182, 0.5770871639251709]

 data loader gen time  49.931402921676636
	---backpack schedule time  [13.72709345817566, 14.295741558074951, 14.372015714645386, 13.891676664352417, 15.411583662033081, 14.002951860427856, 15.256306171417236, 15.324836492538452, 14.691265344619751, 15.040518760681152, 14.111335039138794, 15.16444706916809, 15.077054262161255, 15.006218910217285, 15.018420457839966, 15.096463441848755, 15.167422771453857, 14.759729385375977, 15.062164783477783, 15.276109218597412]
	---connection_check_time_list  [4.782018184661865, 6.339413166046143, 10.552495241165161, 5.735647201538086, 5.396569013595581, 6.604879379272461, 7.069345235824585, 5.363184452056885, 4.76334810256958, 4.629308223724365, 5.825442314147949, 4.831757068634033, 4.857803106307983, 4.651952266693115, 4.633045434951782, 4.7293500900268555, 5.026804685592651, 5.531687259674072, 5.275355100631714, 5.98479437828064]
	---block_gen_time_list  [4.159518480300903, 4.261818170547485, 3.912893056869507, 3.846755027770996, 3.560828924179077, 3.3704776763916016, 3.551380157470703, 3.821359157562256, 3.7231476306915283, 3.745540142059326, 3.4511804580688477, 3.394747257232666, 3.496253490447998, 3.178077459335327, 3.373541831970215, 3.376905918121338, 3.433445692062378, 3.231098175048828, 3.1447298526763916, 3.407123327255249]
training time  [11.990838050842285, 9.675350666046143, 9.61549997329712, 9.369458198547363, 9.653627157211304, 9.595428228378296, 9.274322748184204, 9.415394306182861, 9.137675523757935, 9.243106126785278, 9.21028757095337, 9.699016094207764, 9.201677799224854, 9.284579753875732, 9.259671449661255, 9.606611251831055, 9.308027505874634, 9.40879225730896, 9.257625818252563, 9.896942377090454]
---feature block loading time  [6.889399290084839, 6.272286415100098, 6.164013862609863, 5.731167316436768, 6.189383268356323, 6.027289867401123, 5.747806072235107, 5.847784757614136, 5.5474700927734375, 5.6298606395721436, 5.720233201980591, 6.207159996032715, 5.60851526260376, 5.663938522338867, 5.634011507034302, 6.058125972747803, 5.735051870346069, 5.8227362632751465, 5.675566673278809, 6.350569725036621]


epoch_time avg   58.69155992567539
loading_time avg   0.5700710415840149
 data loader gen time avg 48.702637791633606
	---backpack schedule time avg 14.966676726937294
	---connection_check_time avg  5.323414131999016
	---block_gen_time avg  3.453739821910858
training time  9.403299123048782
---feature block loading time  5.841593980789185
pure train time per /epoch  [5.084465265274048, 3.2784359455108643, 3.316195487976074, 3.3372817039489746, 3.3259048461914062, 3.43239164352417, 3.390972375869751, 3.4326305389404297, 3.467796802520752, 3.477670669555664, 3.3687522411346436, 3.3589792251586914, 3.4710044860839844, 3.498832941055298, 3.4934873580932617, 3.4138402938842773, 3.4388325214385986, 3.452130079269409, 3.449265956878662, 3.413254737854004]
pure train time average  3.4248840247883514
num_input list  [27712796, 27710988, 27706028, 27704787, 27709679, 27706010, 27705823, 27708651, 27707390, 27704175, 27715234, 27715760, 27714235, 27710768, 27714969, 27706138, 27717791, 27711670, 27705997, 27705191]
num_input  average  27709704.0
