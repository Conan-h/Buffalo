main start at this time 1713747759.7004476
-----------------------------------------before load data 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
# Nodes: 111059956
# Edges: 1615685872
# Train: 1207179
# Val: 125265
# Test: 109727512
# Classes: 172

----------------------------------------start of run function 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.5171890258789062
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.001689910888671875
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03596687316894531
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.519174814224243
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.351349115371704
self.buckets_partition() spend  sec:  2.5551681518554688
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.03997802734375 GB
    Memory Allocated: 0.8087172508239746  GigaBytes
Max Memory Allocated: 0.8087172508239746  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 31.93060302734375 GB
    Memory Allocated: 27.832738876342773  GigaBytes
Max Memory Allocated: 30.0924391746521  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 32.54388427734375 GB
    Memory Allocated: 28.445011138916016  GigaBytes
Max Memory Allocated: 30.0924391746521  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 32.54388427734375 GB
    Memory Allocated: 27.82795524597168  GigaBytes
Max Memory Allocated: 30.0924391746521  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 32.54388427734375 GB
    Memory Allocated: 27.82795524597168  GigaBytes
Max Memory Allocated: 30.0924391746521  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 32.54388427734375 GB
    Memory Allocated: 28.593295574188232  GigaBytes
Max Memory Allocated: 30.0924391746521  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 44.52044677734375 GB
    Memory Allocated: 41.258665561676025  GigaBytes
Max Memory Allocated: 42.408040046691895  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 44.52044677734375 GB
    Memory Allocated: 41.292405128479004  GigaBytes
Max Memory Allocated: 42.408040046691895  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 44.52044677734375 GB
    Memory Allocated: 41.258273124694824  GigaBytes
Max Memory Allocated: 42.408040046691895  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.52044677734375 GB
    Memory Allocated: 41.258273124694824  GigaBytes
Max Memory Allocated: 42.408040046691895  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.52044677734375 GB
    Memory Allocated: 41.29201364517212  GigaBytes
Max Memory Allocated: 42.408040046691895  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 45.35833740234375 GB
    Memory Allocated: 0.8825669288635254  GigaBytes
Max Memory Allocated: 42.408040046691895  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 60.06146240234375 GB
    Memory Allocated: 28.00950860977173  GigaBytes
Max Memory Allocated: 42.408040046691895  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 60.06146240234375 GB
    Memory Allocated: 28.623950481414795  GigaBytes
Max Memory Allocated: 42.408040046691895  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 60.06146240234375 GB
    Memory Allocated: 28.00470781326294  GigaBytes
Max Memory Allocated: 42.408040046691895  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 60.06146240234375 GB
    Memory Allocated: 28.00470781326294  GigaBytes
Max Memory Allocated: 42.408040046691895  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 60.06146240234375 GB
    Memory Allocated: 28.77276039123535  GigaBytes
Max Memory Allocated: 42.408040046691895  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 60.06146240234375 GB
    Memory Allocated: 41.38493013381958  GigaBytes
Max Memory Allocated: 42.52748918533325  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 60.06146240234375 GB
    Memory Allocated: 41.419785022735596  GigaBytes
Max Memory Allocated: 42.52748918533325  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 60.06146240234375 GB
    Memory Allocated: 41.38452482223511  GigaBytes
Max Memory Allocated: 42.52748918533325  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.06146240234375 GB
    Memory Allocated: 41.35078525543213  GigaBytes
Max Memory Allocated: 42.52748918533325  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.06146240234375 GB
    Memory Allocated: 41.3856406211853  GigaBytes
Max Memory Allocated: 42.52748918533325  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.88958740234375 GB
    Memory Allocated: 1.0539374351501465  GigaBytes
Max Memory Allocated: 42.52748918533325  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 29.02279806137085  GigaBytes
Max Memory Allocated: 42.52748918533325  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 29.864102840423584  GigaBytes
Max Memory Allocated: 42.52748918533325  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 29.016225337982178  GigaBytes
Max Memory Allocated: 42.52748918533325  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 29.016225337982178  GigaBytes
Max Memory Allocated: 42.52748918533325  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 30.067856311798096  GigaBytes
Max Memory Allocated: 42.52748918533325  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 44.07099914550781  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 44.24823522567749  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 44.06893444061279  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 44.03407955169678  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 44.21131610870361  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 1.0770702362060547  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.981948852539062  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 28.590797424316406  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.977191925048828  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.977191925048828  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 28.738252639770508  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 41.33550024032593  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 41.36745262145996  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 41.33512830734253  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 41.15789222717285  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 41.18984508514404  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 0.9505863189697266  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.748064041137695  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 28.35374164581299  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.743331909179688  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.743331909179688  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 28.500429153442383  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.98043251037598  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 41.012524127960205  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.9800591468811  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.94810676574707  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.98019886016846  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 0.9756274223327637  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.7228422164917  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 28.3324556350708  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.718079566955566  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.718079566955566  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 28.480096340179443  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.8903021812439  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.92558670043945  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.889891624450684  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.857800006866455  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.89308500289917  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 1.0037803649902344  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.636966228485107  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 28.245999813079834  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.631628036499023  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.6322078704834  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 28.393499851226807  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.79847288131714  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.83449077606201  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.79725790023804  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.76276922225952  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.79878759384155  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 1.0018925666809082  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 26.983696937561035  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.56234359741211  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 26.97917604446411  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 26.97917604446411  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.702484607696533  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.91203784942627  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.93745517730713  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.911752223968506  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.87493848800659  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.90035629272461  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 1.0299224853515625  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.240295886993408  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.844936847686768  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.23557186126709  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.23557186126709  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.99137306213379  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.18632411956787  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.22349739074707  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.18589162826538  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.16047430038452  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 40.19764804840088  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 1.0666046142578125  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.11136484146118  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.716525554656982  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.106637001037598  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.106637001037598  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.863088130950928  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.936705112457275  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.97651529312134  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.93624210357666  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.89906883239746  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.93887948989868  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 1.0912895202636719  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 26.58808422088623  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.198058128356934  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 26.58331871032715  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 26.58331871032715  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.345786094665527  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.13739824295044  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.1857967376709  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.13641691207886  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.09702491760254  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 39.145423889160156  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 1.0169882774353027  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.176668643951416  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.67583417892456  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.172768592834473  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.172768592834473  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.796725749969482  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 30.430631637573242  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 30.481563091278076  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 30.430039405822754  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 30.38122272491455  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 30.432154655456543  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 0.8498339653015137  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.585065364837646  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.89456033706665  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.582344055175781  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.582344055175781  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.969223022460938  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.610215663909912  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.620200157165527  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.61009931564331  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.559167861938477  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.56915283203125  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 0.8212876319885254  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.551315784454346  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.861416339874268  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.548588275909424  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.548588275909424  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.936437129974365  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.581517219543457  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.591501712799072  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.581400871276855  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.57141637802124  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.581401348114014  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 0.8310198783874512  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.559228420257568  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.867970943450928  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.556501865386963  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.556501865386963  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 15.943369388580322  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.587073802947998  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.597053050994873  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.586957454681396  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.57697296142578  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 21.586957931518555  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

number of input  22440132
----------------------------------------after optimizer
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 0.8574199676513672  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.092989921569824
pure train time :  4.927948474884033
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.4776201248168945
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.001535654067993164
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03700995445251465
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.47941517829895
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.816910028457642
self.buckets_partition() spend  sec:  2.5164542198181152
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 0.853121280670166  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.9313063621521  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 28.544728755950928  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.926513671875  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 27.926513671875  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 28.693291664123535  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 41.3399076461792  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 41.37364721298218  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 41.339515209198  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 41.32953596115112  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 41.352266788482666  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62396240234375 GB
    Memory Allocated: 0.8880739212036133  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62786865234375 GB
    Memory Allocated: 27.92916488647461  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62786865234375 GB
    Memory Allocated: 28.5423583984375  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62786865234375 GB
    Memory Allocated: 27.924022674560547  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62786865234375 GB
    Memory Allocated: 27.924110412597656  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62786865234375 GB
    Memory Allocated: 28.69060230255127  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62786865234375 GB
    Memory Allocated: 41.30553436279297  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62786865234375 GB
    Memory Allocated: 41.340389251708984  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62786865234375 GB
    Memory Allocated: 41.305129051208496  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62786865234375 GB
    Memory Allocated: 41.27138948440552  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62786865234375 GB
    Memory Allocated: 41.30624485015869  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62786865234375 GB
    Memory Allocated: 1.0594844818115234  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 29.05080795288086  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 29.892098426818848  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 29.044235229492188  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 29.044235229492188  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 30.095848560333252  GigaBytes
Max Memory Allocated: 45.2938666343689  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 44.09848737716675  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 44.275723457336426  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 44.096352100372314  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 44.0614972114563  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 44.238733768463135  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.0790824890136719  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.95486068725586  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.56226921081543  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.950115203857422  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.950115203857422  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.709375858306885  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.30596685409546  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.33791923522949  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.30559492111206  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.12835884094238  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.160311698913574  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.9527382850646973  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.688066482543945  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.29292106628418  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.683341026306152  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.683341026306152  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.439409255981445  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.920339584350586  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.952431201934814  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.91996622085571  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.88801383972168  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.920105934143066  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.9795856475830078  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.722591876983643  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.33184003829956  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.71783208847046  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.71783208847046  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.479392528533936  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.88986110687256  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.925145626068115  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.889450550079346  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.85735893249512  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.89264392852783  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.0030012130737305  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.60085916519165  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.210111141204834  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.596099376678467  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.596099376678467  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.357664585113525  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.76777935028076  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.803797245025635  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.7673602104187  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.732075691223145  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.768094062805176  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.0102744102478027  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.048299312591553  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.628087520599365  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.043769359588623  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.043769359588623  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.76850461959839  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.98531103134155  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.01072835922241  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.98502540588379  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.949007511138916  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.974425315856934  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.0380659103393555  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.32096576690674  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.92613124847412  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.316237449645996  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.316237449645996  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.072694301605225  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.28311014175415  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.32028341293335  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.28267765045166  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.2572603225708  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.29443407058716  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.0726995468139648  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.13596487045288  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.742105960845947  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.131228923797607  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.131228923797607  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.88890552520752  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.962965965270996  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.00277614593506  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.96250295639038  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.92532968521118  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.9651403427124  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.099466323852539  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 26.62171745300293  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.231603622436523  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 26.61693286895752  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 26.61693286895752  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.37929058074951  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.170517921447754  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.21891641616821  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.16953659057617  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.13014459609985  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.17854356765747  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.0217742919921875  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.130613327026367  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.62929630279541  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.12671709060669  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.12671709060669  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.750071048736572  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 30.384355068206787  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 30.43528652191162  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 30.3837628364563  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 30.334946155548096  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 30.385878086090088  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.8591532707214355  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.578063011169434  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.88700008392334  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.575189590454102  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.575189590454102  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.962251663208008  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.60860538482666  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.618589878082275  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.60848903656006  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.557557582855225  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.567542552947998  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.8305115699768066  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.59966230392456  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.909911632537842  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.597238063812256  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.597238063812256  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.985612392425537  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.630468368530273  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.64045286178589  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.630352020263672  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.620367527008057  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.63035249710083  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.8402605056762695  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.593571186065674  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.902981281280518  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.591153621673584  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.591153621673584  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.978688716888428  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.620985984802246  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.63096523284912  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.620869636535645  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.61088514328003  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.620870113372803  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

number of input  22435492
----------------------------------------after optimizer
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.8605208396911621  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.750014066696167
pure train time :  3.1954541206359863
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.5004448890686035
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.010667085647583008
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030804872512817383
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.511446714401245
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.713715076446533
self.buckets_partition() spend  sec:  2.5423121452331543
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.8496603965759277  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.879785537719727  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.491700172424316  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.875004768371582  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.875004768371582  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.6398983001709  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.28420829772949  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.31794786453247  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.28381586074829  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.273836612701416  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.2969388961792  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.8872709274291992  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.87718439102173  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.490743160247803  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.872390747070312  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.872390747070312  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.639339447021484  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.2538743019104  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.288729190826416  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.25346899032593  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.21972942352295  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.25458478927612  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.0566706657409668  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.98317861557007  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 29.82323694229126  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.97661542892456  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.97661542892456  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 30.02668857574463  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 44.0305061340332  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 44.20774221420288  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 44.028425216674805  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 43.99357032775879  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 44.170806884765625  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.0802397727966309  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.006678104400635  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.61597490310669  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.001917839050293  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.001917839050293  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.76353883743286  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.359761238098145  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.39171361923218  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.359389305114746  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.18215322494507  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.21410608291626  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.9535136222839355  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.74178647994995  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.346694469451904  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.737060546875  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.737060546875  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.49319553375244  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.97356128692627  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.0056529045105  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.9731879234314  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.94123554229736  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.97332763671875  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.9808030128479004  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.689226627349854  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.298478603363037  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.6844220161438  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.68446683883667  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.44603204727173  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.854695320129395  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.88997983932495  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.85428476333618  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.82219314575195  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.85747814178467  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.0084023475646973  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.604591369628906  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.213873863220215  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.59981679916382  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.599831104278564  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.36143445968628  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.769983768463135  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.80600166320801  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.769564628601074  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.73428010940552  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.77029848098755  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.0133905410766602  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.069512844085693  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.6502947807312  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.064975261688232  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.064975261688232  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.790952682495117  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.00625228881836  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.03166961669922  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.005966663360596  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.96994876861572  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.99536657333374  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.037440299987793  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.27217674255371  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.877385139465332  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.26744842529297  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.26744842529297  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.023959159851074  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.217148303985596  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.254321575164795  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.216715812683105  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.191298484802246  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.2284722328186  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.076108455657959  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.163489818572998  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.769530773162842  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.15875482559204  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.15875482559204  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.916306018829346  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.99750518798828  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 40.037315368652344  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.997042179107666  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.95986890792847  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.99967956542969  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.0996932983398438  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 26.682159900665283  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.293108463287354  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 26.67738676071167  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 26.67738676071167  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.441072463989258  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.23458194732666  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.28298044204712  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.23360061645508  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.19420862197876  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 39.24260759353638  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.0233540534973145  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.133318424224854  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.631619930267334  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.129425048828125  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.129425048828125  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.752302169799805  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 30.386356830596924  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 30.437288284301758  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 30.38521957397461  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 30.336947917938232  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 30.387879848480225  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.8619384765625  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.63019609451294  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.940165996551514  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.627774238586426  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.627774238586426  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 16.015869140625  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.660242080688477  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.670226573944092  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.659963607788086  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.608649253845215  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.61863422393799  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.8286213874816895  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.594836235046387  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.904417037963867  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.592417240142822  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.592417240142822  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.980123043060303  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.625730991363525  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.63571548461914  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.625614643096924  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.61546802520752  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.625452995300293  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.8436737060546875  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.643237590789795  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.953150272369385  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.64081621170044  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 15.64081621170044  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 16.02885389328003  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.668635368347168  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.678614616394043  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.668519020080566  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.65853452682495  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 21.668519496917725  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

number of input  22436198
----------------------------------------after optimizer
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.8639421463012695  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.553452968597412
pure train time :  3.1699230670928955
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.281438112258911
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.0022766590118408203
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0364232063293457
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.283907890319824
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.233363389968872
self.buckets_partition() spend  sec:  2.320390224456787
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.8497428894042969  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.893853187561035  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.505703926086426  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.88907289505005  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 27.88907289505005  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.653886318206787  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.29729080200195  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.33103036880493  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.29689836502075  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.28691911697388  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.31018352508545  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 0.8911681175231934  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.005478858947754  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.619893074035645  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.000678539276123  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.000678539276123  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 28.768696308135986  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.38377857208252  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.418633460998535  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.38337326049805  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.34963369369507  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 41.38448905944824  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.62982177734375 GB
    Memory Allocated: 1.059323787689209  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.068589210510254  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.910463333129883  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.06201171875  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.06201171875  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.114354610443115  GigaBytes
Max Memory Allocated: 45.321802616119385  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.11422777175903  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.29146385192871  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.1121563911438  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.07730150222778  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.25453805923462  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0809845924377441  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.953171730041504  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.56121826171875  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.948421001434326  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.948421001434326  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.708479404449463  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.30490207672119  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.336854457855225  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.30453014373779  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.127294063568115  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.15924692153931  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.9551324844360352  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.764447689056396  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.369758129119873  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.759718418121338  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.759718418121338  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.516356468200684  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.99594259262085  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.02803421020508  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.99556922912598  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.96361684799194  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.99570894241333  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.9775118827819824  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.696089267730713  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.304508686065674  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.691335678100586  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.691335678100586  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.451859951019287  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.86014127731323  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.89542579650879  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.85973072052002  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.82763910293579  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.862924098968506  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0058236122131348  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.631978034973145  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.24107265472412  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.627219200134277  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.627219200134277  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.388587474822998  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.79344987869263  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.8294677734375  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.793030738830566  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.75774621963501  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.79454565048218  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0081205368041992  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.004648685455322  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.583305835723877  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.0001277923584  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.0001277923584  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.723449230194092  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.9441933631897  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.96961069107056  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.943907737731934  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.90788984298706  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.93330764770508  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0356359481811523  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.238439559936523  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.84269142150879  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.233718395233154  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.233718395233154  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.989033222198486  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.18474578857422  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.22191905975342  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.18431329727173  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.15889596939087  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.19606971740723  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0695385932922363  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.107481956481934  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.71265411376953  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.10275363922119  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.10275363922119  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.859219074249268  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.93269729614258  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.97250747680664  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.93223428726196  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.895061016082764  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.934871673583984  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0961952209472656  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.603847980499268  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.21328115463257  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.59908676147461  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.59908676147461  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.360878467559814  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.15073490142822  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.19913339614868  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.14975357055664  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.11036157608032  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.15876054763794  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0206036567687988  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.09680700302124  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.59469175338745  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.092600345611572  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.092600345611572  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.714956283569336  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.347933292388916  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.39886474609375  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.347341060638428  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.298524379730225  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.349456310272217  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8579297065734863  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.584467887878418  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.89400577545166  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.5815749168396  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.5815749168396  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.969237804412842  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.613240718841553  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.623225212097168  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.61312437057495  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.562192916870117  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.57217788696289  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8285226821899414  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.570048809051514  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.880137920379639  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.567167282104492  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.567167282104492  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.955381393432617  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.59948492050171  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.609469413757324  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.599260330200195  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.589384078979492  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.599369049072266  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8390684127807617  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.597890377044678  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.908403873443604  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.595134258270264  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.595134258270264  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.98377275466919  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.62456464767456  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.634543895721436  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.62444829940796  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.61435556411743  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.624448776245117  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

number of input  22434509
----------------------------------------after optimizer
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.859428882598877  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3690404891967773
pure train time :  3.162900924682617
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.4916293621063232
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.003998517990112305
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02978348731994629
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.4958314895629883
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.48664379119873
self.buckets_partition() spend  sec:  2.525651454925537
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8479151725769043  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.816160678863525  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.427637577056885  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.81138324737549  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.81138324737549  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.575729370117188  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.21972846984863  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.25346803665161  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.21933603286743  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.20935678482056  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.23260736465454  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8869709968566895  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.899747848510742  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.5123348236084  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.894267559051514  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.894961833953857  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.660695552825928  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.275171756744385  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.3100266456604  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.27476644515991  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.241026878356934  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.27588224411011  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.060041904449463  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.042168140411377  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.88349199295044  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.035594940185547  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.035594940185547  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.087249755859375  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.08893156051636  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.266167640686035  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.086806774139404  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.05195188522339  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.229188442230225  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0780224800109863  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.941502571105957  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.5485258102417  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.93675994873047  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.93675994873047  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.695538997650146  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.291873931884766  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.3238263130188  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.29150199890137  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.11426591873169  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.14621877670288  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.9531693458557129  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.75920343399048  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.364970684051514  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.754470825195312  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.754470825195312  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.511680126190186  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.99082612991333  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.02291774749756  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.99045276641846  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.958500385284424  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.99156188964844  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.9780983924865723  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.70890188217163  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.31810235977173  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.704142093658447  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.704142093658447  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.46564292907715  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.87656021118164  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.9118447303772  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.87614965438843  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.8440580368042  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.879343032836914  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.006375789642334  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.633904457092285  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.243971824645996  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.629137992858887  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.629137992858887  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.391722202301025  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.79912996292114  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.835147857666016  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.79871082305908  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.763426303863525  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.79944467544556  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.005040168762207  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.983511924743652  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.562082290649414  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.978991508483887  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.978991508483887  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.702204704284668  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.91108798980713  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.93650531768799  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.910802364349365  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.87478446960449  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.90020227432251  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0394830703735352  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.30301809310913  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.90902280807495  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.298283576965332  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.298283576965332  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.055789470672607  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.240310192108154  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.27748346328735  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.239877700805664  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.214460372924805  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.25163412094116  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0715985298156738  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.173480987548828  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.78087043762207  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.16870641708374  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.16870641708374  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.927943229675293  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.01127576828003  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.05108594894409  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.010812759399414  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.973639488220215  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.013450145721436  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0927367210388184  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.58221960067749  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.19088125228882  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.577452182769775  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.577452182769775  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.338279247283936  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.128862380981445  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.177260875701904  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.12788105010986  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.088489055633545  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.13688802719116  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0174689292907715  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.138020992279053  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.636373043060303  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.134127616882324  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.134127616882324  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.757067680358887  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.3948335647583  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.445765018463135  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.393669605255127  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.34542465209961  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.3963565826416  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8543100357055664  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.588469982147217  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.898224353790283  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.585566520690918  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.585566520690918  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.973445892333984  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.618316650390625  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.62830114364624  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.618200302124023  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.566697120666504  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.576682090759277  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8261942863464355  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.567479610443115  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.877399921417236  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.564579963684082  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.564579963684082  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.952625274658203  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.5960054397583  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.605989933013916  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.595759391784668  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.585904598236084  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.595889568328857  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8374772071838379  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.631529808044434  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.941585540771484  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.628655433654785  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.628655433654785  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 16.016836166381836  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.658581733703613  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.66856098175049  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.65846538543701  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.648351192474365  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.65846586227417  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

number of input  22437151
----------------------------------------after optimizer
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8574643135070801  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.098611354827881
pure train time :  3.186145782470703
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.4030308723449707
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.004109621047973633
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025898456573486328
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.4073479175567627
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.458796501159668
self.buckets_partition() spend  sec:  2.4332773685455322
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8512148857116699  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.945539951324463  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.55783224105835  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.94075632095337  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.94075632095337  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.706121921539307  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.35034465789795  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.38408422470093  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.34995222091675  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.33997297286987  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.36264371871948  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8881125450134277  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.949057579040527  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.562857627868652  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.94426202774048  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.94426202774048  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.711512088775635  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.3262677192688  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.361122608184814  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.325862407684326  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.29212284088135  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.32697820663452  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0582952499389648  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.015719413757324  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.85680866241455  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.009148120880127  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.009148120880127  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.06050968170166  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.06167936325073  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.23891544342041  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.05955266952515  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.02469778060913  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.20193433761597  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0820269584655762  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.980055332183838  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.588375568389893  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.975302696228027  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.975302696228027  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.735702991485596  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.33161497116089  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.36356735229492  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.33124303817749  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.15400695800781  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.185959815979004  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.9536361694335938  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.717682361602783  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.32269525527954  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.712955474853516  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.712955474853516  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.469221591949463  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.948401927948  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.98049354553223  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.948028564453125  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.91607618331909  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.94816827774048  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.9758591651916504  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.641121864318848  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.249266624450684  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.63637065887451  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.63637065887451  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.396551609039307  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.80474042892456  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.84002494812012  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.80432987213135  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.77223825454712  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.807523250579834  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0076889991760254  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.662617206573486  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.272799968719482  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.65784978866577  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.65784978866577  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.420578479766846  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.825610637664795  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.86162853240967  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.825191497802734  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.78990697860718  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.82592535018921  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0129714012145996  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.084622383117676  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.664440155029297  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.080092430114746  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.080092430114746  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.80486488342285  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.018470764160156  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.043888092041016  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.01818513870239  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.98216724395752  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.00758504867554  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.039191722869873  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.289162158966064  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.89418649673462  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.284435272216797  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.284435272216797  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.04071569442749  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.23437547683716  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.27154874801636  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.23394298553467  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.20852565765381  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.245699405670166  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.075599193572998  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.18501615524292  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.79201364517212  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.18027353286743  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.18027353286743  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.93902063369751  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.02540826797485  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.065218448638916  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.02494525909424  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.98777198791504  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.02758264541626  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0930652618408203  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.53888177871704  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.147247791290283  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.534128665924072  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.534193515777588  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.29465103149414  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.086119651794434  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.13451814651489  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.08513832092285  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.04574632644653  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.09414529800415  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0218138694763184  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.130364894866943  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.628477573394775  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.12647294998169  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.12647294998169  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.74911403656006  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.383066654205322  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.433998107910156  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.381949424743652  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.33365774154663  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.384589672088623  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8629536628723145  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.615989208221436  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.926358699798584  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.613176345825195  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.613176345825195  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 16.001670837402344  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.64647340774536  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.656457901000977  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.64635705947876  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.594900608062744  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.604885578155518  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8270635604858398  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.562141418457031  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.872028350830078  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.559319019317627  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.559319019317627  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.947330951690674  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.591715812683105  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.60170030593872  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.591599464416504  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.58161497116089  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.591599941253662  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8368134498596191  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.553829669952393  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.862865924835205  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.55099868774414  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.55099868774414  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.938159942626953  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.579456329345703  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.589435577392578  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.5793399810791  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.569355487823486  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.57934045791626  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

number of input  22430732
----------------------------------------after optimizer
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8571209907531738  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8621554374694824
pure train time :  3.165146827697754
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.2546167373657227
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.0030744075775146484
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03051280975341797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.2580995559692383
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.499361038208008
self.buckets_partition() spend  sec:  2.2886428833007812
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8516430854797363  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.83804988861084  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.450849533081055  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.832780361175537  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.833261966705322  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.59926176071167  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.24284601211548  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.27658557891846  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.24245357513428  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.2324743270874  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.25519418716431  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8914761543273926  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.985092163085938  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.599047660827637  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.980295181274414  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.980295181274414  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.747739791870117  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.36132860183716  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.396183490753174  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.360923290252686  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.32718372344971  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.36203908920288  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0580687522888184  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.9845232963562  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.825175762176514  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.97795534133911  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.97795534133911  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.028770923614502  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.031118392944336  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.208354473114014  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.02902603149414  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 43.994171142578125  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.17140769958496  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0818638801574707  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.98831081390381  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.597261428833008  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.983552932739258  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.983552932739258  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.744741439819336  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.3408842086792  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.37283658981323  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.3405122756958  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.16327619552612  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.195229053497314  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.9549708366394043  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.76329231262207  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.368943214416504  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.75856065750122  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.75856065750122  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.515624523162842  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.99633169174194  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.02842330932617  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.99595832824707  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.96400594711304  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.996098041534424  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.9804396629333496  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.696992874145508  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.305981636047363  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.692234992980957  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.692234992980957  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.453471183776855  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.862528800964355  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.89781332015991  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.86211824417114  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.830026626586914  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.86531162261963  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.005889892578125  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.65820074081421  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.267770290374756  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.653438091278076  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.653438091278076  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.41540002822876  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.82198667526245  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.858004570007324  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.82156753540039  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.786283016204834  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.822301387786865  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0088701248168945  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.045738697052002  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.624292850494385  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.041218280792236  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.041218280792236  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.764410972595215  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.979318141937256  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.004735469818115  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.97903251647949  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.94301462173462  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.96843242645264  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0359935760498047  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.285325050354004  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.890777587890625  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.28059482574463  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.28059482574463  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.037410736083984  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.23054218292236  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.26771545410156  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.23010969161987  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.204692363739014  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.24186611175537  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.068291187286377  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.085346221923828  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.69048500061035  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.080618381500244  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.080618381500244  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.8370418548584  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.91082811355591  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.95063829421997  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.91036510467529  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.873191833496094  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.913002490997314  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0915336608886719  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.55943536758423  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.16844129562378  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.554677486419678  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.554677486419678  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.315935134887695  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.10637187957764  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.154770374298096  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.105390548706055  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.065998554229736  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.11439752578735  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0177249908447266  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.118599891662598  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.61647129058838  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.114709854125977  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.114709854125977  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.737049102783203  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.372329235076904  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.42326068878174  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.371031761169434  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.322920322418213  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.373852252960205  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8607516288757324  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.623374938964844  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.933605194091797  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.620567798614502  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.620567798614502  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 16.008923053741455  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.65415048599243  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.664134979248047  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.65403413772583  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.602397441864014  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.612382411956787  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8284125328063965  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.573420524597168  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.883113861083984  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.571000576019287  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.571000576019287  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.958818912506104  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.603836059570312  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.613820552825928  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.60371971130371  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.593735218048096  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.60372018814087  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8342761993408203  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.526472568511963  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.835145473480225  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.524060726165771  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.524060726165771  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.910849571228027  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.55599308013916  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.565972328186035  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.55587673187256  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.545892238616943  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.555871963500977  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

number of input  22426855
----------------------------------------after optimizer
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8545045852661133  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6422011852264404
pure train time :  3.1720309257507324
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.546678066253662
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.004021406173706055
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026763200759887695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.5509119033813477
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.662164449691772
self.buckets_partition() spend  sec:  2.577707529067993
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8482799530029297  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.890387535095215  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.50248432159424  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.88480567932129  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.88480567932129  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.64992666244507  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.29494857788086  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.32868814468384  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.29455614089966  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.28457689285278  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.30801820755005  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8903393745422363  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.058587551116943  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.67338228225708  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.053784370422363  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.053784370422363  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.822278022766113  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.43505811691284  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.46991300582886  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.43465280532837  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.40091323852539  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.435768604278564  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0569047927856445  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.984675407409668  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 29.824912071228027  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.978110790252686  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.978110790252686  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.028406620025635  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.03126001358032  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.20849609375  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.029072284698486  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 43.99421739578247  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 44.17145395278931  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.079270839691162  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.953529834747314  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.561476230621338  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.948780059814453  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.948780059814453  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.708713054656982  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.30533695220947  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.337289333343506  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.304965019226074  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.1277289390564  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.15968179702759  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.9542551040649414  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.70267152786255  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.307791233062744  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.697943687438965  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.697943687438965  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.45434331893921  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.93497085571289  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.96706247329712  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.93459749221802  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.902645111083984  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.93473720550537  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.9799537658691406  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.67449951171875  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.28311061859131  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.66974449157715  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.66974449157715  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.430508613586426  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.838736057281494  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.87402057647705  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.83832550048828  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.80623388290405  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.84151887893677  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.008659839630127  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.668667793273926  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.27869701385498  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.663901805877686  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.663901805877686  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.426438331604004  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.83330059051514  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.86931848526001  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.832881450653076  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.79759693145752  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.834216594696045  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0115885734558105  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.07618474960327  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.655734539031982  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.071656703948975  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.071656703948975  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.796093940734863  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.01034593582153  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.03576326370239  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.01006031036377  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.9740424156189  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.999460220336914  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0402040481567383  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.338040828704834  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.943984508514404  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.333306789398193  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.333306789398193  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.090736389160156  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.30038547515869  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.33755874633789  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.2999529838562  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.27453565597534  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 40.3117094039917  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0754714012145996  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.125847339630127  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.73257303237915  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.12110710144043  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.12110710144043  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.87951421737671  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.95456600189209  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.99437618255615  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.954102993011475  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.916929721832275  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.956740379333496  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.09574556350708  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.612887859344482  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.222927570343018  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.608121871948242  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 26.608121871948242  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.37067174911499  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.16220045089722  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.210598945617676  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.161219120025635  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.121827125549316  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 39.170226097106934  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.019510269165039  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.172976970672607  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.67165517807007  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.16908073425293  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.16908073425293  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.792428493499756  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.42636728286743  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.477298736572266  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.425775051116943  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.37695837020874  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 30.427890300750732  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8561420440673828  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.60429573059082  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.91403865814209  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.601660251617432  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.601660251617432  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.989528179168701  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.63523006439209  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.645214557647705  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.63511371612549  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.584182262420654  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.594167232513428  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.824155330657959  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.528446674346924  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.837419033050537  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.525811195373535  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.525811195373535  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.912232875823975  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.557190895080566  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.56717538833618  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.557074546813965  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.54709005355835  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.557075023651123  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8387207984924316  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.586220264434814  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.895815372467041  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.583584785461426  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.583584785461426  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 15.971304893493652  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.614823818206787  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.624803066253662  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.614707469940186  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.60472297668457  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 21.614702701568604  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

number of input  22431668
----------------------------------------after optimizer
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8589382171630859  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5226972103118896
pure train time :  3.2051010131835938
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.3903143405914307
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.003690004348754883
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.028018951416015625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.394251823425293
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.435023784637451
self.buckets_partition() spend  sec:  2.422315835952759
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8540983200073242  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.956326961517334  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.56989812850952  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.951533317565918  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.951533317565918  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.718497276306152  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.36441135406494  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.39815092086792  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.36401891708374  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.354039669036865  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.37657356262207  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 0.8897585868835449  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.99277400970459  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.607064247131348  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.987974643707275  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 27.987974643707275  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 28.755837440490723  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.3701810836792  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.405035972595215  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.36977577209473  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.33603620529175  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 41.37089157104492  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.36419677734375 GB
    Memory Allocated: 1.0646562576293945  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.124438762664795  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.9669451713562  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.11785650253296  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.11785650253296  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.170989513397217  GigaBytes
Max Memory Allocated: 45.3369083404541  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.171868324279785  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.34910440444946  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.16978359222412  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.134928703308105  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.31216526031494  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0819716453552246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.963736534118652  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.57183265686035  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.958985328674316  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.958985328674316  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.71910572052002  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.315085887908936  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.34703826904297  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.31471395492554  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.13747787475586  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.16943073272705  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9530754089355469  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.71954345703125  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.32442283630371  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.7148175239563  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.7148175239563  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.470916748046875  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.9503812789917  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.98247289657593  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.950007915496826  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.91805553436279  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.95014762878418  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9814224243164062  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.73146629333496  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.34068012237549  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.726706504821777  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.726706504821777  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.488224029541016  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.89861249923706  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.93389701843262  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.89820194244385  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.86611032485962  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.901395320892334  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0081443786621094  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.632527351379395  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.241579055786133  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.627606868743896  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.627768993377686  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.389083862304688  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.79345178604126  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.82946968078613  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.7930326461792  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.75774812698364  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.793766498565674  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0109033584594727  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.05582284927368  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.635343074798584  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.051295280456543  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.051295280456543  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.77569580078125  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.98967218399048  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.01508951187134  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.989386558532715  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.95336866378784  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.97878646850586  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.031869888305664  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.185688972473145  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.789097785949707  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.18097448348999  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.18097448348999  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.935235500335693  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.129971981048584  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.16714525222778  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.129539489746094  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.104122161865234  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.14129590988159  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.073819637298584  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.188842296600342  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.796047687530518  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.18409824371338  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.18409824371338  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.943105220794678  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.02413368225098  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.06394386291504  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.02367067337036  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.98649740219116  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.02630805969238  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.09212064743042  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.549006462097168  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.15768814086914  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.543718814849854  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.544250965118408  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.305103302001953  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.09443283081055  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.142831325531006  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.093451499938965  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.05405950546265  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.102458477020264  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.016861915588379  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.094565391540527  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.591915130615234  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.090564727783203  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.090564727783203  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.712252140045166  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.349406242370605  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.40033769607544  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.348814010620117  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.299997329711914  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.350929260253906  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.857119083404541  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.58700180053711  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.89724063873291  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.584298133850098  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.584298133850098  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.972661972045898  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.61690044403076  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.626884937286377  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.61671781539917  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.565852642059326  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.5758376121521  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8259377479553223  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.546558380126953  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.856058120727539  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.543854713439941  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.543854713439941  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.931479454040527  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.575666427612305  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.58565092086792  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.575424671173096  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.565499305725098  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.57555055618286  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8370614051818848  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.570443630218506  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.879940509796143  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.56745195388794  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.56745195388794  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.955073833465576  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.59874677658081  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.608726024627686  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.59863042831421  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.588520526885986  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.598630905151367  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

number of input  22436590
----------------------------------------after optimizer
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8573751449584961  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5070135593414307
pure train time :  3.170539617538452
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.2573535442352295
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.0016837120056152344
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029335737228393555
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.259294033050537
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.385963439941406
self.buckets_partition() spend  sec:  2.288663864135742
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8488273620605469  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.85109281539917  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.463168621063232  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.84631061553955  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.84631061553955  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.61140537261963  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.25603914260864  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.28977870941162  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.25564670562744  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.245667457580566  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.268871784210205  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8906593322753906  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.05101251602173  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.66616678237915  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.0462064743042  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.0462064743042  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.815149307250977  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.428622245788574  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.46347713470459  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.4282169342041  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.39447736740112  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.4293327331543  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.055222988128662  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.95909881591797  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.799055099487305  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.952536582946777  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.952536582946777  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.002481937408447  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.00542497634888  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.182661056518555  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.00315713882446  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 43.96830224990845  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.14553880691528  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0818963050842285  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.983479022979736  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.591962337493896  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.97872495651245  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.97872495651245  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.73932933807373  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.334980487823486  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.36693286895752  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.33460855484009  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.15737247467041  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.1893253326416  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9536266326904297  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.731512546539307  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.336387157440186  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.726786613464355  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.726786613464355  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.482880115509033  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.96225833892822  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.99434995651245  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.96188497543335  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.929932594299316  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.9620246887207  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9790258407592773  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.7321457862854  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.341256618499756  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.727386951446533  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.727386951446533  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.488775730133057  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.89901638031006  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.93446063995361  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.898605823516846  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.86651420593262  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.90195894241333  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0077495574951172  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.6622052192688  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.27249574661255  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.657437324523926  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.657437324523926  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.420300483703613  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.823930740356445  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.85994863510132  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.823511600494385  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.78806734085083  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.82408571243286  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0088343620300293  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.02856159210205  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.608102798461914  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.024033546447754  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.024033546447754  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.748460292816162  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.96810245513916  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.99351978302002  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.9678168296814  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.93179893493652  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.95721673965454  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0401968955993652  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.31065273284912  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.91609764099121  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.305922508239746  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.305922508239746  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.062728881835938  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.249640464782715  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.286813735961914  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.249207973480225  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.223790645599365  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.26096439361572  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0704741477966309  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.063121795654297  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.668707847595215  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.058390617370605  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.058390617370605  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.815373420715332  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.88969421386719  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.92950439453125  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.88923120498657  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.85205793380737  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.891868591308594  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.094416618347168  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.62577247619629  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.23505973815918  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.621012210845947  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.621012210845947  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.38262128829956  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.173255920410156  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.221654415130615  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.172274589538574  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.132882595062256  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.18128156661987  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0182008743286133  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.164233207702637  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.66310691833496  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.160335540771484  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.160335540771484  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.78392791748047  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.418441772460938  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.46937322616577  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.41784954071045  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.369032859802246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.41996479034424  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8578767776489258  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.632756233215332  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.943513870239258  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.63018798828125  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.63018798828125  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 16.019070625305176  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.665666103363037  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.675650596618652  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.665433406829834  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.6146183013916  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.624603271484375  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8256344795227051  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.571827411651611  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.881805896759033  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.56925916671753  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.56925916671753  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.957362651824951  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.60214853286743  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.612133026123047  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.60203218460083  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.591931343078613  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.60203266143799  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8331732749938965  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.547393798828125  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.856168746948242  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.544562816619873  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.544562816619873  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.930553913116455  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.56501531600952  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.574994564056396  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.56489896774292  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.554914474487305  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.564899444580078  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

number of input  22430859
----------------------------------------after optimizer
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8536162376403809  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3019042015075684
pure train time :  3.1903345584869385
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.537104606628418
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.0017638206481933594
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029098033905029297
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.539299964904785
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.668065786361694
self.buckets_partition() spend  sec:  2.568431854248047
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8513832092285156  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.84237289428711  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.45447540283203  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.83759069442749  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.83759069442749  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.602718830108643  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.246609687805176  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.280349254608154  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.246217250823975  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.2362380027771  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.259217739105225  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8875589370727539  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.941359043121338  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.55501890182495  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.936564445495605  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.936564445495605  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.7036395072937  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.31838130950928  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.35323619842529  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.317975997924805  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.284236431121826  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.319091796875  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0561223030090332  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.9319806098938  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.771862506866455  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.925418853759766  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.925418853759766  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.975271224975586  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 43.97879600524902  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.1560320854187  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 43.97666931152344  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 43.94181442260742  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.11905097961426  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0843429565429688  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.017739295959473  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.62743854522705  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.012365341186523  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.012365341186523  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.774489402770996  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.370920181274414  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.40287256240845  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.370548248291016  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.19331216812134  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.22526502609253  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9572315216064453  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.73957633972168  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.345195770263672  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.73484468460083  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.73484468460083  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.49186897277832  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.97246074676514  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.004552364349365  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.972087383270264  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.94013500213623  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.97222709655762  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9805827140808105  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.712671279907227  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.32157802581787  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.7071213722229  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.707913875579834  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.46904754638672  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.87727880477905  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.91256332397461  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.87686824798584  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.84477663040161  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.880061626434326  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.008082389831543  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.65193510055542  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.26136541366577  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.646904945373535  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.64717388153076  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.4089617729187  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.816728591918945  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.85274648666382  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.81593322753906  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.78102493286133  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.81704330444336  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0080795288085938  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.991508960723877  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.569962978363037  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.986989498138428  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.986989498138428  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.710057258605957  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.91976547241211  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.94518280029297  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.919479846954346  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.88308572769165  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.90850353240967  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0444426536560059  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.33806610107422  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.94394874572754  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.333332538604736  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.333332538604736  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.090685844421387  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.30415058135986  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.34132385253906  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.30371809005737  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.278300762176514  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.31547451019287  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0778589248657227  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.188291549682617  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.79500675201416  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.18355131149292  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.18355131149292  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.941945552825928  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.02520513534546  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.06501531600952  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.024742126464844  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.987568855285645  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.027379512786865  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0992374420166016  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.61996364593506  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.229755401611328  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.61441946029663  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.61441946029663  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.376659393310547  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.16585445404053  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.214252948760986  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.164873123168945  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.12548112869263  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.173880100250244  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0201396942138672  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.09308910369873  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.5906982421875  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.0892014503479  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.0892014503479  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.71121311187744  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.345868587493896  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.39680004119873  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.345276355743408  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.296459674835205  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.347391605377197  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.861295223236084  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.64553689956665  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.955705165863037  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.642672538757324  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.642672538757324  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 16.03096580505371  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.679166793823242  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.689151287078857  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.67905044555664  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.628118991851807  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.63810396194458  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8328256607055664  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.602657794952393  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.912574291229248  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.600236415863037  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.600236415863037  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.988277912139893  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.631653308868408  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.641637802124023  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.631536960601807  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.62155246734619  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.631537437438965  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8394904136657715  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.555614471435547  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.864765167236328  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.55319881439209  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.55319881439209  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.940474510192871  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.58204174041748  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.592020988464355  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.581798553466797  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.571940898895264  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.581925868988037  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

number of input  22438758
----------------------------------------after optimizer
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8599677085876465  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.228609561920166
pure train time :  3.181791305541992
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.4119720458984375
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.0017194747924804688
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027205467224121094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.4139342308044434
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.434295892715454
self.buckets_partition() spend  sec:  2.4411802291870117
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8534469604492188  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.934494495391846  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.548688411712646  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.929696083068848  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.929696083068848  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.697438716888428  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.34204053878784  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.37578010559082  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.34164810180664  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.331542015075684  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.35467290878296  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8874425888061523  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.937448978424072  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.550896167755127  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.932656288146973  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.932656288146973  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.69946527481079  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.31204605102539  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.346900939941406  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.31164073944092  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.27790117263794  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.31275653839111  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0576858520507812  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.00691556930542  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.847651958465576  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.000078201293945  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.000078201293945  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.05099868774414  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.052700996398926  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.2299370765686  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.05053901672363  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.01568412780762  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.19292068481445  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0814800262451172  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.98985195159912  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.598737716674805  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.985095024108887  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.985095024108887  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.74620246887207  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.34131908416748  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.373271465301514  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.34094715118408  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.163711071014404  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.195663928985596  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9555668830871582  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.787309646606445  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.392906188964844  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.782577991485596  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.782577991485596  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.539573669433594  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.0190315246582  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.05112314224243  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.01865816116333  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.9867057800293  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.018797874450684  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9787778854370117  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.684447288513184  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.29360866546631  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.679687976837158  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.679687976837158  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.441139698028564  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.8506236076355  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.885908126831055  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.850213050842285  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.81812143325806  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.85340642929077  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0107054710388184  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.714139461517334  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.325042247772217  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.70936632156372  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.70936632156372  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.472994804382324  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.87094163894653  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.906959533691406  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.87052249908447  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.835237979888916  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.87125635147095  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0131244659423828  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.07943630218506  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.659481048583984  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.074904441833496  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.074904441833496  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.799960613250732  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.01849365234375  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.04391098022461  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.018208026885986  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.98219013214111  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.00760793685913  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.03425931930542  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.228233814239502  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.832212924957275  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.223515033721924  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.223515033721924  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.97848892211914  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.16049146652222  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.197664737701416  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.16005897521973  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.13464164733887  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.171815395355225  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0705037117004395  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.117019176483154  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.72187376022339  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.112242698669434  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.112242698669434  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.868310928344727  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.94199752807617  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.981807708740234  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.94153451919556  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.90436124801636  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.94417190551758  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0956182479858398  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.63366985321045  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.24400806427002  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.628901481628418  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.628901481628418  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.39182424545288  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.18145561218262  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.229854106903076  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.180474281311035  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.14108228683472  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.189481258392334  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0172843933105469  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.093194007873535  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.590970039367676  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.08930492401123  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.08930492401123  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.711524963378906  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.34454107284546  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.395472526550293  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.34394884109497  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.295132160186768  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.34606409072876  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8561182022094727  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.576342105865479  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.885831356048584  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.573333740234375  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.573333740234375  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.960317134857178  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.606037616729736  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.61602210998535  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.605921268463135  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.5549898147583  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.564974784851074  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8241434097290039  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.53548288345337  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.844573497772217  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.532459735870361  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.532459735870361  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.919282913208008  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.565210819244385  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.5751953125  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.565094470977783  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.555109977722168  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.56509494781494  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8426156044006348  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.619588375091553  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.93010663986206  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.616600036621094  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.616600036621094  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 16.0052433013916  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.646721363067627  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.656700611114502  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.646605014801025  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.63662052154541  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.646605491638184  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

number of input  22439749
----------------------------------------after optimizer
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8630566596984863  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.162518262863159
pure train time :  3.2601253986358643
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.9923312664031982
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.0030858516693115234
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.028455734252929688
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.995600461959839
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  10.307122468948364
self.buckets_partition() spend  sec:  3.0240910053253174
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8496713638305664  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.89279794692993  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.504945278167725  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.887099266052246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.887099266052246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.652283668518066  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.295828342437744  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.32956790924072  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.29543590545654  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.28545665740967  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.30842113494873  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8884172439575195  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.990675449371338  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.60471200942993  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.985877990722656  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.985877990722656  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.7534236907959  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.36638593673706  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.401240825653076  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.36598062515259  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.33224105834961  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.36709642410278  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0599393844604492  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.019041061401367  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.861233711242676  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.012461185455322  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.012461185455322  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.065202236175537  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.06541204452515  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.242648124694824  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.0633339881897  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.02847909927368  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.20571565628052  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0777850151062012  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.89104700088501  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.498058795928955  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.88630437850952  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.88630437850952  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.645069122314453  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.240564823150635  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.27251720428467  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.240192890167236  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.06295680999756  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.09490966796875  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9539608955383301  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.790505409240723  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.396923065185547  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.785767555236816  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.785767555236816  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.543789863586426  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.02481460571289  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.05690622329712  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.02444124221802  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.992488861083984  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.02458095550537  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9799461364746094  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.72376585006714  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.333289623260498  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.719003677368164  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.719003677368164  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.480908393859863  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.89251899719238  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.92848205566406  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.89210844039917  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.86001682281494  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.89598035812378  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0078835487365723  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.673341751098633  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.28342056274414  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.668575286865234  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.668575286865234  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.43117380142212  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.83321189880371  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.869229793548584  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.83279275894165  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.79682970046997  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.832848072052  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0074048042297363  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.993954181671143  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.572537899017334  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.98931074142456  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.98931074142456  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.71254062652588  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.9333291053772  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.95874643325806  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.933043479919434  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.89702558517456  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.92244338989258  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0352129936218262  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.24982786178589  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.854721546173096  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.245101928710938  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.245101928710938  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.001219272613525  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.19432592391968  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.23149919509888  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.19389343261719  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.16847610473633  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.205649852752686  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0701565742492676  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.104288578033447  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.709097385406494  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.099563121795654  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.099563121795654  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.855574131011963  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.92945146560669  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.96926164627075  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.928988456726074  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.891815185546875  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.931625843048096  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0959758758544922  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.643014907836914  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.252954483032227  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.638110160827637  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.638249397277832  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.400673866271973  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.19210195541382  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.24050045013428  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.191120624542236  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.15172863006592  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.200127601623535  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0221877098083496  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.18249797821045  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.6816463470459  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.178597927093506  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.178597927093506  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.802533626556396  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.434558391571045  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.48548984527588  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.433966159820557  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.385149478912354  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.436081409454346  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8574333190917969  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.61549425125122  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.924606800079346  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.612727165222168  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.612727165222168  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.999964714050293  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.649117946624756  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.65910243988037  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.648313522338867  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.59807014465332  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.608055114746094  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8256454467773438  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.555814266204834  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.865268230438232  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.553396224975586  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.553396224975586  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.940975189208984  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.587445735931396  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.59743022918701  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.587329387664795  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.576656818389893  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.586641788482666  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8373551368713379  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.582272052764893  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.891491413116455  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.579855918884277  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.579855918884277  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.96720027923584  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.6101131439209  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.620092391967773  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.609996795654297  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.60001230239868  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.609997272491455  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

number of input  22432446
----------------------------------------after optimizer
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8574919700622559  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.031240463256836
pure train time :  3.2093451023101807
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.5982580184936523
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.0018982887268066406
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027587175369262695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.6003644466400146
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.531744003295898
self.buckets_partition() spend  sec:  2.6279895305633545
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8520359992980957  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.931421279907227  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.54482364654541  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.926629066467285  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.926629066467285  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.693382263183594  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.338067054748535  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.371806621551514  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.33766746520996  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.32769536972046  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.35103988647461  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8898181915283203  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.973384380340576  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.587527751922607  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.968585968017578  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.968585968017578  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.736265182495117  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.35148620605469  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.3863410949707  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.351080894470215  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.31733417510986  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.35218954086304  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.061572551727295  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.06858730316162  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.910483360290527  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.062009811401367  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.062009811401367  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.1143798828125  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.11529493331909  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.29253101348877  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.11306619644165  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.078211307525635  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.25544786453247  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.076512336730957  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.943105220794678  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.550859928131104  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.93835687637329  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.93835687637329  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.698050498962402  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.294750690460205  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.32670307159424  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.29437875747681  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.11714267730713  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.14909553527832  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9536728858947754  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.786720275878906  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.392234802246094  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.781989574432373  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.781989574432373  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.538882732391357  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.018813610076904  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.05090522766113  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.01844024658203  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.986487865448  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.018579959869385  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9765067100524902  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.679266452789307  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.287386417388916  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.67359209060669  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.67359209060669  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.4337420463562  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.84207534790039  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.87735986709595  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.84166479110718  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.80957317352295  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.844858169555664  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0025901794433594  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.58065128326416  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.18983745574951  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.575891971588135  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.575891971588135  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.337374687194824  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.74777698516846  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.78379487991333  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.7473578453064  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.71207332611084  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.74809169769287  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0090060234069824  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.077058792114258  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.65722942352295  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.07252597808838  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.07252597808838  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.797739505767822  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.01263093948364  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.0380482673645  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.01234531402588  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.976327419281006  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.00174522399902  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.034559726715088  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.244877815246582  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.849258422851562  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.240155696868896  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.240155696868896  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.9956316947937  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.1890664100647  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.2262396812439  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.18863391876221  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.16321659088135  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.200390338897705  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.071765422821045  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.150673389434814  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.757297039031982  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.145934104919434  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.145934104919434  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.904213905334473  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.97865295410156  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.018463134765625  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.97818994522095  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.94101667404175  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.98082733154297  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0903348922729492  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.57081651687622  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.179481983184814  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.565361499786377  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.565361499786377  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.32619333267212  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.11607360839844  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.1644721031189  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.115092277526855  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.07570028305054  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.124099254608154  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.015730857849121  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.118031978607178  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.615910053253174  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.114141941070557  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.114141941070557  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.73648977279663  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.368436336517334  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.419367790222168  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.367844104766846  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.319027423858643  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.369959354400635  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8572773933410645  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.599408626556396  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.909353733062744  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.596906185150146  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.596906185150146  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.984976291656494  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.630484580993652  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.640469074249268  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.63023281097412  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.579436779022217  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.58942174911499  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8286471366882324  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.626328945159912  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.936648845672607  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.623650550842285  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.623650550842285  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 16.01209545135498  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.656309127807617  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.666293621063232  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.656087398529053  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.64607286453247  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.656193256378174  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8337316513061523  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.547714710235596  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.857119083404541  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.54494047164917  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.54494047164917  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.932469844818115  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.574031352996826  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.5840106010437  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.573824405670166  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.563825130462646  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.573915481567383  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

number of input  22434691
----------------------------------------after optimizer
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.853888988494873  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9649031162261963
pure train time :  3.199902296066284
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.428457736968994
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.002065420150756836
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03211688995361328
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.4307427406311035
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.699208736419678
self.buckets_partition() spend  sec:  2.4629008769989014
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.847383975982666  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.861011028289795  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.472792148590088  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.85606050491333  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.85606050491333  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.620787143707275  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.26319980621338  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.29693937301636  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.26280736923218  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.252737522125244  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.276212215423584  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8860993385314941  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.914960861206055  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.527522087097168  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.909454822540283  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.91017484664917  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.67587661743164  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.29053831100464  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.325393199920654  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.290132999420166  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.25639343261719  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.29124879837036  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0569524765014648  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.977574825286865  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.81810235977173  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.971007823944092  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.971007823944092  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.02166748046875  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.02452230453491  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.20175838470459  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.02244567871094  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 43.98759078979492  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.16482734680176  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0794000625610352  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.944296836853027  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.552270889282227  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.939546585083008  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.939546585083008  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.699514389038086  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.29648017883301  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.32843255996704  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.29610824584961  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.11887216567993  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.15082502365112  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9529013633728027  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.681695461273193  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.285969257354736  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.676974296569824  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.676974296569824  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.432316780090332  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.91212320327759  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.944214820861816  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.911749839782715  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.87979745864868  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.91188955307007  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.982027530670166  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.74936819076538  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.35932493209839  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.7446026802063  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.7446026802063  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.50704860687256  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.91659927368164  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.9518837928772  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.91618871688843  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.8840970993042  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.919382095336914  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0077977180480957  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.609241008758545  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.21892499923706  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.603272438049316  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.60354518890381  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.365650177001953  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.77464199066162  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.810659885406494  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.77422285079956  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.738938331604004  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.774956703186035  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0134382247924805  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.084776401519775  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.66527795791626  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.080241203308105  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.080241203308105  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.80586814880371  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.02210521697998  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.04752254486084  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.02181959152222  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.985801696777344  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.01121950149536  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0358309745788574  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.211920261383057  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.81535768508911  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.207205772399902  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.207205772399902  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.96150255203247  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.154160022735596  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.191333293914795  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.153727531433105  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.128310203552246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.1654839515686  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.076026439666748  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.174774646759033  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.78142499923706  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.170034885406494  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.170034885406494  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.928348064422607  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.01234483718872  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.05215501785278  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.011881828308105  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.974708557128906  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.01451921463013  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0975327491760254  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.631467819213867  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.24048614501953  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.625954627990723  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.625954627990723  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.387227535247803  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.18060636520386  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.229004859924316  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.179625034332275  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.14023303985596  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.188632011413574  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0212292671203613  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.093411922454834  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.59165334701538  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.089519023895264  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.089519023895264  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.712320804595947  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.347994804382324  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.398926258087158  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.347402572631836  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.298585891723633  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.349517822265625  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8585352897644043  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.582052230834961  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.890897750854492  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.579114437103271  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.579114437103271  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.966084957122803  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.613272190093994  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.62325668334961  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.613155841827393  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.56222438812256  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.572209358215332  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8329753875732422  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.600990295410156  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.911062240600586  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.598075866699219  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.598075866699219  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.986272811889648  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.63102960586548  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.641469478607178  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.63136863708496  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.62092876434326  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.630913734436035  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8444018363952637  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.634305477142334  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.945725917816162  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.631872177124023  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.631872177124023  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 16.02141761779785  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.66602373123169  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.676002979278564  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.66578722000122  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.655922889709473  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.665907859802246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

number of input  22436387
----------------------------------------after optimizer
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8647942543029785  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.932979702949524
pure train time :  3.20082950592041
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.345400094985962
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.002113819122314453
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029051542282104492
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.3477072715759277
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.633600234985352
self.buckets_partition() spend  sec:  2.3767881393432617
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8485841751098633  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.846426010131836  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.45822238922119  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.840688705444336  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.840688705444336  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.60543441772461  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.24874544143677  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.282485008239746  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.248353004455566  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.238253593444824  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.26170301437378  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8859753608703613  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.928752422332764  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.541901111602783  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.923829555511475  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.923962116241455  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.69039821624756  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.304866313934326  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.33972120285034  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.30446100234985  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.270721435546875  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.30557680130005  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0577459335327148  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.02206563949585  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.8633713722229  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.015492916107178  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.015492916107178  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.06712532043457  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.07108402252197  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.24832010269165  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.06897258758545  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.034117698669434  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.21135425567627  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0794744491577148  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.98039436340332  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.588754653930664  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.97564125061035  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.97564125061035  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.73609161376953  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.33254671096802  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.36449909210205  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.33217477798462  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.15493869781494  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.18689155578613  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.952979564666748  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.75962209701538  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.364609241485596  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.754895210266113  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.754895210266113  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.51112937927246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.99079179763794  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.02288341522217  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.990418434143066  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.95846605300903  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.99055814743042  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9747233390808105  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.629340648651123  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.23681402206421  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.62370777130127  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.624594688415527  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.383936405181885  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.792274951934814  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.82755947113037  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.7918643951416  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.75977277755737  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.79505777359009  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0044870376586914  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.628806114196777  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.238162994384766  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.624045372009277  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.624045372009277  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.385741710662842  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.787402629852295  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.82342052459717  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.786983489990234  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.75169897079468  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.78771734237671  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0079307556152344  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.060450553894043  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.64015007019043  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.05592155456543  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.05592155456543  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.780546188354492  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.995511531829834  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.02092885971069  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.99522590637207  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.9592080116272  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.984625816345215  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.035104751586914  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.285248279571533  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.890450954437256  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.28044080734253  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.28044080734253  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.03694438934326  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.23081827163696  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.26799154281616  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.23038578033447  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.20496845245361  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.24214220046997  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0720973014831543  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.201626777648926  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.809027671813965  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.19688129425049  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.19688129425049  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.956132411956787  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.03735685348511  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.07716703414917  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.03689384460449  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.99972057342529  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.039531230926514  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.090080738067627  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.59833002090454  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.207248210906982  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.59357261657715  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.59357261657715  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.35472059249878  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.14555215835571  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.19395065307617  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.14457082748413  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.10517883300781  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.15357780456543  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0149621963500977  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.121545791625977  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.619205474853516  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.11765766143799  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.11765766143799  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.739732265472412  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.372278690338135  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.42321014404297  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.371288299560547  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.322869777679443  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.373801708221436  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8546104431152344  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.58435344696045  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.894450187683105  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.581418991088867  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.581418991088867  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.969640731811523  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.605831623077393  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.615816116333008  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.60571527481079  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.554385662078857  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.56437063217163  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8221211433410645  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.559099674224854  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.869482517242432  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.556169033050537  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.556169033050537  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.944676876068115  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.587963581085205  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.59794807434082  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.587847232818604  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.57786273956299  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.58784770965576  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8346247673034668  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.628756523132324  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.93943977355957  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.625853538513184  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.625853538513184  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 16.01466178894043  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.655296325683594  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.66527557373047  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.655179977416992  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.645195484161377  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.65518045425415  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

number of input  22439189
----------------------------------------after optimizer
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8553223609924316  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8612473011016846
pure train time :  3.187436580657959
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.5020439624786377
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.0031671524047851562
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025966882705688477
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.5055954456329346
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.732754945755005
self.buckets_partition() spend  sec:  2.53171706199646
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8504595756530762  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.845937252044678  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.457491397857666  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.841159343719482  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.841159343719482  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.605602264404297  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.248984813690186  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.282724380493164  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.248592376708984  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.23861312866211  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.26113986968994  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8868470191955566  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.923500061035156  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.536561012268066  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.918489933013916  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.918710231781006  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.685036659240723  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.30134582519531  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.33620071411133  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.30094051361084  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.26720094680786  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.302056312561035  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0594401359558105  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.97594451904297  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.816643714904785  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.96937608718872  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.96937608718872  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.02025032043457  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.02142095565796  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.19865703582764  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.01930856704712  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 43.9844536781311  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.16169023513794  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0790786743164062  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.94931173324585  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.55731439590454  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.94456148147583  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.94456148147583  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.704565048217773  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.301740646362305  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.33369302749634  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.301368713378906  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.12413263320923  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.15608549118042  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.953528881072998  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.72650718688965  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.33139991760254  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.721781253814697  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.721781253814697  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.47789716720581  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.9594669342041  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.99155855178833  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.95909357070923  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.927141189575195  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.95923328399658  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9802989959716797  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.678826332092285  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.287009239196777  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.67407464981079  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.67407464981079  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.434303283691406  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.8436975479126  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.878982067108154  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.84247875213623  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.811195373535156  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.847288608551025  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.013373851776123  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.735525608062744  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.34732675552368  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.730745792388916  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.730745792388916  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.496469974517822  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.89392328262329  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.929941177368164  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.8932843208313  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.85741138458252  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.89350461959839  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0155901908874512  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.125744819641113  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.707186698913574  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.121201992034912  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.121201992034912  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.84800434112549  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.06971740722656  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.09513473510742  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.0694317817688  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.033194065093994  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.05861186981201  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.04298734664917  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.34943151473999  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.955525875091553  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.344696044921875  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.344696044921875  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.102313995361328  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.301249504089355  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.338422775268555  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.300817012786865  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.275399684906006  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.31257343292236  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0713062286376953  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.104344367980957  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.70938205718994  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.09961748123169  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.09961748123169  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.85591459274292  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.929309368133545  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.96911954879761  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.92884635925293  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.89167308807373  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.93148374557495  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0977602005004883  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.639170169830322  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.248918056488037  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.634406089782715  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.634406089782715  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.396591186523438  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.187255859375  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.23565435409546  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.18627452850342  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.1468825340271  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.19528150558472  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0202455520629883  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.11889410018921  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.617082118988037  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.115001678466797  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.115001678466797  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.737736701965332  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.37256383895874  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.423495292663574  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.371971607208252  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.32315492630005  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.37408685684204  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8574938774108887  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.599295616149902  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.908832550048828  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.596520900726318  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.596520900726318  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.984182834625244  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.630048274993896  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.64003276824951  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.629931926727295  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.57900047302246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.588985443115234  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8315601348876953  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.594688415527344  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.904830932617188  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.59182071685791  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.59182071685791  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.980088233947754  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.6260404586792  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.636024951934814  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.625924110412598  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.615939617156982  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.625924587249756  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8410110473632812  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.586023330688477  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.895886421203613  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.583325862884521  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.583325862884521  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.971313953399658  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.612639904022217  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.622619152069092  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.612523555755615  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.6025390625  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.612524032592773  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

number of input  22439466
----------------------------------------after optimizer
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8616786003112793  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.812636137008667
pure train time :  3.212010383605957
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.5161473751068115
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.0031557083129882812
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02680063247680664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.5194952487945557
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.74060344696045
self.buckets_partition() spend  sec:  2.546327829360962
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.850313663482666  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.862273693084717  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.47465944290161  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.8565936088562  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.857489109039307  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.622971534729004  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.26706409454346  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.300803661346436  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.266671657562256  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.25669240951538  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.279666900634766  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8894696235656738  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.96358299255371  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.57785701751709  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.958783626556396  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.958783626556396  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.7266263961792  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.340189933776855  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.37504482269287  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.33978462219238  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.306045055389404  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.34090042114258  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0556607246398926  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.96482515335083  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.805328845977783  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.958258628845215  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.958258628845215  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.008888244628906  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.00879716873169  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.18603324890137  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.00668001174927  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 43.97182512283325  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.14906167984009  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0799541473388672  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.973039150238037  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.58110475540161  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.96828842163086  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.96828842163086  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.728370666503906  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.32508039474487  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.357032775878906  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.324708461761475  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.1474723815918  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.17942523956299  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9524497985839844  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.729426860809326  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.334323406219482  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.724700927734375  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.724700927734375  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.48082160949707  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.96225929260254  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.99435091018677  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.961885929107666  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.92993354797363  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.96202564239502  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9774689674377441  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.737808227539062  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.34713363647461  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.733047485351562  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.733047485351562  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.494704246520996  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.904770851135254  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.94005537033081  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.90436029434204  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.87226867675781  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.90755367279053  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0092601776123047  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.630524158477783  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.240724086761475  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.62575674057007  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.62575674057007  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.38850688934326  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.79583024978638  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.83184814453125  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.795411109924316  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.76012659072876  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.79614496231079  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0120882987976074  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.030391693115234  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.609539031982422  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.025774002075195  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.025774002075195  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.74970817565918  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.968266010284424  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.99368333816528  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.96798038482666  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.93196249008179  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.957380294799805  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0404181480407715  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.29916524887085  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.904639720916748  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.294434547424316  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.294434547424316  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.05127763748169  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.24546766281128  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.28264093399048  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.24503517150879  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.21961784362793  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.25679159164429  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0725054740905762  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.11704444885254  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.722484588623047  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.112314224243164  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.112314224243164  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.8691143989563  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.94365978240967  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.98346996307373  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.94319677352905  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.90602350234985  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.945834159851074  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0977225303649902  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.627746105194092  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.237908840179443  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.622979164123535  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.622979164123535  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.385682582855225  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.17649745941162  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.22489595413208  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.17551612854004  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.13612413406372  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.18452310562134  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.021376609802246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.11765766143799  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.61564350128174  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.11363172531128  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.11363172531128  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.736114025115967  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.370936393737793  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.421867847442627  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.36988592147827  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.3215274810791  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.372459411621094  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8574309349060059  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.61752462387085  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.926928043365479  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.61471176147461  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.61471176147461  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 16.00224018096924  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.638610363006592  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.648594856262207  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.63849401473999  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.587104320526123  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.597089290618896  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8273816108703613  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.559926509857178  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.86897325515747  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.557097434997559  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.557097434997559  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.944269180297852  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.591387271881104  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.60137176513672  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.591270923614502  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.581286430358887  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.59127140045166  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8399443626403809  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.57637882232666  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.886268615722656  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.573957443237305  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.573957443237305  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.9619722366333  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.604290008544922  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.614269256591797  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.60417366027832  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.594189167022705  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.60417413711548  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

number of input  22437369
----------------------------------------after optimizer
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8602733612060547  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7603092193603516
pure train time :  3.181621789932251
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.291729211807251
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.0016565322875976562
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02645421028137207
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.2935712337493896
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.50706934928894
self.buckets_partition() spend  sec:  2.320052146911621
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8469443321228027  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.860919952392578  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.473316192626953  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.855250358581543  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.856135368347168  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.621630668640137  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.26691484451294  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.30065441131592  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.26652240753174  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.25654315948486  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.27957057952881  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8898577690124512  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.94811725616455  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.562148094177246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.94331979751587  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.94331979751587  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.71085834503174  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.32492971420288  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.3597846031189  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.32452440261841  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.29078483581543  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.3256402015686  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0592083930969238  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.040093421936035  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.881972312927246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.03351593017578  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.03351593017578  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.085864543914795  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.08703327178955  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.26426935195923  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.08497142791748  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.050116539001465  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.2273530960083  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.080507755279541  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.035250186920166  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.64407968521118  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.03049325942993  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.03049325942993  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.7915301322937  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.38760328292847  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.4195556640625  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.38723134994507  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.20999526977539  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.24194812774658  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9514856338500977  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.75145196914673  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.356719493865967  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.746723175048828  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.746723175048828  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.503307819366455  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.982765197753906  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.014856815338135  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.98239183425903  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.950439453125  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.98253154754639  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9763498306274414  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.69114589691162  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.299696922302246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.686112880706787  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.686391353607178  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.44708013534546  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.855552196502686  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.89083671569824  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.85514163970947  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.823050022125244  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.85833501815796  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0044612884521484  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.643968105316162  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.254173755645752  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.639200687408447  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.639200687408447  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.402709484100342  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.80809831619263  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.8441162109375  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.807679176330566  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.77239465713501  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.80841302871704  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0079760551452637  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.020545959472656  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.599872589111328  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.016019821166992  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.016019821166992  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.740178108215332  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.958486557006836  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.983903884887695  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.95820093154907  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.9221830368042  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.94760084152222  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.037938117980957  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.302470684051514  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.908141613006592  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.297738552093506  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.297738552093506  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.054827213287354  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.24912452697754  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.28629779815674  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.24869203567505  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.22327470779419  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.26044845581055  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.068284511566162  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.151472568511963  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.757678508758545  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.14673614501953  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.14673614501953  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.904493808746338  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.98773384094238  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.027544021606445  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.98727083206177  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.95009756088257  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.98990821838379  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.088956356048584  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.550583362579346  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.158982753753662  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.54582977294922  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.54582977294922  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.306329250335693  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.09608173370361  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.14448022842407  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.09510040283203  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.05570840835571  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.10410737991333  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0171689987182617  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.14059829711914  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.63826274871826  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.136710166931152  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.136710166931152  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.758790969848633  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.3919677734375  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.442899227142334  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.39137554168701  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.34255886077881  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.3934907913208  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.854733943939209  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.601834774017334  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.91126298904419  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.598970413208008  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.598970413208008  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.986523628234863  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.63367223739624  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.643656730651855  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.63355588912964  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.582624435424805  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.592609405517578  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8261680603027344  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.601055145263672  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.910942077636719  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.598633766174316  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.598633766174316  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.986645698547363  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.62690305709839  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.636887550354004  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.626786708831787  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.616802215576172  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.626787185668945  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8363265991210938  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.558080196380615  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.868163585662842  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.555657386779785  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.555657386779785  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.943865776062012  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.585888862609863  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.59586811065674  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.58577251434326  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.575788021087646  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.58577299118042  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

number of input  22441058
----------------------------------------after optimizer
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8563523292541504  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7314326763153076
pure train time :  3.240963935852051
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
type of fanout_dst_nids  <class 'torch.Tensor'>
the last batch value is  9089
G_BUCKET_ID_list [[11, 13], [9, 15], [4, 1, 0], [12, 14], [10, 17], [8, 16], [19, 7], [18, 20], [6, 21], [22, 5], [23, 3], [2]]
G_BUCKET_ID_list length 12
backpack scheduling spend  2.61159610748291
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  15
current group_mem  24.622599095106125
current group_mem  24.568951159715652
current group_mem  24.562401205301285
current group_mem  24.52305856347084
current group_mem  24.200252294540405
current group_mem  23.781838685274124
current group_mem  23.654122352600098
current group_mem  23.530415385961533
current group_mem  22.75372865796089
current group_mem  22.296287029981613
current group_mem  20.90202087163925
current group_mem  9.089418947696686
batches output list generation spend  0.0022199153900146484
self.weights_list  [0.04361904903912344, 0.0450612543790109, 0.22913503299842028, 0.041308704011584034, 0.041488461943092116, 0.04561626734726167, 0.046564759658675306, 0.031738458008298685, 0.04805832440756508, 0.05146709808570229, 0.06257067096097596, 0.06584524747365553, 0.012907779210870964, 0.012907779210870964, 0.012901152190354537]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02632904052734375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.614206314086914
num_output  955108
self.output_nids  1207179
output nodes length not match !!!!
partition total batch output list spend :  9.774350643157959
self.buckets_partition() spend  sec:  2.640573740005493
step  0
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8498897552490234  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.84608554840088  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.45857048034668  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.84050416946411  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.84130048751831  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.60690689086914  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.25062942504883  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.28436899185181  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.25023698806763  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.24025774002075  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.263572692871094  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  1
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.889315128326416  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.026471614837646  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.641116619110107  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.021669387817383  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.021669387817383  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.78997564315796  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.40301465988159  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.43786954879761  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.40260934829712  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.36886978149414  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.403725147247314  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  2
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0576071739196777  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.00668239593506  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.847192764282227  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.000115871429443  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 29.000115871429443  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.050754070281982  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.0538911819458  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.23112726211548  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.05151844024658  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.016663551330566  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 44.1939001083374  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  3
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0816631317138672  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.981178760528564  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.58963441848755  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.976425170898438  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.976425170898438  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.736994743347168  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.33242750167847  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.3643798828125  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.33205556869507  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.15481948852539  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.18677234649658  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  4
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9545841217041016  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.746036052703857  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.35083246231079  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.741311073303223  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.741311073303223  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.49730682373047  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.97700643539429  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 41.009098052978516  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.976633071899414  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.94468069076538  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.97677278518677  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  5
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.9808363914489746  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.684480667114258  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.292980194091797  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.679726600646973  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.679726600646973  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.440351009368896  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.84870910644531  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.88399362564087  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.8482985496521  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.81620693206787  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.851491928100586  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  6
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.007523536682129  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.661158561706543  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.27092742919922  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.656394481658936  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.656394481658936  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 28.41860580444336  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.821086406707764  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.85710430145264  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.8206672668457  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.78538274765015  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.82140111923218  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  7
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.011178970336914  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.063745975494385  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.6432147026062  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.059218406677246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.059218406677246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.783554553985596  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.997594356536865  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.023011684417725  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.9973087310791  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.96129083633423  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.986708641052246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  8
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.035597324371338  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.22814178466797  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.832372665405273  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.223421096801758  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.223421096801758  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.97870969772339  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.167996883392334  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.20517015457153  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.167564392089844  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.142147064208984  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.17932081222534  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  9
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.071293830871582  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.156654834747314  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.763116359710693  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.15187978744507  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.15187978744507  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.90995693206787  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.993728160858154  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 40.03353834152222  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.99326515197754  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.95609188079834  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.99590253829956  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  10
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.0951957702636719  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.655330181121826  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.265636920928955  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.650561809539795  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 26.650561809539795  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 27.4142804145813  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.20339822769165  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.25179672241211  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.20241689682007  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.16302490234375  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 39.21142387390137  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  11
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 1.018880844116211  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.150441646575928  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.64895009994507  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.146546840667725  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.146546840667725  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.76968240737915  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.401763916015625  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.45269536972046  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.401171684265137  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.352355003356934  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 30.403286933898926  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  12
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8541903495788574  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.601305484771729  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.911179065704346  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.598345279693604  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.598345279693604  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.98634386062622  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.622082710266113  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.63206720352173  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.62196636199951  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.571034908294678  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.58101987838745  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  13
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8217320442199707  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.495787143707275  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.804652690887451  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.492790699005127  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.492790699005127  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.879781246185303  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.522932529449463  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.532917022705078  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.52230215072632  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.512831687927246  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.52281665802002  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

step  14
<class 'torch.Tensor'>
cuda:0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8387269973754883  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.643013954162598  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.95287799835205  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.640081405639648  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 15.640081405639648  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 16.0280704498291  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------refore rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.670083045959473  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.680062294006348  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.66996669769287  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.659468173980713  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 21.669447898864746  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

number of input  22430853
----------------------------------------after optimizer
 Nvidia-smi: 66.10052490234375 GB
    Memory Allocated: 0.8586592674255371  GigaBytes
Max Memory Allocated: 45.39523506164551  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.686793565750122
pure train time :  3.192354440689087
epoch_time_list  [55.118661880493164, 55.00356078147888, 59.966073989868164, 51.85407614707947, 50.805495500564575, 50.49281549453735, 51.276368379592896, 53.00530791282654, 53.79833197593689, 51.420888900756836, 51.681809425354004, 51.853477239608765, 53.34840774536133, 50.76210308074951, 51.33445191383362, 51.384947299957275, 51.149895906448364, 51.92265439033508, 51.24869441986084, 51.404295206069946]

loading_time list   [0.7324011325836182, 0.7385294437408447, 0.7823529243469238, 1.0197410583496094, 0.45896339416503906, 0.5171792507171631, 0.5118916034698486, 0.4973940849304199, 0.552018404006958, 0.5353028774261475, 0.6541945934295654, 0.519028902053833, 0.6006665229797363, 0.5185775756835938, 0.5369675159454346, 0.591235876083374, 0.5970323085784912, 0.6066064834594727, 0.6071028709411621, 0.5916163921356201]

 data loader gen time  42.705883502960205
	---backpack schedule time  [9.466314315795898, 9.930506467819214, 9.824967622756958, 9.33716106414795, 9.594546794891357, 9.545902013778687, 9.604954242706299, 9.758625984191895, 9.539031505584717, 9.494033336639404, 9.771283864974976, 9.53761625289917, 10.41609263420105, 9.635412216186523, 9.801100254058838, 9.734069585800171, 9.836648941040039, 9.845510005950928, 9.610726833343506, 9.877300024032593]
	---connection_check_time_list  [4.758051156997681, 6.159686803817749, 12.078734636306763, 4.986549615859985, 4.825490713119507, 4.713731050491333, 4.707128047943115, 6.312555313110352, 7.702193975448608, 5.388211250305176, 4.71079158782959, 4.719085454940796, 5.823246002197266, 4.597246170043945, 4.665321350097656, 4.772042274475098, 4.676923513412476, 5.268438816070557, 4.798925399780273, 4.773495197296143]
	---block_gen_time_list  [4.1500749588012695, 4.403713941574097, 4.465413331985474, 3.8874502182006836, 3.6998353004455566, 3.6887643337249756, 4.083966493606567, 3.9624695777893066, 3.776000499725342, 3.917449951171875, 4.107904434204102, 3.868086576461792, 4.096901178359985, 3.7730002403259277, 3.6932127475738525, 3.936868667602539, 3.6119091510772705, 3.8727853298187256, 3.653737783432007, 3.783588409423828]
training time  [11.586517333984375, 8.696631669998169, 8.290658473968506, 8.069774866104126, 8.199631452560425, 8.017783880233765, 8.184632062911987, 8.293787717819214, 8.220181465148926, 8.099449634552002, 8.254817485809326, 8.90980339050293, 8.214943408966064, 8.108251094818115, 8.40511703491211, 8.092443704605103, 8.35249924659729, 8.076292514801025, 8.400247812271118, 8.098348140716553]
---feature block loading time  [6.645069599151611, 5.37223482131958, 4.9933130741119385, 4.78082275390625, 4.883241176605225, 4.726574420928955, 4.882746458053589, 4.95612359046936, 4.920878648757935, 4.779723167419434, 4.945344686508179, 5.513734579086304, 4.877982139587402, 4.783191919326782, 5.074706315994263, 4.77886438369751, 5.010416030883789, 4.76546573638916, 5.02800989151001, 4.780423402786255]


epoch_time avg   51.680621549487114
loading_time avg   0.5559861660003662
 data loader gen time avg 42.872085243463516
	---backpack schedule time avg 9.72517840564251
	---connection_check_time avg  5.153426632285118
	---block_gen_time avg  3.8454050421714783
training time  8.245514377951622
---feature block loading time  4.919214159250259
pure train time per /epoch  [4.927948474884033, 3.1954541206359863, 3.1699230670928955, 3.162900924682617, 3.186145782470703, 3.165146827697754, 3.1720309257507324, 3.2051010131835938, 3.170539617538452, 3.1903345584869385, 3.181791305541992, 3.2601253986358643, 3.2093451023101807, 3.199902296066284, 3.20082950592041, 3.187436580657959, 3.212010383605957, 3.181621789932251, 3.240963935852051, 3.192354440689087]
pure train time average  3.19521061111899
num_input list  [22440132, 22435492, 22436198, 22434509, 22437151, 22430732, 22426855, 22431668, 22436590, 22430859, 22438758, 22439749, 22432446, 22434691, 22436387, 22439189, 22439466, 22437369, 22441058, 22430853]
num_input  average  22435507.6
