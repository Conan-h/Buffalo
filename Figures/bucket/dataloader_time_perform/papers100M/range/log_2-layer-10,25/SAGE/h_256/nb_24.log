main start at this time 1714078275.1242566
-----------------------------------------before load data 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
# Nodes: 111059956
# Edges: 1615685872
# Train: 1207179
# Val: 125265
# Test: 109727512
# Classes: 172

----------------------------------------start of run function 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.14551401138305664
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0375978946685791
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15453362464904785
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 1.22113037109375 GB
    Memory Allocated: 0.003025054931640625  GigaBytes
Max Memory Allocated: 0.003025054931640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.77972412109375 GB
    Memory Allocated: 0.5600419044494629  GigaBytes
Max Memory Allocated: 0.5600419044494629  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.77972412109375 GB
    Memory Allocated: 0.5604166984558105  GigaBytes
Max Memory Allocated: 0.5604166984558105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.81878662109375 GB
    Memory Allocated: 0.5804171562194824  GigaBytes
Max Memory Allocated: 0.5804171562194824  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 26.94378662109375 GB
    Memory Allocated: 24.842233657836914  GigaBytes
Max Memory Allocated: 25.45914649963379  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 26.94378662109375 GB
    Memory Allocated: 24.874464511871338  GigaBytes
Max Memory Allocated: 25.45914649963379  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 27.39495849609375 GB
    Memory Allocated: 0.6240191459655762  GigaBytes
Max Memory Allocated: 25.45914649963379  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 27.39495849609375 GB
    Memory Allocated: 1.179840087890625  GigaBytes
Max Memory Allocated: 25.45914649963379  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 27.39495849609375 GB
    Memory Allocated: 1.1802148818969727  GigaBytes
Max Memory Allocated: 25.45914649963379  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 27.39495849609375 GB
    Memory Allocated: 0.6427960395812988  GigaBytes
Max Memory Allocated: 25.45914649963379  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 24.81403923034668  GigaBytes
Max Memory Allocated: 25.462834358215332  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 24.846269607543945  GigaBytes
Max Memory Allocated: 25.462834358215332  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 0.6361451148986816  GigaBytes
Max Memory Allocated: 25.462834358215332  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 1.1931118965148926  GigaBytes
Max Memory Allocated: 25.462834358215332  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 1.1934866905212402  GigaBytes
Max Memory Allocated: 25.462834358215332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 0.6572837829589844  GigaBytes
Max Memory Allocated: 25.462834358215332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 24.83501434326172  GigaBytes
Max Memory Allocated: 25.48297643661499  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 24.867244720458984  GigaBytes
Max Memory Allocated: 25.48297643661499  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 0.6496868133544922  GigaBytes
Max Memory Allocated: 25.48297643661499  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 1.2063541412353516  GigaBytes
Max Memory Allocated: 25.48297643661499  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 1.2067289352416992  GigaBytes
Max Memory Allocated: 25.48297643661499  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 0.669377326965332  GigaBytes
Max Memory Allocated: 25.48297643661499  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.88909912109375 GB
    Memory Allocated: 24.85490846633911  GigaBytes
Max Memory Allocated: 25.500144958496094  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 28.88909912109375 GB
    Memory Allocated: 24.887138843536377  GigaBytes
Max Memory Allocated: 25.500144958496094  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 28.88909912109375 GB
    Memory Allocated: 0.663872241973877  GigaBytes
Max Memory Allocated: 25.500144958496094  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 28.88909912109375 GB
    Memory Allocated: 1.2208614349365234  GigaBytes
Max Memory Allocated: 25.500144958496094  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 28.88909912109375 GB
    Memory Allocated: 1.221236228942871  GigaBytes
Max Memory Allocated: 25.500144958496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.88909912109375 GB
    Memory Allocated: 0.684180736541748  GigaBytes
Max Memory Allocated: 25.500144958496094  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.89105224609375 GB
    Memory Allocated: 24.86688470840454  GigaBytes
Max Memory Allocated: 25.513224124908447  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 28.89105224609375 GB
    Memory Allocated: 24.899115085601807  GigaBytes
Max Memory Allocated: 25.513224124908447  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 28.89105224609375 GB
    Memory Allocated: 0.6766700744628906  GigaBytes
Max Memory Allocated: 25.513224124908447  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 28.89105224609375 GB
    Memory Allocated: 1.236557960510254  GigaBytes
Max Memory Allocated: 25.513224124908447  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 28.89105224609375 GB
    Memory Allocated: 1.2369327545166016  GigaBytes
Max Memory Allocated: 25.513224124908447  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.89105224609375 GB
    Memory Allocated: 0.699683666229248  GigaBytes
Max Memory Allocated: 25.513224124908447  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 25.040297985076904  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 25.07252836227417  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 0.6920037269592285  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 1.24786376953125  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 1.2482385635375977  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 0.7079448699951172  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 24.748245239257812  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 24.780475616455078  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 0.7006831169128418  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 1.2570242881774902  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 1.257399082183838  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 0.7211322784423828  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 24.81988286972046  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 24.852113246917725  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 0.7137141227722168  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 1.2716245651245117  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 1.2719993591308594  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 36.63323974609375 GB
    Memory Allocated: 0.7353839874267578  GigaBytes
Max Memory Allocated: 25.698264122009277  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37347412109375 GB
    Memory Allocated: 25.050155639648438  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.37347412109375 GB
    Memory Allocated: 25.082386016845703  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 37.37347412109375 GB
    Memory Allocated: 0.7275524139404297  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.37347412109375 GB
    Memory Allocated: 1.2858452796936035  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.37347412109375 GB
    Memory Allocated: 1.2862200736999512  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37347412109375 GB
    Memory Allocated: 0.7479038238525391  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 24.872068881988525  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 24.90429925918579  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.7408041954040527  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.29890775680542  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.2992825508117676  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.7605972290039062  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 24.91151475906372  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 24.943745136260986  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.7530126571655273  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.304023265838623  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.3043980598449707  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.7658934593200684  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 24.84580898284912  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 24.878039360046387  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.7592897415161133  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.3149991035461426  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.3153738975524902  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.7847681045532227  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 24.86694574356079  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 24.899176120758057  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.7785778045654297  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.334578514099121  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.3349533081054688  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.798858642578125  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 24.9430832862854  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 24.975313663482666  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.7915740013122559  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.3484539985656738  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.3488287925720215  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.8124604225158691  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 25.021896839141846  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 25.05412721633911  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.8060860633850098  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.3636317253112793  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.364006519317627  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.8267951011657715  GigaBytes
Max Memory Allocated: 25.702686309814453  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 25.08177089691162  GigaBytes
Max Memory Allocated: 25.732295989990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 25.114001274108887  GigaBytes
Max Memory Allocated: 25.732295989990234  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.8198814392089844  GigaBytes
Max Memory Allocated: 25.732295989990234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.3779945373535156  GigaBytes
Max Memory Allocated: 25.732295989990234  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 1.3783693313598633  GigaBytes
Max Memory Allocated: 25.732295989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.37933349609375 GB
    Memory Allocated: 0.8410549163818359  GigaBytes
Max Memory Allocated: 25.732295989990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.39495849609375 GB
    Memory Allocated: 25.06793451309204  GigaBytes
Max Memory Allocated: 25.732295989990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.39495849609375 GB
    Memory Allocated: 25.100164890289307  GigaBytes
Max Memory Allocated: 25.732295989990234  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 37.39495849609375 GB
    Memory Allocated: 0.8332514762878418  GigaBytes
Max Memory Allocated: 25.732295989990234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.39495849609375 GB
    Memory Allocated: 1.396899700164795  GigaBytes
Max Memory Allocated: 25.732295989990234  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.39495849609375 GB
    Memory Allocated: 1.3972744941711426  GigaBytes
Max Memory Allocated: 25.732295989990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.39495849609375 GB
    Memory Allocated: 0.859072208404541  GigaBytes
Max Memory Allocated: 25.732295989990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.255878448486328  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.288108825683594  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8513789176940918  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4135103225708008  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4138851165771484  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8708953857421875  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.208173751831055  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.24131488800049  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8638324737548828  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4193997383117676  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4197745323181152  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8774490356445312  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.181548595428467  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.213778972625732  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8697280883789062  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4319572448730469  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4323320388793945  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8965601921081543  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.207692623138428  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.239923000335693  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8900318145751953  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.447941780090332  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4483165740966797  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.9066362380981445  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.046062469482422  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.078292846679688  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8988499641418457  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4532089233398438  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4535837173461914  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.9153075218200684  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.127663612365723  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.15989398956299  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.9090228080749512  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4649076461791992  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4652824401855469  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.9313650131225586  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.06413698196411  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.096367359161377  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

number of input  28053280
----------------------------------------after optimizer
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.9621624946594238  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.175320625305176
pure train time :  11.584654569625854
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.1462254524230957
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03763866424560547
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1570720672607422
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.6274805068969727  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.187459945678711  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.1878347396850586  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.6516327857971191  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.930494785308838  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.948731422424316  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.6331405639648438  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.1902427673339844  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.190617561340332  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.6502904891967773  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.73067331314087  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.762903690338135  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.6425642967224121  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.1948680877685547  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.1952428817749023  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.6577901840209961  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.637422561645508  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.669652938842773  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.6502513885498047  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.2076926231384277  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.2080674171447754  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.6754035949707031  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.75599479675293  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.788225173950195  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.6677737236022949  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.2212581634521484  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.221632957458496  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.6838526725769043  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.852149963378906  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.884380340576172  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.6764326095581055  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.2349514961242676  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.2353262901306152  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.7015895843505859  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.03010129928589  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.062331676483154  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.6944670677185059  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.2481403350830078  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.2485151290893555  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.7096428871154785  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.695390224456787  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.727620601654053  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.702324390411377  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.2599945068359375  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.2603693008422852  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.726356029510498  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.891892910003662  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.924123287200928  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.7188310623168945  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.278134822845459  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.2785096168518066  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.7413043975830078  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.003361225128174  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.03559160232544  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.73394775390625  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.2953367233276367  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.2957115173339844  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.7561659812927246  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.092105388641357  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.124335765838623  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.750124454498291  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3019800186157227  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3023548126220703  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.7613840103149414  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.880614280700684  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.91284465789795  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.7539830207824707  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3094892501831055  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3098640441894531  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.7777976989746094  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.783702850341797  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.815933227539062  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.7703747749328613  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3226170539855957  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3229918479919434  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.787139892578125  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.871509552001953  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.90373992919922  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.7797589302062988  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3370447158813477  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3374195098876953  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8048362731933594  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.013547897338867  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.045778274536133  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.7972807884216309  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3537635803222656  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3541383743286133  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8167190551757812  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.056668281555176  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.08889865875244  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8095817565917969  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3707976341247559  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3711724281311035  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8344507217407227  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.17260980606079  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.204840183258057  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.827568531036377  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.382887840270996  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3832626342773438  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.841740608215332  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 24.968371868133545  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.001216888427734  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8342642784118652  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3961386680603027  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.3965134620666504  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8609800338745117  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.25055170059204  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.282782077789307  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8557953834533691  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4110922813415527  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4114670753479004  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.869293212890625  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.059068202972412  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.091469764709473  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8627800941467285  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4229249954223633  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.423299789428711  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8885498046875  GigaBytes
Max Memory Allocated: 25.9114408493042  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.278650283813477  GigaBytes
Max Memory Allocated: 25.934635639190674  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.310880661010742  GigaBytes
Max Memory Allocated: 25.934635639190674  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8817262649536133  GigaBytes
Max Memory Allocated: 25.934635639190674  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4428067207336426  GigaBytes
Max Memory Allocated: 25.934635639190674  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4431815147399902  GigaBytes
Max Memory Allocated: 25.934635639190674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.9027962684631348  GigaBytes
Max Memory Allocated: 25.934635639190674  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.22526979446411  GigaBytes
Max Memory Allocated: 25.934635639190674  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.258408546447754  GigaBytes
Max Memory Allocated: 25.934635639190674  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.8947372436523438  GigaBytes
Max Memory Allocated: 25.934635639190674  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4561147689819336  GigaBytes
Max Memory Allocated: 25.934635639190674  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4564895629882812  GigaBytes
Max Memory Allocated: 25.934635639190674  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.9152007102966309  GigaBytes
Max Memory Allocated: 25.934635639190674  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.298210620880127  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 25.330440998077393  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.9085526466369629  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.4714670181274414  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 1.471841812133789  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.46527099609375 GB
    Memory Allocated: 0.9302244186401367  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.261284828186035  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.2935152053833  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9239540100097656  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4783711433410645  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.478745937347412  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9359064102172852  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.023024559020996  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.055241584777832  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

number of input  28055447
----------------------------------------after optimizer
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9613480567932129  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.74425745010376
pure train time :  11.392231225967407
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.151475191116333
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030618906021118164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16677594184875488
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6259264945983887  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1845202445983887  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1848950386047363  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6505212783813477  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.85235834121704  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.870681285858154  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6320409774780273  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1850061416625977  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1853809356689453  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6463656425476074  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.768028736114502  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.800259113311768  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6393184661865234  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1952600479125977  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1956348419189453  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6631460189819336  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.72051191329956  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.752742290496826  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6563491821289062  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2095613479614258  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2099361419677734  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6735315322875977  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.69339609146118  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.725626468658447  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6660614013671875  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.224647045135498  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2250218391418457  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6916003227233887  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.049089431762695  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.08131980895996  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6838102340698242  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2409391403198242  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2413139343261719  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7030744552612305  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.78806495666504  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.820295333862305  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6954460144042969  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2520818710327148  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2524566650390625  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7148666381835938  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.774786949157715  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.80701732635498  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7074370384216309  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2672786712646484  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.267653465270996  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7307863235473633  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.08785915374756  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.120089530944824  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7233572006225586  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2801775932312012  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2805523872375488  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7404003143310547  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.941869258880615  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.97409963607788  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.732607364654541  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2899055480957031  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2902803421020508  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7535724639892578  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.93667984008789  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.968910217285156  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7460675239562988  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3006038665771484  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.300978660583496  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7640485763549805  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.840134620666504  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.87236499786377  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7564473152160645  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3154339790344238  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3158087730407715  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7809429168701172  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.893214225769043  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.92544460296631  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.773036003112793  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3306260108947754  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.331000804901123  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7916998863220215  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.95964765548706  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.991878032684326  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7849626541137695  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3415803909301758  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3419551849365234  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8040518760681152  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.958843231201172  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.991073608398438  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7964248657226562  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3551526069641113  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.355527400970459  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8186697959899902  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.127094268798828  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.159324645996094  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8115215301513672  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3740854263305664  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.374460220336914  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.836235523223877  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.201207160949707  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.233437538146973  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8299951553344727  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3930115699768066  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3933863639831543  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.850644588470459  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.25890827178955  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.291138648986816  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8427610397338867  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4004616737365723  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.40083646774292  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8575544357299805  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.098271369934082  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.130501747131348  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.851283073425293  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4080605506896973  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.408435344696045  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8704891204833984  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.160436630249023  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.19266700744629  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8641791343688965  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4222087860107422  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4225835800170898  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8855509757995605  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.16690683364868  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.199137210845947  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8777532577514648  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4316816329956055  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4320564270019531  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8940415382385254  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.999125003814697  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.031355381011963  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8877124786376953  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4448957443237305  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4452705383300781  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9110946655273438  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.205008506774902  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.237238883972168  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9043412208557129  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4633336067199707  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4637084007263184  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9262566566467285  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.16751718521118  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.199747562408447  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9183225631713867  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4738826751708984  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.474257469177246  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9350013732910156  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.175230503082275  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.20744752883911  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

number of input  28053627
----------------------------------------after optimizer
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9607324600219727  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.529326438903809
pure train time :  11.771531820297241
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.23669075965881348
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.06003832817077637
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.2476646900177002
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6272764205932617  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1882243156433105  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1885991096496582  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6527466773986816  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.95180082321167  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.969916820526123  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6342167854309082  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1943888664245605  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1947636604309082  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6535072326660156  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.94779682159424  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.980027198791504  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6460657119750977  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2046594619750977  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2050342559814453  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6645355224609375  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.869946002960205  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.90217638015747  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6577410697937012  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.214284896850586  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2146596908569336  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6757383346557617  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.809614181518555  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.84184455871582  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6682353019714355  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.228057861328125  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2284326553344727  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6924142837524414  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.02061939239502  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.052849769592285  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6848149299621582  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2393980026245117  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2397727966308594  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7001829147338867  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.874452590942383  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.90668296813965  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6926522254943848  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.251288890838623  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2516636848449707  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7168331146240234  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.045776844024658  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.078007221221924  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7096190452575684  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2659192085266113  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.266294002532959  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7273268699645996  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.835236072540283  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.86803913116455  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7195630073547363  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.276374340057373  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2767491340637207  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7401237487792969  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.943495750427246  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.97572612762451  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7323718070983887  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2869548797607422  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2873296737670898  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7501964569091797  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.89158058166504  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.923810958862305  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7436342239379883  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3003530502319336  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3007278442382812  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7658390998840332  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.033036708831787  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.065267086029053  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7586884498596191  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3161206245422363  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.316495418548584  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7794613838195801  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.017984867095947  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.050215244293213  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7731842994689941  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3304219245910645  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.330796718597412  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7930822372436523  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.070191860198975  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.10242223739624  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7851953506469727  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3401689529418945  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3405437469482422  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8029718399047852  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.862562656402588  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.894793033599854  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7962231636047363  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3547639846801758  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3551387786865234  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8207001686096191  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.1641902923584  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.196420669555664  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.813835620880127  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3732037544250488  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3735785484313965  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8350238800048828  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.242835521697998  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.275065898895264  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8283786773681641  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3862123489379883  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.386587142944336  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.846921443939209  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.050578117370605  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.08280849456787  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.840111255645752  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4002552032470703  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.400629997253418  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8625478744506836  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.165329456329346  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.19755983352661  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8559412956237793  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.412363052368164  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4127378463745117  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8723254203796387  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.988469123840332  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.020699501037598  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8658576011657715  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4213452339172363  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.421720027923584  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8850383758544922  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.038013458251953  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.07024383544922  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8773736953735352  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4354333877563477  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4358081817626953  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9000558853149414  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.08089828491211  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.113128662109375  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8921723365783691  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4446191787719727  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4449939727783203  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9070644378662109  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.83818292617798  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.870413303375244  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8995609283447266  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.460592269897461  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4609670639038086  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9282803535461426  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.23319101333618  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.265421390533447  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9208617210388184  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.475560188293457  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4759349822998047  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9346208572387695  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.9695086479187  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.001739025115967  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

number of input  28054061
----------------------------------------after optimizer
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9588847160339355  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.302203178405762
pure train time :  11.851295948028564
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.15903711318969727
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03340649604797363
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16805386543273926
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6249971389770508  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1792888641357422  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1796636581420898  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6450710296630859  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.751725673675537  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.771259307861328  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6281085014343262  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1797795295715332  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1801543235778809  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6453566551208496  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.707571029663086  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.73980140686035  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6382331848144531  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1916875839233398  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1920623779296875  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6599774360656738  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.78438425064087  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.816614627838135  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6529989242553711  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2080235481262207  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2083983421325684  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6745328903198242  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.79097890853882  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.823209285736084  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6675405502319336  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2264060974121094  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.226780891418457  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6913952827453613  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.89130449295044  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.923534870147705  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6838216781616211  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2449188232421875  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2452936172485352  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7069911956787109  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.08016014099121  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.112390518188477  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6992135047912598  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2517876625061035  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2521624565124512  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7106742858886719  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.893882751464844  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.92611312866211  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7034211158752441  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2626252174377441  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2630000114440918  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7309203147888184  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.982404708862305  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.01463508605957  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7238426208496094  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2783689498901367  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2787437438964844  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7391629219055176  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.91395664215088  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.946187019348145  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7316584587097168  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.290964126586914  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2913389205932617  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7568597793579102  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.87846088409424  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.910691261291504  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7500147819519043  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3078436851501465  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3082184791564941  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7694540023803711  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.105799198150635  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.1380295753479  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7624597549438477  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3185548782348633  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.318929672241211  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7807130813598633  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.924081325531006  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.95631170272827  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7747430801391602  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.329174518585205  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3295493125915527  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7930073738098145  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.87714672088623  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.909377098083496  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7859582901000977  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3449010848999023  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.34527587890625  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8105983734130859  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.919583797454834  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.9518141746521  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8044791221618652  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3677239418029785  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3680987358093262  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8288750648498535  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.129326820373535  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.1615571975708  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8216648101806641  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3777318000793457  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3781065940856934  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8354172706604004  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.009490966796875  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.04172134399414  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.828423023223877  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3874359130859375  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3878107070922852  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.851386547088623  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.06989622116089  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.102126598358154  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8452672958374023  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4011850357055664  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.401559829711914  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.862236499786377  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.15867328643799  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.190903663635254  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.855381965637207  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4183058738708496  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4186806678771973  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.882540225982666  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.237767219543457  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.269997596740723  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8764100074768066  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4353151321411133  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.435689926147461  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.892423152923584  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.132670402526855  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.16490077972412  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8851656913757324  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4410285949707031  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4414033889770508  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9021210670471191  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.03420066833496  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.066431045532227  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8966436386108398  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4521288871765137  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4525036811828613  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9161953926086426  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.898886680603027  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.931117057800293  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.909334659576416  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4698419570922852  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4702167510986328  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9345526695251465  GigaBytes
Max Memory Allocated: 25.95587921142578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.390094757080078  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.422325134277344  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.927095890045166  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.488039493560791  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.4884142875671387  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9476733207702637  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.27027130126953  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.302488327026367  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28051890
----------------------------------------after optimizer
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.9718990325927734  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.001030921936035
pure train time :  12.569901943206787
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.16228103637695312
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.037233829498291016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.17104172706604004
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6310725212097168  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1838784217834473  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.184253215789795  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6432023048400879  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.593543529510498  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.61324691772461  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6257715225219727  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1837787628173828  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.1841535568237305  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6509208679199219  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.772101879119873  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.80433225631714  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.643404483795166  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2021913528442383  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.202566146850586  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6643123626708984  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.00390863418579  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.036139011383057  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.657477855682373  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2146224975585938  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2149972915649414  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6757693290710449  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.7666916847229  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.798922061920166  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.668668270111084  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2243595123291016  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2247343063354492  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6873221397399902  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.903348445892334  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.9355788230896  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6801772117614746  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2387709617614746  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2391457557678223  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7031755447387695  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.875689029693604  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.90791940689087  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.6962151527404785  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2548270225524902  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.255201816558838  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7163348197937012  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.919381141662598  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.951611518859863  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7086887359619141  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2634797096252441  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2638545036315918  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7253150939941406  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.861780166625977  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.894010543823242  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7175774574279785  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2757182121276855  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2760930061340332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7410402297973633  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.025485515594482  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.057715892791748  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7339520454406738  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.289482593536377  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.2898573875427246  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7514519691467285  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.95164203643799  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.983872413635254  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7452936172485352  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.302938461303711  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3033132553100586  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7675180435180664  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.97565221786499  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.007882595062256  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7598862648010254  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3204593658447266  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3208341598510742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7837200164794922  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.048241138458252  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.080471515655518  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7762637138366699  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3332366943359375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3336114883422852  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7927422523498535  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.866989612579346  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.89921998977661  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.7849068641662598  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3427972793579102  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3431720733642578  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8059296607971191  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 24.977734565734863  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.00996494293213  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.798804759979248  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3549208641052246  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3552956581115723  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8171424865722656  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.092559337615967  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 25.124789714813232  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8093404769897461  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.372363567352295  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 1.3727383613586426  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.47503662109375 GB
    Memory Allocated: 0.8365316390991211  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.153199672698975  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.18543004989624  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.8295125961303711  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.3875946998596191  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.3879694938659668  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.8446788787841797  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.083337783813477  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.115568161010742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.8369631767272949  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.3943171501159668  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.3946919441223145  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.8563718795776367  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.20714807510376  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.239378452301025  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.8486156463623047  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.4090824127197266  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.4094572067260742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.8720121383666992  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.14497709274292  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.177207469940186  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.866851806640625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.4255361557006836  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.4259109497070312  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.8857316970825195  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.10210609436035  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.134336471557617  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.8780879974365234  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.4371509552001953  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.437525749206543  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.898780345916748  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.13359785079956  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.165828227996826  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.8909268379211426  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.4479408264160156  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.4483156204223633  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.9097638130187988  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.110954761505127  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.143185138702393  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.9030861854553223  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.4594664573669434  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.459841251373291  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.9225492477416992  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.06449794769287  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.096728324890137  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.9156675338745117  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.4690918922424316  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.4694666862487793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.9327988624572754  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.033841609954834  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.0660719871521  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28061073
----------------------------------------after optimizer
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.9570164680480957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7350850105285645
pure train time :  11.836012601852417
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.15830349922180176
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03335428237915039
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1711571216583252
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.6235342025756836  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.181370735168457  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.1817455291748047  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.6480293273925781  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 24.923255920410156  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 24.942978382110596  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.6312899589538574  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.1919755935668945  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.1923503875732422  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.6542930603027344  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.02812671661377  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 25.060357093811035  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.6463460922241211  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.2059364318847656  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.2063112258911133  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.6660270690917969  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 24.95171070098877  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 24.983941078186035  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.6583514213562012  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.2158727645874023  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.21624755859375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.676353931427002  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 24.78084897994995  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 24.813079357147217  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.6688456535339355  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.2269887924194336  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.2273635864257812  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.6903843879699707  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 24.92651891708374  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 24.958749294281006  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.6824517250061035  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.2401008605957031  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.2404756546020508  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.7020797729492188  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 24.877674102783203  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 24.90990447998047  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.6944589614868164  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.2515931129455566  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.2519679069519043  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.7140116691589355  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 24.82494831085205  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 24.857178688049316  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.7065715789794922  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.2705082893371582  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 1.2708830833435059  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.21527099609375 GB
    Memory Allocated: 0.7336902618408203  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.181442737579346  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.21367311477661  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7263784408569336  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2844977378845215  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2848725318908691  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7407279014587402  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.015334129333496  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.04756450653076  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7332010269165039  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.292910099029541  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2932848930358887  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.755828857421875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.070228099822998  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.102458477020264  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7493529319763184  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3034696578979492  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3038444519042969  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7637834548950195  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.876208305358887  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.908438682556152  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7579636573791504  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3162784576416016  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3166532516479492  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7829952239990234  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.023777961730957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.056008338928223  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7765059471130371  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.327247142791748  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3276219367980957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7889246940612793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.7707781791687  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.803008556365967  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7812557220458984  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3389320373535156  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3393068313598633  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8083858489990234  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.0621657371521  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.094396114349365  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8025054931640625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3592424392700195  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3596172332763672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8215994834899902  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.010469913482666  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.04270029067993  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8152976036071777  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3730082511901855  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3733830451965332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8370418548583984  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.076504707336426  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.10873508453369  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8304119110107422  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3845314979553223  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.38490629196167  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8468294143676758  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.89669418334961  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.928924560546875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8394041061401367  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.398848056793213  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3992228507995605  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8647599220275879  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.09825897216797  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.130489349365234  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8577976226806641  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.412574291229248  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4129490852355957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8731503486633301  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.975407123565674  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.00763750076294  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8663887977600098  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.424811840057373  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4251866340637207  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8900618553161621  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.0161075592041  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.048337936401367  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8839111328125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.442284107208252  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4426589012145996  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9039015769958496  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.160719871520996  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.19295024871826  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8960156440734863  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4536280632019043  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.454002857208252  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9152884483337402  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.09099292755127  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.123223304748535  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9078106880187988  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4669280052185059  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4673027992248535  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.930450439453125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.194108963012695  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.22633934020996  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9227113723754883  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4767146110534668  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4770894050598145  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9384307861328125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.13393211364746  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.166162490844727  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28063021
----------------------------------------after optimizer
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.962557315826416  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.5107784271240234
pure train time :  11.830702543258667
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.15817832946777344
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030421972274780273
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16718268394470215
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6248435974121094  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.1814384460449219  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.1818132400512695  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6475849151611328  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.877176761627197  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.89616870880127  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6298675537109375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.191490650177002  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.1918654441833496  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6550383567810059  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.018412590026855  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.05064296722412  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6481518745422363  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2070379257202148  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2074127197265625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6655402183532715  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.904026985168457  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.936257362365723  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6575741767883301  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2145862579345703  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.214961051940918  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6758437156677246  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.977065086364746  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.00929546356201  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6685481071472168  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2247743606567383  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.225149154663086  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6888165473937988  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.797770023345947  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.830000400543213  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6809854507446289  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2386250495910645  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.238999843597412  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7025146484375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.864081382751465  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.89631175994873  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6952457427978516  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2552242279052734  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.255599021911621  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7177386283874512  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.072010040283203  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.10424041748047  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7102823257446289  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2680144309997559  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2683892250061035  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7288331985473633  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.891119956970215  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.92335033416748  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7212796211242676  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.278775691986084  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2791504859924316  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7416839599609375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.02726459503174  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.059494972229004  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7350101470947266  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.294480323791504  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2948551177978516  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7571077346801758  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.01791286468506  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.050143241882324  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7502074241638184  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3072752952575684  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.307650089263916  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7686977386474609  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.95224618911743  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.984476566314697  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7609696388244629  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3179817199707031  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3183565139770508  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7810354232788086  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.953264713287354  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.98549509048462  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.774869441986084  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.334115982055664  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3344907760620117  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7980875968933105  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.091593265533447  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.124252796173096  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7911601066589355  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3499822616577148  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3503570556640625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8108563423156738  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.009601593017578  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.042118072509766  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8041448593139648  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3638453483581543  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.364220142364502  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8251609802246094  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.039226055145264  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.07145643234253  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8179640769958496  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3764019012451172  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3767766952514648  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8368420600891113  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.130449295043945  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.16267967224121  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.830324649810791  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3877239227294922  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3880987167358398  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8502960205078125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.051913261413574  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.08414363861084  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8443036079406738  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.401254653930664  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4016294479370117  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8638958930969238  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.9214768409729  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.953707218170166  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8576240539550781  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4119873046875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4123620986938477  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8769350051879883  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.929072380065918  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.96212673187256  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8692965507507324  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4244990348815918  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4248738288879395  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8902668952941895  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.129165172576904  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.16139554977417  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8835783004760742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4396958351135254  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.440070629119873  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9045476913452148  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.009750366210938  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.042339324951172  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8976764678955078  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4506421089172363  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.451016902923584  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9145784378051758  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.02085304260254  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.05336570739746  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.906740665435791  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4630146026611328  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4633893966674805  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9300789833068848  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.002938747406006  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.03516912460327  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9236788749694824  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.481224536895752  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4815993309020996  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9450383186340332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.189437866210938  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.221654891967773  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28057499
----------------------------------------after optimizer
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.969113826751709  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.369044303894043
pure train time :  11.81287431716919
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.15240478515625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029814720153808594
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16116881370544434
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6276016235351562  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.1868672370910645  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.187242031097412  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6492161750793457  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.707186222076416  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.726962566375732  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6326713562011719  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.1867423057556152  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.187117099761963  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.647432804107666  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.716599464416504  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.74882984161377  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6399755477905273  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.199632167816162  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2000069618225098  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6657900810241699  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.899065494537354  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.93129587173462  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6590938568115234  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2201848030090332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2205595970153809  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6805400848388672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.891721725463867  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.923952102661133  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6729331016540527  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2309284210205078  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2313032150268555  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6898360252380371  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.801637649536133  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.8338680267334  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6820340156555176  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2449064254760742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2452812194824219  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7072916030883789  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.108315467834473  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.14054584503174  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6995606422424316  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2581157684326172  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2584905624389648  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7161240577697754  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.986892223358154  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.01912260055542  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7084083557128906  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2642107009887695  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2645854949951172  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7266387939453125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.843690395355225  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.87592077255249  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7194523811340332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.280968189239502  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2813429832458496  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7453408241271973  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.11564350128174  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.147873878479004  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.738192081451416  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.292863368988037  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2932381629943848  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7512469291687012  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.80791473388672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.840145111083984  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7450122833251953  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.304185390472412  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3045601844787598  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7704544067382812  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.06944751739502  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.101677894592285  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7626457214355469  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3216700553894043  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.322044849395752  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7832088470458984  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.038635730743408  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.070866107940674  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7754225730895996  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3279657363891602  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3283405303955078  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7888870239257812  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.82601547241211  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.858245849609375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7810325622558594  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3338489532470703  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.334223747253418  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8013319969177246  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.956178665161133  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.9884090423584  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7942543029785156  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3522624969482422  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3526372909545898  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8196115493774414  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.101567268371582  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.133797645568848  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8117451667785645  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3697466850280762  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3701214790344238  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8317456245422363  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.92091178894043  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.953142166137695  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8253965377807617  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3844962120056152  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.384871006011963  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8466792106628418  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.212471961975098  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.245369911193848  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8402543067932129  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3954877853393555  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3958625793457031  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8564839363098145  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.091153144836426  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.12338352203369  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8498167991638184  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4067449569702148  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4071197509765625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.871528148651123  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.10269260406494  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.134922981262207  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8642992973327637  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4241652488708496  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4245400428771973  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8883137702941895  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.205893516540527  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.238123893737793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8818240165710449  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.438127040863037  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4385018348693848  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8982691764831543  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.025018215179443  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.05815362930298  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.8912715911865234  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4456548690795898  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4460296630859375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9093685150146484  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.042988300323486  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.075218677520752  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9023008346557617  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4581847190856934  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.458559513092041  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9238333702087402  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.168236255645752  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.200466632843018  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.916290283203125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4757118225097656  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.4760866165161133  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.939995288848877  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.19777250289917  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.229989528656006  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28064470
----------------------------------------after optimizer
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.9651308059692383  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2828497886657715
pure train time :  11.864874124526978
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.16058611869812012
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03530287742614746
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16947627067565918
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6303515434265137  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.1853203773498535  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.1856951713562012  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6458568572998047  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.7491192817688  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.76802158355713  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6281266212463379  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.183577060699463  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.1839518547058105  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6485323905944824  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.764827251434326  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.797057628631592  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6408500671386719  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.200322151184082  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2006969451904297  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6650390625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.87108087539673  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.903311252593994  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6577978134155273  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2163915634155273  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.216766357421875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.676915168762207  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.800926685333252  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.833157062530518  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6705503463745117  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.224647045135498  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2250218391418457  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.686042308807373  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.82346248626709  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.855692863464355  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.678734302520752  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2396903038024902  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.240065097808838  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7058768272399902  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.98510980606079  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.017340183258057  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.6982874870300293  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2550573348999023  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.25543212890625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.714881420135498  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.79134702682495  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.823577404022217  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7073307037353516  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.265455722808838  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2658305168151855  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7287631034851074  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.016204357147217  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.048434734344482  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7220196723937988  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2808036804199219  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2811784744262695  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7439117431640625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.007522583007812  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.039752960205078  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7367172241210938  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2964797019958496  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.2968544960021973  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7577762603759766  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.05171012878418  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.083940505981445  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7507643699645996  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3075342178344727  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3079090118408203  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7678451538085938  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.986623764038086  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 25.01885414123535  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7605314254760742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3155584335327148  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3159332275390625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7788023948669434  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.887311458587646  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 24.919541835784912  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7708611488342285  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.3347291946411133  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 1.335103988647461  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.42230224609375 GB
    Memory Allocated: 0.7999992370605469  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.36908721923828  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.401317596435547  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7925529479980469  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3530282974243164  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.353403091430664  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8091731071472168  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.9177188873291  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.949949264526367  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8016085624694824  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3589882850646973  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.359363079071045  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8187718391418457  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.976266860961914  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.00849723815918  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8116931915283203  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.367164134979248  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3675389289855957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8298153877258301  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.979767322540283  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.01199769973755  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8222651481628418  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3754825592041016  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3758573532104492  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8400130271911621  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.858822345733643  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.891052722930908  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8336062431335449  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.393784999847412  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3941597938537598  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8607449531555176  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.157408237457275  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.18963861465454  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8534932136535645  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4084372520446777  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4088120460510254  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8683772087097168  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.953192710876465  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.98542308807373  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8617300987243652  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4191269874572754  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.419501781463623  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.884213924407959  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.033681392669678  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.065911769866943  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8786072731018066  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4363350868225098  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4367098808288574  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8990254402160645  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.181692600250244  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.21392297744751  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8922915458679199  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.452427864074707  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4528026580810547  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9148907661437988  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.24114179611206  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.273372173309326  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9071674346923828  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4624390602111816  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4628138542175293  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9223594665527344  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.03474712371826  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.066977500915527  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.915797233581543  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.471519947052002  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4718947410583496  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9363279342651367  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.14841938018799  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.180636405944824  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28056212
----------------------------------------after optimizer
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9602274894714355  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.082277536392212
pure train time :  11.853332042694092
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.15894150733947754
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03247380256652832
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16786432266235352
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6256499290466309  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1803998947143555  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1807746887207031  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6446986198425293  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.799224853515625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.819129943847656  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6280174255371094  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1895051002502441  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1898798942565918  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.654902458190918  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.025254249572754  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.05748462677002  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6476120948791504  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2030882835388184  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.203463077545166  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.661567211151123  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.8389573097229  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.871187686920166  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6537685394287109  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2117547988891602  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2121295928955078  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6765532493591309  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.979042053222656  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.011272430419922  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6689047813415527  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.225715160369873  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2260899543762207  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6877999305725098  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.821707248687744  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.85393762588501  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6806974411010742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.238546371459961  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2389211654663086  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7025127410888672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.8859543800354  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.918184757232666  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6956033706665039  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.254800796508789  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2551755905151367  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7178487777709961  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.00068759918213  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.032917976379395  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7105913162231445  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.272630214691162  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2730050086975098  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7335906028747559  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.1121244430542  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.144354820251465  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7270212173461914  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2838315963745117  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2842063903808594  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7419695854187012  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.931914806365967  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.964145183563232  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7350282669067383  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2875981330871582  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2879729270935059  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7507376670837402  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.80824327468872  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.840473651885986  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7436304092407227  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3002686500549316  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3006434440612793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7677884101867676  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.95656681060791  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.988797187805176  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7601237297058105  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3189210891723633  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.319295883178711  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7832136154174805  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.05726432800293  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.089494705200195  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7758173942565918  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3307747840881348  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3311495780944824  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7930488586425781  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.972844123840332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.005074501037598  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.785923957824707  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3465442657470703  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.346919059753418  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8117175102233887  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.123756408691406  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.155986785888672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8041353225708008  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3635830879211426  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3639578819274902  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.823939323425293  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.092865467071533  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.1250958442688  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8165054321289062  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3754658699035645  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.375840663909912  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8360824584960938  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.008680820465088  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.040911197662354  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8291316032409668  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3840522766113281  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3844270706176758  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8450899124145508  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.89093255996704  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.923162937164307  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8386144638061523  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3964877128601074  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.396862506866455  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.861565113067627  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.97192621231079  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.004156589508057  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8542318344116211  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4091525077819824  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.40952730178833  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8712906837463379  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.978766918182373  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.01099729537964  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8640651702880859  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4192304611206055  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4196052551269531  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8843097686767578  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.956387042999268  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.988617420196533  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8770103454589844  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4322595596313477  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4326343536376953  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8970980644226074  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.060847759246826  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.093078136444092  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8893599510192871  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4497184753417969  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4500932693481445  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9145770072937012  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.159639358520508  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.191869735717773  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9083209037780762  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4677081108093262  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4680829048156738  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9274554252624512  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.157251834869385  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.18948221206665  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9201340675354004  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.47514009475708  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4755148887634277  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.935856819152832  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.164062976837158  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.196293354034424  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28051758
----------------------------------------after optimizer
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.962374210357666  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.955174684524536
pure train time :  11.815271615982056
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.15209126472473145
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030835628509521484
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16090631484985352
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6274967193603516  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1871094703674316  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1874842643737793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6521849632263184  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.84673261642456  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.864074230194092  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6330089569091797  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1898488998413086  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1902236938476562  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6502184867858887  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.787246227264404  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.81947660446167  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6424083709716797  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2011966705322266  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2015714645385742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6643543243408203  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.880588054656982  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.912818431854248  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.65692138671875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2107701301574707  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2111449241638184  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6719570159912109  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.8242506980896  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.856481075286865  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6644668579101562  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2254600524902344  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.225834846496582  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6917786598205566  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.054662704467773  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.08689308166504  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6844949722290039  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.242114543914795  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2424893379211426  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7011828422546387  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.839974880218506  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.87220525741577  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6937923431396484  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2561655044555664  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.256540298461914  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7194719314575195  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.066219806671143  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.098450183868408  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7119235992431641  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.268010139465332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2683849334716797  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7257900238037109  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.95101261138916  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.983242988586426  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7190704345703125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2784819602966309  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2788567543029785  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7434415817260742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.05289888381958  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.085129261016846  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7378172874450684  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2954998016357422  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2958745956420898  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7561545372009277  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.924996376037598  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.957226753234863  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7476744651794434  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3116111755371094  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.311985969543457  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7741312980651855  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.18888807296753  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.221118450164795  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7666277885437012  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3243556022644043  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.324730396270752  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7814326286315918  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.002894401550293  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.03512477874756  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7754888534545898  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3298697471618652  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.330244541168213  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7920718193054199  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.789002895355225  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.82123327255249  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7851176261901855  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.341644287109375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3420190811157227  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8082842826843262  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.011878967285156  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.044109344482422  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8004722595214844  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3576469421386719  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3580217361450195  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8212714195251465  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.047164916992188  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.079395294189453  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8146953582763672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3723268508911133  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.372701644897461  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8352947235107422  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.045446395874023  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.07767677307129  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8273797035217285  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3884406089782715  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3888154029846191  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8517518043518066  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.063469409942627  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.095699787139893  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8438100814819336  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.397812843322754  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3981876373291016  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8568134307861328  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.002747535705566  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.034977912902832  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8490390777587891  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4028878211975098  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4032626152038574  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8696832656860352  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.92264175415039  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.954872131347656  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8637499809265137  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4161357879638672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4165105819702148  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8830857276916504  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.954225540161133  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.9864559173584  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8763322830200195  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4330029487609863  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.433377742767334  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9006929397583008  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.125622749328613  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.15785312652588  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8931159973144531  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4469647407531738  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4473395347595215  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9103593826293945  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.07929754257202  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.111527919769287  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9025592803955078  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4585676193237305  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4589424133300781  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9247794151306152  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.00758171081543  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.039812088012695  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9174642562866211  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4775848388671875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4779596328735352  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9417181015014648  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.15660047531128  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.188830852508545  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28054647
----------------------------------------after optimizer
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9669160842895508  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8599164485931396
pure train time :  11.834157943725586
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.1645369529724121
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03873729705810547
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.17549443244934082
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6308746337890625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1894683837890625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1898431777954102  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6496648788452148  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.913723945617676  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.932802200317383  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6324963569641113  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1908526420593262  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1912274360656738  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6523699760437012  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.00813102722168  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.040361404418945  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6458172798156738  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2060189247131348  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2063937187194824  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6677231788635254  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.886529445648193  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.91875982284546  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6595931053161621  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2182021141052246  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2185769081115723  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.678067684173584  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.924053192138672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.956283569335938  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6710309982299805  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.230656623840332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2310314178466797  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6921043395996094  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.8016095161438  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.833839893341064  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.684354305267334  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2408390045166016  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2412137985229492  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7016587257385254  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.907283782958984  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.93951416015625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6948432922363281  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2519168853759766  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2522916793823242  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7163677215576172  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.84210777282715  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.874338150024414  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7098050117492676  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2676234245300293  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.267998218536377  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7307391166687012  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.999136924743652  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.031367301940918  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7246956825256348  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.286257266998291  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2866320610046387  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.748572826385498  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.095938205718994  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.12816858291626  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7413673400878906  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3006072044372559  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3009819984436035  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7593283653259277  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.010818004608154  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.04304838180542  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7520241737365723  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3085474967956543  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.308922290802002  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7693362236022949  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.91655969619751  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.948790073394775  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7614855766296387  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3179702758789062  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.318345069885254  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7821073532104492  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.95475721359253  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.986987590789795  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7759342193603516  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.33095121383667  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3313260078430176  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7944865226745605  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.80335760116577  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.835587978363037  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7865080833435059  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3400769233703613  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.340451717376709  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.805964469909668  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.9289231300354  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.961153507232666  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7988357543945312  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3554158210754395  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.355790615081787  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8218774795532227  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.97351360321045  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.005743980407715  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8156280517578125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3714256286621094  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.371800422668457  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8356971740722656  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.07549238204956  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.107722759246826  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.82904052734375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3863263130187988  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3867011070251465  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8505735397338867  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.066625595092773  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.09885597229004  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8439297676086426  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4040589332580566  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4044337272644043  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8676886558532715  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.08659553527832  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.118825912475586  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8603291511535645  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4215826988220215  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4219574928283691  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8815665245056152  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.192573070526123  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.22480344772339  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8752017021179199  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4303998947143555  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4307746887207031  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8892006874084473  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.05681610107422  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.089046478271484  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8821663856506348  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4379253387451172  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4383001327514648  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9027948379516602  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.14359760284424  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.175827980041504  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8950347900390625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4494190216064453  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.449793815612793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9137163162231445  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.06711483001709  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.099345207214355  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9076151847839355  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4629278182983398  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4633026123046875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9285979270935059  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.112091541290283  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.14432191848755  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9208526611328125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.478151798248291  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4785265922546387  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.942899227142334  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.128859043121338  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.161089420318604  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28054134
----------------------------------------after optimizer
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9675917625427246  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.745917558670044
pure train time :  11.794174194335938
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.16544270515441895
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03922581672668457
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.17641663551330566
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.627650260925293  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1875877380371094  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.187962532043457  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6503758430480957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.957818508148193  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.977299690246582  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6330223083496094  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1935687065124512  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1939435005187988  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6538548469543457  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.98716163635254  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.019392013549805  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6474933624267578  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.207000732421875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2073755264282227  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6666569709777832  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.950308322906494  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.98253870010376  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6587333679199219  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2178077697753906  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2181825637817383  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6783947944641113  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.896496295928955  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.92872667312622  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6712985038757324  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2300152778625488  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2303900718688965  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6910381317138672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.968678951263428  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.000909328460693  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6832633018493652  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2394447326660156  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2398195266723633  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7015013694763184  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.88708257675171  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.919312953948975  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6945977210998535  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2509379386901855  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2513127326965332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7157301902770996  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.89164638519287  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.923876762390137  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7083725929260254  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2665810585021973  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.266955852508545  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7302961349487305  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.77422332763672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.806453704833984  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7224078178405762  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2800278663635254  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.280402660369873  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7428231239318848  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.99952268600464  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.031753063201904  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7363505363464355  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2939295768737793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.294304370880127  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7564077377319336  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.03408145904541  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.066311836242676  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7493081092834473  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3054895401000977  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3058643341064453  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7679963111877441  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.901805877685547  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.934036254882812  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7610554695129395  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3174982070922852  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3178730010986328  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7814083099365234  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.95158576965332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.983816146850586  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7741098403930664  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3285603523254395  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.328935146331787  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.792177677154541  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.79977035522461  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.832000732421875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7845005989074707  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3418292999267578  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3422040939331055  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8074741363525391  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.02124834060669  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.053478717803955  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8017978668212891  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.364943027496338  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3653178215026855  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8277626037597656  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.180163383483887  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.212393760681152  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8198437690734863  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3835334777832031  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3839082717895508  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8406867980957031  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.171006679534912  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.203237056732178  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8336238861083984  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3875961303710938  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3879709243774414  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8444666862487793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.8974609375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.929691314697266  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8374519348144531  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3901610374450684  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.390535831451416  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8562908172607422  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.08733081817627  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.119561195373535  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8490591049194336  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.404409408569336  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4047842025756836  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8717260360717773  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.996750354766846  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.02898073196411  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8640761375427246  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4214105606079102  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4217853546142578  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8860945701599121  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.061255931854248  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.093486309051514  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8812556266784668  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4391732215881348  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4395480155944824  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9018731117248535  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.080162525177002  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.112392902374268  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8960795402526855  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4551901817321777  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4555649757385254  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9173941612243652  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.228901863098145  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.26113224029541  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9098238945007324  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4661626815795898  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4665374755859375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9270739555358887  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.06590509414673  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.098135471343994  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9208736419677734  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4748458862304688  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4752206802368164  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.93853759765625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.108616828918457  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.140833854675293  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28062037
----------------------------------------after optimizer
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9629154205322266  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.676933526992798
pure train time :  12.38325834274292
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.15368103981018066
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03470158576965332
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16452646255493164
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6242489814758301  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1787352561950684  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.179110050201416  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6446881294250488  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.720390796661377  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.739946365356445  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6274847984313965  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1824512481689453  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.182826042175293  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6483054161071777  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.787569999694824  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.81980037689209  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6403598785400391  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.194089412689209  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1944642066955566  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6594333648681641  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.797109603881836  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.8293399810791  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6514596939086914  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2060279846191406  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2064027786254883  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6731915473937988  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.805562496185303  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.83779287338257  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6652326583862305  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.223701000213623  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2240757942199707  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6897439956665039  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.916850090026855  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.94908046722412  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6818771362304688  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2397208213806152  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.240095615386963  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7016201019287109  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.913676261901855  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.94590663909912  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.693427562713623  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2489533424377441  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2493281364440918  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7114553451538086  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.848483562469482  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.880713939666748  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7036857604980469  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2597379684448242  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2601127624511719  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7253909111022949  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.948771476745605  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.98100185394287  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7177839279174805  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2776150703430176  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2779898643493652  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7419085502624512  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.898693084716797  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.931249141693115  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.733701229095459  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.292745590209961  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2931203842163086  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7540717124938965  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.961979389190674  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.99420976638794  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.746795654296875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3023710250854492  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3027458190917969  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7632870674133301  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.7921781539917  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.824408531188965  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.756434440612793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3139123916625977  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3142871856689453  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7790336608886719  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.0350980758667  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.067328453063965  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7718591690063477  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3307714462280273  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.331146240234375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.794548511505127  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.06105089187622  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.093281269073486  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7864232063293457  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3441753387451172  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3445501327514648  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8056888580322266  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.181291580200195  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.21352195739746  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.799339771270752  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3568387031555176  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3572134971618652  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8190884590148926  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.990697860717773  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.02292823791504  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8124685287475586  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.370584487915039  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3709592819213867  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8334708213806152  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.09616756439209  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.128397941589355  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8263001441955566  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3847436904907227  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3851184844970703  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8479042053222656  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.159812927246094  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.19204330444336  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8406705856323242  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3967061042785645  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.397080898284912  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.858248233795166  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.8857741355896  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.918957233428955  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8510236740112305  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4104485511779785  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4108233451843262  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8747916221618652  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.156493186950684  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.18872356414795  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8672266006469727  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4253692626953125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4257440567016602  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8868551254272461  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.21596670150757  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.248265266418457  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8790736198425293  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4395060539245605  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4398808479309082  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9017825126647949  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.212307929992676  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.24453830718994  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.894381046295166  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4528021812438965  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4531769752502441  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9127230644226074  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.115667819976807  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.147898197174072  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9052596092224121  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4601573944091797  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4605321884155273  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9217138290405273  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.958801746368408  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.991032123565674  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9147682189941406  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4762849807739258  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4766597747802734  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9414153099060059  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.176745891571045  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.20897626876831  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28053945
----------------------------------------after optimizer
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9654150009155273  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6033692359924316
pure train time :  11.82862663269043
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.15144562721252441
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03247356414794922
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16229534149169922
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6314997673034668  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1900935173034668  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1904683113098145  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6486668586730957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.96633529663086  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.98618459701538  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6327095031738281  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1879043579101562  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.188279151916504  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6493873596191406  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.899752616882324  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.93198299407959  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6412014961242676  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1962833404541016  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1966581344604492  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6612133979797363  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.80267572402954  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.834906101226807  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6537885665893555  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2126102447509766  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2129850387573242  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6775965690612793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.891438484191895  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.92366886138916  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6703753471374512  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2254571914672852  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2258319854736328  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6874122619628906  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.771271228790283  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.80350160598755  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6804995536804199  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2394399642944336  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2398147583007812  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7046403884887695  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.012659549713135  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.0448899269104  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.697758674621582  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2547078132629395  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.255082607269287  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7157669067382812  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.82086753845215  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.853097915649414  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7073955535888672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.268376350402832  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2687511444091797  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7315983772277832  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.114052295684814  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.14628267288208  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7242984771728516  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2795586585998535  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2799334526062012  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7385754585266113  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.782143592834473  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.81437397003174  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7311172485351562  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2819061279296875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2822809219360352  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7466540336608887  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.775087356567383  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.80731773376465  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7404365539550781  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2995028495788574  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.299877643585205  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7696328163146973  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.009244441986084  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.04147481918335  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7620582580566406  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3202152252197266  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3205900192260742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7812328338623047  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.01141595840454  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.043646335601807  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7737579345703125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3291826248168945  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3295574188232422  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7911038398742676  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.944076538085938  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.976306915283203  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.783268928527832  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3362531661987305  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3366279602050781  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8008666038513184  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.800273418426514  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.83250379562378  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7940716743469238  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3561806678771973  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.356555461883545  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8233551979064941  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.18816041946411  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.220390796661377  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8162307739257812  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3761982917785645  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.376573085784912  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8342151641845703  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.129310131072998  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.161540508270264  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8263230323791504  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.384664535522461  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3850393295288086  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8448152542114258  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.10989236831665  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.142122745513916  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8375444412231445  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3957371711730957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3961119651794434  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8574919700622559  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.024020671844482  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.056251049041748  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8496837615966797  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4070124626159668  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4073872566223145  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.869328498840332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.081090927124023  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.11332130432129  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8614482879638672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4233789443969727  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4237537384033203  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8861608505249023  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.08397674560547  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.116207122802734  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8784475326538086  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.43707275390625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4374475479125977  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8952527046203613  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.125030517578125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.15726089477539  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8889355659484863  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.445788860321045  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4461636543273926  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9072809219360352  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.09636402130127  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.128594398498535  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8997511863708496  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4580554962158203  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.458430290222168  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9212918281555176  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.051551342010498  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.083781719207764  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.914848804473877  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4741477966308594  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.474522590637207  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9368820190429688  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.210875511169434  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.243460178375244  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28062366
----------------------------------------after optimizer
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9614405632019043  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.542375326156616
pure train time :  11.809665441513062
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.15520286560058594
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03292059898376465
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16611504554748535
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.631101131439209  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1856584548950195  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1860332489013672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6467127799987793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.848063945770264  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.86609411239624  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6287569999694824  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1807994842529297  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1811742782592773  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6460690498352051  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.626444339752197  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.658674716949463  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.638486385345459  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1952662467956543  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.195641040802002  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.663233757019043  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.7462477684021  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.778478145599365  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6560101509094238  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.211522102355957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2118968963623047  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6747159957885742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.807949542999268  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.840179920196533  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6677231788635254  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2265443801879883  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.226919174194336  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6910653114318848  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.96318006515503  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.995410442352295  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6835908889770508  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.245316505432129  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2456912994384766  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.706636905670166  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.052770614624023  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.08500099182129  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6993470191955566  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2548589706420898  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2552337646484375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7132039070129395  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.77948236465454  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.811712741851807  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7055087089538574  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2638015747070312  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.264176368713379  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.728421688079834  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.072564601898193  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.10479497909546  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.720911979675293  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2787137031555176  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2790884971618652  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7405033111572266  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.981204509735107  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.013434886932373  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7332558631896973  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.290452480316162  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2908272743225098  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7527313232421875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.975297451019287  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.007527828216553  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7452564239501953  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3043098449707031  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3046846389770508  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7672152519226074  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.057600021362305  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.08983039855957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7595229148864746  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3216681480407715  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3220429420471191  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7826848030090332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.015247344970703  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.04747772216797  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7750177383422852  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3360381126403809  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3364129066467285  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7939977645874023  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.08232307434082  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.114553451538086  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7864961624145508  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3478593826293945  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3482341766357422  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8074150085449219  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.08886432647705  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.121094703674316  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7998747825622559  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.353867530822754  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3542423248291016  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8125648498535156  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.9121150970459  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.944345474243164  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8065061569213867  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.367199420928955  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3675742149353027  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8333425521850586  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.16679048538208  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.199020862579346  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8259792327880859  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.381589412689209  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3819642066955566  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8409571647644043  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.04412603378296  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.076356410980225  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8335533142089844  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3902010917663574  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.390575885772705  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8545980453491211  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.932028770446777  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.964259147644043  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8477778434753418  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4044179916381836  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4047927856445312  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.867800235748291  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.905856132507324  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.93808650970459  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8620553016662598  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.417567253112793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4179420471191406  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8809285163879395  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.934518814086914  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.96754264831543  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8736882209777832  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4300289154052734  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.430403709411621  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8945884704589844  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.11301326751709  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.145243644714355  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8883256912231445  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4484405517578125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4488153457641602  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9122419357299805  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.26598358154297  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.298404693603516  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9049644470214844  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4624567031860352  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4628314971923828  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.923126220703125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.105896949768066  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.138127326965332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.915651798248291  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4745855331420898  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4749603271484375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9372334480285645  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.27253293991089  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.304763317108154  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28065331
----------------------------------------after optimizer
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9630565643310547  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.473360538482666
pure train time :  11.82305383682251
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.15778803825378418
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.036916494369506836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1686561107635498
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6306633949279785  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1892571449279785  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1896319389343262  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6505031585693359  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.94331407546997  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.961498737335205  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6316146850585938  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1870617866516113  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.187436580657959  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6485676765441895  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.69764232635498  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.729872703552246  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6419715881347656  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1981759071350098  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1985507011413574  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6640543937683105  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.6881365776062  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.720366954803467  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6564393043518066  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.214827537536621  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2152023315429688  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6786198616027832  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.88678503036499  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.919015407562256  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6722993850708008  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2252445220947266  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2256193161010742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6868605613708496  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.849575996398926  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.88180637359619  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6798520088195801  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2352914810180664  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.235666275024414  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7031831741333008  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.82462215423584  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.856852531433105  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.695767879486084  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2545862197875977  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2549610137939453  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7193498611450195  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.960826873779297  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.993057250976562  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7127399444580078  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2698206901550293  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.270195484161377  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7310428619384766  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.002623558044434  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.0348539352417  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7241997718811035  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2796006202697754  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.279975414276123  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7425384521484375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.981124877929688  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.013355255126953  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7353606224060059  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2939410209655762  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2943158149719238  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7586522102355957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.085834503173828  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.118064880371094  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7520112991333008  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3121447563171387  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3125195503234863  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7739787101745605  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.030255794525146  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.062486171722412  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7686958312988281  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3282842636108398  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3286590576171875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7890920639038086  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.083999156951904  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.11622953414917  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7814421653747559  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.33732271194458  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3376975059509277  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7977242469787598  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.916975021362305  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.94920539855957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7903227806091309  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.346085548400879  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3464603424072266  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8101949691772461  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.96408462524414  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.996315002441406  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8030200004577637  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3606352806091309  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3610100746154785  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8248758316040039  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.027867317199707  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.060097694396973  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8174147605895996  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3758559226989746  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3762307167053223  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.838346004486084  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.100621700286865  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.13285207748413  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8308100700378418  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.39495849609375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3953332901000977  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8577208518981934  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.33830690383911  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.370537281036377  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.851600170135498  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4095945358276367  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4099693298339844  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8654437065124512  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.0211238861084  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.054133415222168  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8570003509521484  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4149971008300781  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4153718948364258  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8770232200622559  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.080195903778076  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.112426280975342  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8697729110717773  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4228010177612305  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4231758117675781  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.884791374206543  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.9422869682312  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.974517345428467  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.877408504486084  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4373507499694824  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.43772554397583  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.904416561126709  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.18675136566162  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.218981742858887  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8984861373901367  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.453129768371582  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4535045623779297  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9132122993469238  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.986122608184814  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.01835298538208  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9069881439208984  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4643397331237793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.464714527130127  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9297957420349121  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.205744743347168  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.237975120544434  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9246153831481934  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4827752113342285  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4831500053405762  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9454421997070312  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.09293794631958  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.125168323516846  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28053630
----------------------------------------after optimizer
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.969757080078125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4301905632019043
pure train time :  11.829236507415771
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.16174626350402832
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.036740779876708984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1724717617034912
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6282258033752441  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1830697059631348  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1834444999694824  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6448969841003418  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.82623529434204  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.846001625061035  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6278562545776367  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.184985637664795  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1853604316711426  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6505727767944336  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.674485683441162  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.706716060638428  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6444087028503418  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2010769844055176  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2014517784118652  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6639537811279297  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.895972728729248  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.928203105926514  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.657020092010498  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2148418426513672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2152166366577148  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6782827377319336  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.998547077178955  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.03077745437622  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6704397201538086  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2293171882629395  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.229691982269287  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6915383338928223  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.89638376235962  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.928614139556885  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6836848258972168  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.243424415588379  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2437992095947266  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.704688549041748  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.042418956756592  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.074649333953857  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6970548629760742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.255516529083252  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2558913230895996  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7168259620666504  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.027757167816162  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.059987545013428  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7092905044555664  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.266219139099121  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2665939331054688  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7285943031311035  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.912241458892822  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.944471836090088  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.721522331237793  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2786002159118652  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.278975009918213  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7417855262756348  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.956046104431152  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.988276481628418  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7343921661376953  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2858738899230957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2862486839294434  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7487263679504395  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.688514232635498  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.720744609832764  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7410492897033691  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2989983558654785  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2993731498718262  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7685484886169434  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.02428150177002  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.056511878967285  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7608838081359863  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3211784362792969  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3215532302856445  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7841272354125977  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.97972869873047  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.011959075927734  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7764859199523926  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3358006477355957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3361754417419434  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7956199645996094  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.988473892211914  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.02070426940918  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7888455390930176  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3510069847106934  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.351381778717041  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8118062019348145  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.0647292137146  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.096959590911865  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8042960166931152  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3611030578613281  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3614778518676758  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8197016716003418  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.98956537246704  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.021795749664307  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8121438026428223  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3678245544433594  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.368199348449707  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.830998420715332  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.969961643218994  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.00219202041626  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8239603042602539  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3801484107971191  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3805232048034668  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8444643020629883  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.059587001800537  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.091817378997803  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8382530212402344  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3957724571228027  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3961472511291504  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8597116470336914  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.16498613357544  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.197216510772705  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8527088165283203  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4097161293029785  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4100909233093262  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8721818923950195  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.017308712005615  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.04953908920288  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.865668773651123  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4213228225708008  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4216976165771484  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8844380378723145  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.150625705718994  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.18285608291626  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8782281875610352  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4369850158691406  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4373598098754883  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9014754295349121  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.227077960968018  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.259308338165283  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8939056396484375  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4494075775146484  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.449782371520996  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9109740257263184  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.976996421813965  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.00922679901123  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9030551910400391  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.461205005645752  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4615797996520996  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9259123802185059  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.146262168884277  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.178492546081543  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9186758995056152  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4776010513305664  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.477975845336914  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9395747184753418  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.153812885284424  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.18604326248169  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28057672
----------------------------------------after optimizer
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9648771286010742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3776893615722656
pure train time :  11.81621789932251
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
range partition time  0.1532578468322754
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0348353385925293
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1640791893005371
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6301627159118652  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.191185474395752  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1915602684020996  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6524991989135742  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.03307056427002  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.05166530609131  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6341867446899414  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.1912026405334473  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.191577434539795  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6509246826171875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.854905605316162  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.887135982513428  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6434521675109863  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.203315258026123  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2036900520324707  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6663923263549805  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.955854892730713  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.98808526992798  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6592564582824707  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2205171585083008  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2208919525146484  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6808395385742188  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.11608648300171  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.148316860198975  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6736087799072266  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.225555419921875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2259302139282227  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6843070983886719  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.781099319458008  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.813329696655273  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.6767888069152832  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2327156066894531  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2330904006958008  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7007765769958496  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.794549465179443  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.82677984237671  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.692842960357666  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2505478858947754  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.250922679901123  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7146711349487305  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.903130531311035  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.9353609085083  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7071852684020996  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2621326446533203  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.262507438659668  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.724761962890625  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.76993179321289  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.802162170410156  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7174315452575684  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2766385078430176  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2770133018493652  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7417874336242676  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.040220260620117  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.072450637817383  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7342758178710938  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2907695770263672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.2911443710327148  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.751640796661377  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.903563499450684  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.93579387664795  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.745274543762207  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3013930320739746  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3017678260803223  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7649736404418945  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.91185235977173  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.944082736968994  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7572717666625977  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3177452087402344  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.318120002746582  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7817316055297852  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.063992977142334  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.0962233543396  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7738256454467773  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3313064575195312  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.331681251525879  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7908968925476074  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.860243797302246  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.89247417449951  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7832422256469727  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3394885063171387  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3398633003234863  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8020896911621094  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.915621757507324  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.94785213470459  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.7959084510803223  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.350855827331543  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3512306213378906  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8146953582763672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.982823371887207  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.015053749084473  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8083763122558594  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.365969181060791  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3663439750671387  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8311367034912109  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.11355686187744  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.145787239074707  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8235435485839844  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3858208656311035  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3861956596374512  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8484678268432617  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.16759204864502  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.199822425842285  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8418984413146973  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3996162414550781  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.3999910354614258  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8577685356140137  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.065841674804688  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.098072052001953  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8499221801757812  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.409654140472412  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4100289344787598  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8721904754638672  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.221667289733887  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.253897666931152  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8661913871765137  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4233102798461914  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.423685073852539  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8836846351623535  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.06004762649536  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.092278003692627  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8775434494018555  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.433135986328125  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4335107803344727  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8961405754089355  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.091259956359863  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.12349033355713  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.8906593322753906  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4456067085266113  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.445981502532959  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9101471900939941  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.149128913879395  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.18135929107666  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.902491569519043  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.464451789855957  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4648265838623047  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9298772811889648  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.21554660797119  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 25.247776985168457  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9236001968383789  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4741520881652832  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 1.4745268821716309  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9322619438171387  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.87179183959961  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 24.904022216796875  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

number of input  28053943
----------------------------------------after optimizer
 Nvidia-smi: 44.49847412109375 GB
    Memory Allocated: 0.9573101997375488  GigaBytes
Max Memory Allocated: 26.0470929145813  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3477437496185303
pure train time :  11.807311296463013
epoch_time_list  [49.66297721862793, 50.81548619270325, 51.72315716743469, 53.24655318260193, 50.79007411003113, 53.82917237281799, 49.098548412323, 48.567511796951294, 50.34821677207947, 49.06182813644409, 48.67416214942932, 48.85818004608154, 49.92666053771973, 50.0280499458313, 49.04209899902344, 48.11153483390808, 48.71268606185913, 48.89816689491272, 48.24741792678833, 48.01764154434204]

loading_time list   [0.8590395450592041, 0.8850071430206299, 0.8172516822814941, 1.0728726387023926, 0.7204947471618652, 0.8676009178161621, 0.6806321144104004, 0.6691250801086426, 0.6215627193450928, 0.80950927734375, 0.694911003112793, 0.7596187591552734, 0.7818403244018555, 0.8996050357818604, 0.9275519847869873, 0.7142746448516846, 0.7320661544799805, 0.643200159072876, 0.8026509284973145, 0.7330756187438965]

 data loader gen time  31.02809500694275
	---backpack schedule time  [0.33467960357666016, 0.3313174247741699, 0.3290243148803711, 0.5038926601409912, 0.3144106864929199, 0.3560304641723633, 0.31949496269226074, 0.30878567695617676, 0.3169233798980713, 0.3269083499908447, 0.3267326354980469, 0.31473326683044434, 0.35168004035949707, 0.34313344955444336, 0.32288217544555664, 0.31840038299560547, 0.3249475955963135, 0.33916568756103516, 0.3330674171447754, 0.32854485511779785]
	---connection_check_time_list  [5.915727853775024, 5.785614490509033, 7.423080205917358, 7.687365531921387, 6.043246030807495, 9.973770141601562, 5.449521064758301, 5.350233554840088, 7.133277177810669, 5.348883628845215, 5.267395496368408, 5.619693279266357, 6.868143558502197, 5.445391416549683, 5.77044677734375, 5.319277763366699, 6.233800411224365, 6.2621166706085205, 5.357512474060059, 5.292240381240845]
	---block_gen_time_list  [3.495769739151001, 3.544752836227417, 2.9532392024993896, 3.029920816421509, 2.950594663619995, 2.879575490951538, 2.918299913406372, 2.7445006370544434, 2.7441933155059814, 2.841698408126831, 2.7498326301574707, 2.8755533695220947, 3.0080695152282715, 3.0027737617492676, 2.756570339202881, 2.7385003566741943, 2.66367244720459, 2.779675245285034, 2.8552095890045166, 2.7153327465057373]
training time  [16.041600704193115, 17.364628791809082, 16.90246081352234, 17.080782890319824, 17.738041877746582, 16.581271648406982, 16.754465103149414, 16.531880855560303, 16.546703577041626, 16.78063178062439, 16.70193362236023, 16.398842096328735, 15.990343809127808, 17.452518463134766, 16.355942487716675, 16.181952714920044, 16.051198482513428, 16.148338079452515, 16.211793661117554, 16.21701192855835]
---feature block loading time  [4.4272377490997314, 5.938368320465088, 5.098791599273682, 5.196421146392822, 5.121295213699341, 4.711897373199463, 4.892503261566162, 4.685453414916992, 4.650386095046997, 4.892325162887573, 4.855165481567383, 4.531510829925537, 4.162463903427124, 5.033647060394287, 4.494019985198975, 4.339828252792358, 4.194955110549927, 4.287566661834717, 4.362117528915405, 4.377563953399658]


epoch_time avg   49.38824690878391
loading_time avg   0.7536074668169022
 data loader gen time avg 32.05535800755024
	---backpack schedule time avg 0.3278650641441345
	---connection_check_time avg  6.045934364199638
	---block_gen_time avg  2.826503276824951
training time  16.540179386734962
---feature block loading time  4.599543705582619
pure train time per /epoch  [11.584654569625854, 11.392231225967407, 11.771531820297241, 11.851295948028564, 12.569901943206787, 11.836012601852417, 11.830702543258667, 11.81287431716919, 11.864874124526978, 11.853332042694092, 11.815271615982056, 11.834157943725586, 11.794174194335938, 12.38325834274292, 11.82862663269043, 11.809665441513062, 11.82305383682251, 11.829236507415771, 11.81621789932251, 11.807311296463013]
pure train time average  11.903527484220618
num_input list  [28053280, 28055447, 28053627, 28054061, 28051890, 28061073, 28063021, 28057499, 28064470, 28056212, 28051758, 28054647, 28054134, 28062037, 28053945, 28062366, 28065331, 28053630, 28057672, 28053943]
num_input  average  28057002.15
