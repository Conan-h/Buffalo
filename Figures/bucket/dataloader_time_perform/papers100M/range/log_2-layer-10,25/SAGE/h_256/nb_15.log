main start at this time 1714077181.9673755
-----------------------------------------before load data 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
# Nodes: 111059956
# Edges: 1615685872
# Train: 1207179
# Val: 125265
# Test: 109727512
# Classes: 172

----------------------------------------start of run function 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.1504976749420166
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0364375114440918
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1595323085784912
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 1.22113037109375 GB
    Memory Allocated: 0.003025054931640625  GigaBytes
Max Memory Allocated: 0.003025054931640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.95355224609375 GB
    Memory Allocated: 0.7354469299316406  GigaBytes
Max Memory Allocated: 0.7354469299316406  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.95355224609375 GB
    Memory Allocated: 0.7360467910766602  GigaBytes
Max Memory Allocated: 0.7360467910766602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.00042724609375 GB
    Memory Allocated: 0.7653226852416992  GigaBytes
Max Memory Allocated: 0.7653226852416992  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.20941162109375 GB
    Memory Allocated: 36.659504413604736  GigaBytes
Max Memory Allocated: 37.646353244781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.20941162109375 GB
    Memory Allocated: 36.71107244491577  GigaBytes
Max Memory Allocated: 37.646353244781494  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 39.92620849609375 GB
    Memory Allocated: 0.8266010284423828  GigaBytes
Max Memory Allocated: 37.646353244781494  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.92620849609375 GB
    Memory Allocated: 1.5584416389465332  GigaBytes
Max Memory Allocated: 37.646353244781494  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.92620849609375 GB
    Memory Allocated: 1.5590415000915527  GigaBytes
Max Memory Allocated: 37.646353244781494  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.92620849609375 GB
    Memory Allocated: 0.8553347587585449  GigaBytes
Max Memory Allocated: 37.646353244781494  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 52.57464599609375 GB
    Memory Allocated: 36.754393100738525  GigaBytes
Max Memory Allocated: 37.79027605056763  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 52.57464599609375 GB
    Memory Allocated: 36.8059606552124  GigaBytes
Max Memory Allocated: 37.79027605056763  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 52.57464599609375 GB
    Memory Allocated: 0.8456215858459473  GigaBytes
Max Memory Allocated: 37.79027605056763  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 52.57464599609375 GB
    Memory Allocated: 1.579118251800537  GigaBytes
Max Memory Allocated: 37.79027605056763  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 52.57464599609375 GB
    Memory Allocated: 1.5797181129455566  GigaBytes
Max Memory Allocated: 37.79027605056763  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 52.57464599609375 GB
    Memory Allocated: 0.8766984939575195  GigaBytes
Max Memory Allocated: 37.79027605056763  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 36.77457284927368  GigaBytes
Max Memory Allocated: 37.80855083465576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 36.82614040374756  GigaBytes
Max Memory Allocated: 37.80855083465576  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 0.8674802780151367  GigaBytes
Max Memory Allocated: 37.80855083465576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 1.6011104583740234  GigaBytes
Max Memory Allocated: 37.80855083465576  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 1.601710319519043  GigaBytes
Max Memory Allocated: 37.80855083465576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 0.8970832824707031  GigaBytes
Max Memory Allocated: 37.80855083465576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 36.856478691101074  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 36.90804624557495  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 0.8881168365478516  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 1.6192278861999512  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 1.6198277473449707  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 0.9155778884887695  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 36.625160694122314  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 36.67672824859619  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 0.9050846099853516  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 1.6377902030944824  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 1.638390064239502  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 0.936983585357666  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 36.84071445465088  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 36.89243459701538  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 0.9260997772216797  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 1.6611948013305664  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 1.661794662475586  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 0.9587240219116211  GigaBytes
Max Memory Allocated: 37.89771556854248  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 36.942025661468506  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 36.99359321594238  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 0.9488139152526855  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 1.6754918098449707  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 1.6760916709899902  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.62347412109375 GB
    Memory Allocated: 0.9705009460449219  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.64495849609375 GB
    Memory Allocated: 36.633426666259766  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 53.64495849609375 GB
    Memory Allocated: 36.68527269363403  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 53.64495849609375 GB
    Memory Allocated: 0.9601407051086426  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 53.64495849609375 GB
    Memory Allocated: 1.688584804534912  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 53.64495849609375 GB
    Memory Allocated: 1.6891846656799316  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.64495849609375 GB
    Memory Allocated: 0.9925327301025391  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.64691162109375 GB
    Memory Allocated: 36.6445631980896  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 53.64691162109375 GB
    Memory Allocated: 36.69639778137207  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 53.64886474609375 GB
    Memory Allocated: 0.9824337959289551  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 53.64886474609375 GB
    Memory Allocated: 1.7172493934631348  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 53.64886474609375 GB
    Memory Allocated: 1.7178492546081543  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.64886474609375 GB
    Memory Allocated: 1.019495964050293  GigaBytes
Max Memory Allocated: 37.983256816864014  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.40081787109375 GB
    Memory Allocated: 37.07396411895752  GigaBytes
Max Memory Allocated: 38.11687755584717  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.40081787109375 GB
    Memory Allocated: 37.12607717514038  GigaBytes
Max Memory Allocated: 38.11687755584717  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 63.40081787109375 GB
    Memory Allocated: 1.0080680847167969  GigaBytes
Max Memory Allocated: 38.11687755584717  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.40081787109375 GB
    Memory Allocated: 1.742854118347168  GigaBytes
Max Memory Allocated: 38.11687755584717  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.40081787109375 GB
    Memory Allocated: 1.7434539794921875  GigaBytes
Max Memory Allocated: 38.11687755584717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.40081787109375 GB
    Memory Allocated: 1.0387368202209473  GigaBytes
Max Memory Allocated: 38.11687755584717  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.40081787109375 GB
    Memory Allocated: 37.04252004623413  GigaBytes
Max Memory Allocated: 38.11687755584717  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.40081787109375 GB
    Memory Allocated: 37.09408760070801  GigaBytes
Max Memory Allocated: 38.11687755584717  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 63.40081787109375 GB
    Memory Allocated: 1.0282082557678223  GigaBytes
Max Memory Allocated: 38.11687755584717  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.40081787109375 GB
    Memory Allocated: 1.7692337036132812  GigaBytes
Max Memory Allocated: 38.11687755584717  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.40081787109375 GB
    Memory Allocated: 1.7698335647583008  GigaBytes
Max Memory Allocated: 38.11687755584717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.40081787109375 GB
    Memory Allocated: 1.065157413482666  GigaBytes
Max Memory Allocated: 38.11687755584717  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 37.29636526107788  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 37.34793281555176  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.055464744567871  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.7881650924682617  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.7887649536132812  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.0778284072875977  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 37.10566425323486  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 37.15723180770874  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.0668230056762695  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.8020730018615723  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.8026728630065918  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.1002273559570312  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 37.006653785705566  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 37.05822134017944  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.0905036926269531  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.8197450637817383  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.8203449249267578  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.1151599884033203  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.921207427978516  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.973209857940674  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

number of input  23053720
----------------------------------------after optimizer
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.1599822044372559  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.175224304199219
pure train time :  10.035356760025024
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.14616966247558594
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.036142826080322266
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1596226692199707
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.8268842697143555  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.562696933746338  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.5632967948913574  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.8627800941467285  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.75036096572876  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.78258275985718  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.8376169204711914  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.5661373138427734  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.566737174987793  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.8594584465026855  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.52245283126831  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.57402038574219  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.8509507179260254  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.5821166038513184  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.582716464996338  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.8828296661376953  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.587918281555176  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.63948583602905  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.8729124069213867  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.606203556060791  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.6068034172058105  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.9046430587768555  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.9645357131958  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 37.01610326766968  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.8968844413757324  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.6264209747314453  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.6270208358764648  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.9222426414489746  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.56082344055176  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.612390995025635  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.9136648178100586  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.6493802070617676  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.649980068206787  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.9493985176086426  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.88372468948364  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.935818672180176  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.9401073455810547  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.6686277389526367  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.6692276000976562  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.9621472358703613  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.77356719970703  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.8256459236145  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.9524827003479004  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.6818571090698242  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.6824569702148438  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.9833817481994629  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.6818323135376  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 36.733399868011475  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 0.9730238914489746  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.7044310569763184  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.705030918121338  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.08245849609375 GB
    Memory Allocated: 1.0051889419555664  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 36.91370677947998  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 36.96537733078003  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 0.9948782920837402  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.7290172576904297  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.7296171188354492  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.027930736541748  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 37.04586219787598  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 37.09742975234985  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.0170860290527344  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.7509241104125977  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.7515239715576172  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.0470452308654785  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 36.92925214767456  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 36.98081970214844  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.036445140838623  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.7691168785095215  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.769716739654541  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.0655055046081543  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 37.06546592712402  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 37.1173996925354  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.0572805404663086  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.793550968170166  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.7941508293151855  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.0910930633544922  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 37.17280292510986  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 37.22437047958374  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.0821762084960938  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.8204903602600098  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.8210902214050293  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.09808349609375 GB
    Memory Allocated: 1.1144933700561523  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.26961898803711  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.321186542510986  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.104097843170166  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.8385958671569824  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.839195728302002  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.1304125785827637  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.02142810821533  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.07299566268921  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

number of input  23052935
----------------------------------------after optimizer
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.1676793098449707  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.745737075805664
pure train time :  9.083083152770996
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.23697113990783691
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.055095672607421875
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.24799513816833496
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8314270973205566  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5638489723205566  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5644488334655762  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8586268424987793  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.72396469116211  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.75619554519653  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8346171379089355  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5632600784301758  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5638599395751953  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8599023818969727  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.47216176986694  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.52372932434082  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8517580032348633  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5841798782348633  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5847797393798828  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8848557472229004  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.81327247619629  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.865137577056885  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8766698837280273  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6094355583190918  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6100354194641113  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9071831703186035  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.65567398071289  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.70724153518677  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8973293304443359  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.630849838256836  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6314496994018555  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9274191856384277  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.83324432373047  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.884811878204346  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9182429313659668  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6506648063659668  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6512646675109863  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9465570449829102  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.75866413116455  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.810404777526855  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9369602203369141  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.668691635131836  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6692914962768555  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9663138389587402  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.764403343200684  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.81625699996948  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9557676315307617  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.690328598022461  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6909284591674805  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9894919395446777  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.82521677017212  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.877135276794434  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9797172546386719  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.712263584136963  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7128634452819824  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.008601188659668  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.849045276641846  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.90061283111572  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9973049163818359  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7341690063476562  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7347688674926758  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0327401161193848  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.107651710510254  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.15921926498413  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.021265983581543  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7586631774902344  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.759263038635254  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.052924633026123  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.193870067596436  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.24543762207031  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0418415069580078  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7742633819580078  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7748632431030273  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0677862167358398  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.084847927093506  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.13641548156738  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0595126152038574  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7905330657958984  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.791132926940918  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0890064239501953  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.02757167816162  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.07932996749878  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0781116485595703  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.8105335235595703  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.8111333847045898  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.110426425933838  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.07982921600342  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.131396770477295  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0991692543029785  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.8327574729919434  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.833357334136963  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.1312241554260254  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.03772211074829  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.08928966522217  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

number of input  23049792
----------------------------------------after optimizer
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.1707205772399902  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.5268120765686035
pure train time :  9.191819906234741
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.17143654823303223
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.05096435546875
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.17888307571411133
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8318815231323242  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5674729347229004  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.56807279586792  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8658838272094727  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.90363788604736  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.935458183288574  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8378872871398926  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5729398727416992  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5735397338867188  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8682398796081543  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.69851493835449  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.75008249282837  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8575901985168457  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.591975212097168  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5925750732421875  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8870391845703125  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.90759754180908  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.95916509628296  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8771181106567383  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6084632873535156  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6090631484985352  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9048137664794922  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.7479133605957  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.79948091506958  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.894841194152832  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.627425193786621  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6280250549316406  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9261260032653809  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.80306386947632  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.855302810668945  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9181427955627441  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6494183540344238  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6500182151794434  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9469003677368164  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.92614507675171  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.97821235656738  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9361734390258789  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6666760444641113  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6672759056091309  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9654278755187988  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.83488368988037  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.88668775558472  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9560637474060059  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6885294914245605  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.68912935256958  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9883580207824707  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.94378328323364  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.996121406555176  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9772906303405762  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7072138786315918  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7078137397766113  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0056681632995605  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.737688064575195  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.79014444351196  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.99493408203125  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7298860549926758  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7304859161376953  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0315742492675781  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.171202659606934  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.22277021408081  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0206489562988281  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.75468111038208  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7552809715270996  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.050661563873291  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.98093795776367  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.03316926956177  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.039675235748291  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.770737648010254  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7713375091552734  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.067605972290039  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.803751945495605  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.85589551925659  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0571784973144531  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7909727096557617  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7915725708007812  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.090841293334961  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.054606437683105  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.10667371749878  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0808124542236328  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.8132343292236328  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.8138341903686523  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.1103110313415527  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.74518013000488  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.79698419570923  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0993232727050781  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.8312292098999023  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.8318290710449219  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.1295452117919922  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.93424987792969  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.9858136177063  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

number of input  23048833
----------------------------------------after optimizer
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.1683239936828613  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.3017988204956055
pure train time :  9.239262104034424
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.15201258659362793
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03068232536315918
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15947580337524414
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.82891845703125  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5573415756225586  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5579414367675781  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8554658889770508  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.620415687561035  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.65245246887207  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8294162750244141  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5561285018920898  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5567283630371094  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8576383590698242  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.425379276275635  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.47694683074951  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.847069263458252  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5800161361694336  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.5806159973144531  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8837318420410156  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.772210121154785  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.82377767562866  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8753342628479004  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6082978248596191  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6088976860046387  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9054851531982422  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.885791301727295  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.93735885620117  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.8948216438293457  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6261730194091797  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6267728805541992  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9232921600341797  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.78693199157715  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.838499546051025  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9124970436096191  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6442608833312988  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6448607444763184  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9432249069213867  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.83450794219971  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.886075496673584  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9326796531677246  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6659212112426758  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6665210723876953  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9650506973266602  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.844483852386475  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.89605140686035  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9550080299377441  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6839218139648438  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.6845216751098633  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9815526008605957  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.75452280044556  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.806090354919434  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9705181121826172  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7054805755615234  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.706080436706543  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0074372291564941  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.77007865905762  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.821646213531494  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 0.9959225654602051  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.731004238128662  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7316040992736816  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0268754959106445  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.01930475234985  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.07087230682373  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0156617164611816  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7508835792541504  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.75148344039917  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0466394424438477  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.0681791305542  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.119746685028076  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0385303497314453  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7752342224121094  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.775834083557129  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.070838451385498  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.13490104675293  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.18646860122681  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0619029998779297  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7929506301879883  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.7935504913330078  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.087048053741455  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.917762756347656  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.96933031082153  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0758557319641113  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.8085823059082031  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.8091821670532227  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.1083245277404785  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 36.96783638000488  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 37.01940393447876  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.0973749160766602  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.8360581398010254  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.836658000946045  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.85003662109375 GB
    Memory Allocated: 1.1341614723205566  GigaBytes
Max Memory Allocated: 38.344489097595215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.338711738586426  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.39027547836304  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23049260
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1752147674560547  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.003027439117432
pure train time :  9.962598323822021
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.1642773151397705
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04065847396850586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.17337703704833984
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8377113342285156  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5668554306030273  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5674552917480469  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.857783317565918  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.457303524017334  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.487324714660645  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8297572135925293  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5638904571533203  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5644903182983398  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8663177490234375  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.921916484832764  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.97348403930664  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.857184886932373  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5903801918029785  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.590980052947998  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.885474681854248  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.61186599731445  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.66343355178833  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8758277893066406  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6082234382629395  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.608823299407959  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9062342643737793  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.79763078689575  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.84919834136963  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8975954055786133  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.628298282623291  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6288981437683105  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9250974655151367  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.66365385055542  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.71603012084961  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9146666526794434  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6454296112060547  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6460294723510742  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9457330703735352  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.95649766921997  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.00806522369385  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9345426559448242  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6697945594787598  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6703944206237793  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9706673622131348  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.95536756515503  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.006935119628906  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9586367607116699  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.694284439086914  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6948843002319336  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9901533126831055  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.76703071594238  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.81859827041626  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9785528182983398  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.712134838104248  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7127346992492676  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0077505111694336  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.969658851623535  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.02122640609741  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9978909492492676  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7342267036437988  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7348265647888184  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0316414833068848  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.027520179748535  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.07908773422241  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0221238136291504  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.755617618560791  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7562174797058105  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.050123691558838  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.11325645446777  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.16482400894165  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.03965425491333  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7736515998840332  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7742514610290527  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.070986270904541  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.09941911697388  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.150986671447754  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0641202926635742  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7992124557495117  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7998123168945312  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.096013069152832  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.96616458892822  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.018285274505615  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0839238166809082  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8159608840942383  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8165607452392578  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1118168830871582  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.03546714782715  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.087034702301025  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1010088920593262  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.830152988433838  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8307528495788574  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.12892484664917  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.871055603027344  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.92262315750122  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23056814
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.167203426361084  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7382631301879883
pure train time :  9.880980253219604
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.15814900398254395
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03458142280578613
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16725945472717285
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8270816802978516  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.562300205230713  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5629000663757324  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8643755912780762  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.93737602233887  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.969239234924316  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8369197845458984  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5715632438659668  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5721631050109863  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8664388656616211  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.78341770172119  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.83498525619507  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8566584587097168  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5897316932678223  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5903315544128418  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8856706619262695  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.80271911621094  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85505723953247  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8742437362670898  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.608774185180664  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6093740463256836  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9068131446838379  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.71335220336914  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.76491975784302  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8959188461303711  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.633437156677246  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6340370178222656  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9297771453857422  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.09319019317627  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.14475774765015  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9182100296020508  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.652003288269043  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6526031494140625  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9459395408630371  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.90469217300415  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.95625972747803  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.935391902923584  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.666344165802002  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6669440269470215  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9633889198303223  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.93393659591675  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.985504150390625  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9524903297424316  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6811251640319824  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.681725025177002  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9811902046203613  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.67404270172119  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.72578573226929  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9701275825500488  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.700993537902832  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7015933990478516  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0034890174865723  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.98234415054321  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.03391170501709  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9923214912414551  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7265653610229492  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7271652221679688  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0265460014343262  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.0111026763916  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.06267023086548  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.016805648803711  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7465839385986328  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7471837997436523  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.04329252243042  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.740581035614014  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.792686462402344  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0325255393981934  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7647285461425781  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7653284072875977  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0657615661621094  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.8661003112793  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.918644428253174  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0538544654846191  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7884130477905273  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7890129089355469  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0870232582092285  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.97778797149658  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.02935552597046  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0763216018676758  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.811439037322998  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8120388984680176  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1081767082214355  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.02188539505005  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.07351779937744  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0983805656433105  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8289790153503418  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8295788764953613  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1246891021728516  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.994099140167236  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.04618167877197  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23059717
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1630845069885254  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.5182478427886963
pure train time :  9.618257761001587
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.1549386978149414
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030572891235351562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16410279273986816
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8272614479064941  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5587987899780273  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5593986511230469  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8586063385009766  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.76726961135864  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.79965591430664  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8337054252624512  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.571153163909912  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5717530250549316  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8703160285949707  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.976147174835205  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.02771472930908  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8604297637939453  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.593470573425293  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5940704345703125  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8853263854980469  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.73992347717285  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.79149103164673  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8760867118835449  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.608508586883545  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6091084480285645  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9056205749511719  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.73388862609863  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.78545618057251  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8947949409484863  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6292457580566406  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6298456192016602  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9278140068054199  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.965840339660645  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.01740789413452  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.916440486907959  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.648705005645752  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6493048667907715  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9453063011169434  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.926433086395264  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.97800064086914  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9342212677001953  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.668694019317627  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6692938804626465  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9675450325012207  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.00359344482422  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.055160999298096  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9595880508422852  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6920099258422852  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6926097869873047  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.988499641418457  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.870710372924805  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.92261743545532  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9770145416259766  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7131943702697754  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.713794231414795  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0117549896240234  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.03471660614014  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.086284160614014  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9999675750732422  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7352004051208496  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7358002662658691  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.030005931854248  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.971810817718506  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.02337837219238  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.01951265335083  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.750852108001709  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7514519691467285  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.046722412109375  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.772369384765625  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.82412767410278  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0352563858032227  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7657074928283691  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7663073539733887  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0652575492858887  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.81670618057251  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.86827373504639  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0539660453796387  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7843809127807617  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7849807739257812  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0851011276245117  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.94297218322754  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.99469995498657  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0734481811523438  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.801353931427002  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8019537925720215  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1021161079406738  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.800453186035156  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85202074050903  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0915193557739258  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.825878620147705  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8264784812927246  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1291584968566895  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.090614795684814  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.1423921585083  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23053365
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1685009002685547  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3723626136779785
pure train time :  9.622283220291138
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.1534123420715332
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.031026363372802734
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16230344772338867
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.831963062286377  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5646743774414062  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5652742385864258  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8602557182312012  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.52603483200073  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.557480335235596  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8334665298461914  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5681166648864746  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5687165260314941  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8654365539550781  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.869483947753906  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.92105150222778  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8545613288879395  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5908203125  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5914201736450195  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8861432075500488  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.70213270187378  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.753700256347656  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8769941329956055  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.61474609375  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6153459548950195  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9085812568664551  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.96935319900513  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.020920753479004  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8998050689697266  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.630441665649414  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6310415267944336  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9234542846679688  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.697142601013184  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.74871015548706  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9133086204528809  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6470742225646973  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6476740837097168  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9466919898986816  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85492467880249  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.906747817993164  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9375925064086914  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6721453666687012  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6727452278137207  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9686341285705566  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.89488124847412  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.94719648361206  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9587931632995605  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6912150382995605  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.69181489944458  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9866456985473633  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.83008909225464  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.88254165649414  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9760246276855469  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7030353546142578  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7036352157592773  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.000579833984375  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.789756298065186  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.84217834472656  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9900398254394531  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.723825454711914  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7244253158569336  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0276298522949219  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.97338151931763  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.025479316711426  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0165300369262695  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7492766380310059  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7498764991760254  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0465102195739746  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.08497428894043  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.1367974281311  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0355548858642578  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7664403915405273  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7670402526855469  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.064530849456787  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.104849338531494  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.15661907196045  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0532574653625488  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7886767387390137  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7892765998840332  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0886130332946777  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.047863483428955  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.09943103790283  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0792107582092285  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8079466819763184  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.808546543121338  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1042461395263672  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.77987623214722  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.83211898803711  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.093437671661377  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.827324390411377  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8279242515563965  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.129340648651123  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.18895626068115  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.240520000457764  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23056703
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1681938171386719  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2703118324279785
pure train time :  9.639275312423706
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.15375041961669922
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03125596046447754
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16269207000732422
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8322849273681641  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5628437995910645  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.563443660736084  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8581843376159668  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.62772226333618  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.65837335586548  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8316717147827148  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5653271675109863  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5659270286560059  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8640584945678711  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.69681787490845  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.748385429382324  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8540072441101074  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5836801528930664  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.584280014038086  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8792157173156738  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.62132692337036  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.67289447784424  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8696942329406738  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6052002906799316  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6058001518249512  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9051737785339355  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.92590808868408  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.97747564315796  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.895268440246582  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6286044120788574  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.629204273223877  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9226827621459961  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.838366985321045  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.88993453979492  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9152307510375977  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6516904830932617  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6522903442382812  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9477486610412598  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.98209857940674  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.033666133880615  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9384965896606445  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6699018478393555  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.670501708984375  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9627685546875  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.95422554016113  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.00579309463501  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9535698890686035  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6890830993652344  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.689682960510254  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9879283905029297  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.053295612335205  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.10486316680908  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9776802062988281  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7161130905151367  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7167129516601562  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.01096773147583  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.91622972488403  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.96779727935791  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0003700256347656  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7305560111999512  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7311558723449707  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0222735404968262  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.8974666595459  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.94920206069946  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0116562843322754  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7420868873596191  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7426867485046387  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0422449111938477  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.79655838012695  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.84812593460083  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0327224731445312  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7658166885375977  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7664165496826172  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0655550956726074  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.9640212059021  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.01606559753418  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0546131134033203  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.785778522491455  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7863783836364746  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.082827091217041  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.89790439605713  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.949471950531006  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0724740028381348  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8079419136047363  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8085417747497559  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1079039573669434  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.239981174468994  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.29154872894287  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0976896286010742  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8261175155639648  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8267173767089844  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1208252906799316  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.825804710388184  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.877368450164795  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23054647
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1592159271240234  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0751538276672363
pure train time :  9.634159564971924
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.15366530418395996
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0305631160736084
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16253066062927246
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8267674446105957  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.560018539428711  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5606184005737305  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8614292144775391  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85201025009155  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.88369274139404  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8352193832397461  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5689129829406738  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5695128440856934  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8657307624816895  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.90496873855591  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.956536293029785  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8580307960510254  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5877490043640137  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5883488655090332  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8840522766113281  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.746739864349365  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.79830741882324  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8738551139831543  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6096429824829102  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6102428436279297  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9101581573486328  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.87280082702637  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.92449426651001  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.899752140045166  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.63728666305542  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6378865242004395  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9330525398254395  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.055155754089355  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.10672330856323  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.922490119934082  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6507630348205566  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6513628959655762  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9440202713012695  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.694950580596924  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.7465181350708  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9335498809814453  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6652402877807617  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6658401489257812  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9679837226867676  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.783281326293945  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.83555459976196  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9563565254211426  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6865205764770508  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6871204376220703  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9861154556274414  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.972042083740234  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.02426195144653  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9766936302185059  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7136130332946777  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7142128944396973  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.014275074005127  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.060370445251465  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.11193799972534  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.002697467803955  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.738149642944336  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7387495040893555  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0320343971252441  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.97759675979614  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.02916431427002  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0210423469543457  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7519774436950684  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.752577304840088  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0473136901855469  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.72509956359863  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.77666711807251  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0367650985717773  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7657709121704102  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7663707733154297  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0659499168395996  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.816555976867676  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.86873388290405  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0546793937683105  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.785264492034912  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7858643531799316  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0870370864868164  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85330677032471  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.904874324798584  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.076469898223877  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8121976852416992  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8127975463867188  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1124358177185059  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.04722023010254  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.098787784576416  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1003203392028809  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8320116996765137  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8326115608215332  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.127389907836914  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.056979179382324  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.10905408859253  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23048601
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1663126945495605  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9550676345825195
pure train time :  9.735345840454102
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.16238141059875488
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.036971092224121094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1712031364440918
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.830049991607666  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.56500244140625  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5656023025512695  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.862947940826416  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.701916217803955  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.73306465148926  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8354349136352539  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.567856788635254  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5684566497802734  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8624763488769531  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.6964168548584  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.747984409332275  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8525533676147461  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5850143432617188  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5856142044067383  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8820219039916992  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.9133620262146  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.96492958068848  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8742585182189941  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.611095905303955  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6116957664489746  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9079680442810059  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.822433948516846  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.87400150299072  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8983540534973145  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6321959495544434  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.632795810699463  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9247612953186035  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.962053298950195  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.01395273208618  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9148249626159668  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6485767364501953  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6491765975952148  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9440402984619141  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.842257499694824  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.8938250541687  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9339032173156738  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.674790382385254  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6753902435302734  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9706587791442871  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.128833293914795  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.18040084838867  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9608139991760254  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.693894386291504  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6944942474365234  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9831809997558594  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.78964805603027  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.84121561050415  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9728660583496094  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.700606346130371  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7012062072753906  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9978790283203125  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.77660417556763  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.828171730041504  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9870567321777344  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7205138206481934  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.721113681793213  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0229692459106445  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.88554286956787  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.93749189376831  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0119528770446777  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7462043762207031  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7468042373657227  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0429563522338867  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.95509195327759  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.006659507751465  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0329203605651855  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.759608268737793  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7602081298828125  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0544562339782715  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.67872953414917  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.73088073730469  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0454072952270508  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7755694389343262  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7761693000793457  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0790629386901855  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.87762498855591  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.929192543029785  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.068983554840088  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7956128120422363  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7962126731872559  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.095613956451416  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.97430610656738  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.02626657485962  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0851364135742188  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8196439743041992  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8202438354492188  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1231884956359863  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.94391059875488  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.99547815322876  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23050076
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1607728004455566  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.862999677658081
pure train time :  10.042844533920288
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.1566452980041504
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03363919258117676
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16736674308776855
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8318037986755371  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5649824142456055  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.565582275390625  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8598232269287109  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.82277488708496  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.854527950286865  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8343949317932129  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5699496269226074  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.570549488067627  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8661699295043945  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.91206693649292  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.9636344909668  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8577508926391602  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5943241119384766  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.594923973083496  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8880782127380371  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.75264072418213  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.804208278656006  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8780665397644043  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6106157302856445  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.611215591430664  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9039397239685059  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.74162483215332  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.7931923866272  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8941817283630371  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.625493049621582  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6260929107666016  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9224567413330078  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.893014430999756  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.94458198547363  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9144988059997559  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6510977745056152  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6516976356506348  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9491672515869141  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.97343683242798  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.025248527526855  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9390091896057129  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6729321479797363  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6735320091247559  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.965660572052002  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.874478816986084  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.92604637145996  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9560637474060059  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6868901252746582  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6874899864196777  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9821667671203613  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.71139097213745  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.76295852661133  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9729108810424805  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.70137357711792  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7019734382629395  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9997210502624512  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.71364784240723  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.765554904937744  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9907646179199219  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.721118450164795  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7217183113098145  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0225324630737305  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.899888038635254  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.951791286468506  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0129046440124512  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7443451881408691  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7449450492858887  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0432243347167969  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.80096912384033  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85253667831421  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0339035987854004  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7730813026428223  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7736811637878418  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.07112455368042  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.18045663833618  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.23228359222412  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0617985725402832  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7928528785705566  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7934527397155762  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0839285850524902  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.07044744491577  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.12201499938965  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0748839378356934  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8037614822387695  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.804361343383789  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1028766632080078  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.8566689491272  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.908236503601074  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0933103561401367  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8257322311401367  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8263320922851562  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1267695426940918  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.94518518447876  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.996989250183105  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23051271
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1634178161621094  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7468230724334717
pure train time :  9.662668466567993
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.15239953994750977
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03148984909057617
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16131091117858887
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8300557136535645  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5679974555969238  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5685973167419434  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8666644096374512  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.00485372543335  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.036269187927246  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.84002685546875  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5744428634643555  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.575042724609375  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8666925430297852  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.88326835632324  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.93483591079712  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8565664291381836  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5907363891601562  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5913362503051758  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8864669799804688  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.802048683166504  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85361623764038  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8775753974914551  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.609997272491455  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6105971336364746  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9059586524963379  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.77598476409912  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.82809400558472  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8951892852783203  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6269292831420898  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6275291442871094  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9245476722717285  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.650235652923584  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.70180320739746  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9147038459777832  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6471257209777832  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6477255821228027  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9462356567382812  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.92537498474121  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.97694253921509  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9349665641784668  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6682624816894531  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6688623428344727  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9666652679443359  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.82466793060303  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.87631177902222  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9554266929626465  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6852316856384277  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6858315467834473  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9829769134521484  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.63293647766113  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.68480157852173  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9712405204772949  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7063794136047363  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7069792747497559  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0077095031738281  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.01730489730835  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.06887245178223  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9962224960327148  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7373337745666504  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.73793363571167  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0331950187683105  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.16696786880493  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.21853542327881  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.021784782409668  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7488560676574707  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7494559288024902  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.039205551147461  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.73391771316528  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.78548526763916  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.027909278869629  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7584228515625  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7590227127075195  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0624136924743652  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.907742500305176  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.95947790145874  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0510692596435547  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7845377922058105  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.78513765335083  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0850143432617188  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.974735736846924  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.02665424346924  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0767292976379395  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8111071586608887  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8117070198059082  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1084966659545898  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.15774440765381  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.209311962127686  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.096879482269287  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8246335983276367  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8252334594726562  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1210622787475586  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.831440448760986  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.88300800323486  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23056754
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.160393238067627  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.676307439804077
pure train time :  9.690223217010498
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.15454840660095215
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02984619140625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16345548629760742
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8250508308410645  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5522856712341309  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5528855323791504  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.854069709777832  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.53822469711304  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.57090425491333  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8284850120544434  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5585103034973145  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.559110164642334  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8605437278747559  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.7272424697876  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.778810024261475  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8531627655029297  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5855846405029297  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5861845016479492  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.884831428527832  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.73662805557251  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.78819561004639  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8752932548522949  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6064586639404297  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6070585250854492  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9033031463623047  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.75469779968262  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.806265354156494  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.893317699432373  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.624626636505127  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6252264976501465  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9227323532104492  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.80307102203369  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85463857650757  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9126791954040527  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.64829683303833  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6488966941833496  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9462780952453613  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.78401803970337  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.835646629333496  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9384217262268066  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6719436645507812  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6725435256958008  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.965571403503418  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.80010414123535  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85167169570923  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9567828178405762  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.690624713897705  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6912245750427246  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9864187240600586  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.87293004989624  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.924978256225586  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9774398803710938  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7098841667175293  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7104840278625488  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.006117343902588  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.06039476394653  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.11196231842041  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9967756271362305  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7296295166015625  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.730229377746582  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.027207851409912  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.029276847839355  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.08084440231323  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.017979621887207  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7513532638549805  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.751953125  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0478296279907227  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.937745571136475  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.98931312561035  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0384435653686523  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7716197967529297  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7722196578979492  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0689797401428223  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.966835498809814  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.01876163482666  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0577082633972168  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7920737266540527  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7926735877990723  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0891027450561523  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.14531755447388  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.196885108947754  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0814471244812012  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8173761367797852  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8179759979248047  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.113107681274414  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.108757972717285  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.16049337387085  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1033868789672852  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8385286331176758  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8391284942626953  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1326494216918945  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.9867000579834  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.03826379776001  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23051652
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1697487831115723  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6060233116149902
pure train time :  9.634902954101562
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.15767955780029297
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03004932403564453
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16665887832641602
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8322477340698242  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.565068244934082  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5656681060791016  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8609766960144043  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.919610023498535  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.95155334472656  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8345012664794922  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5629653930664062  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5635652542114258  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8601040840148926  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.5704870223999  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.62205457687378  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8495602607727051  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5801982879638672  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5807981491088867  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8817267417907715  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.68541717529297  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.736984729766846  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8714041709899902  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6042089462280273  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6048088073730469  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9043049812316895  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.8354868888855  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.887054443359375  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8934283256530762  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.631070613861084  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6316704750061035  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9290227890014648  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.01718854904175  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.068756103515625  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.918609619140625  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.647073745727539  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6476736068725586  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9401359558105469  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.62600898742676  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.677576541900635  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9287433624267578  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.659656047821045  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6602559089660645  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9621539115905762  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.81525135040283  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.86707067489624  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9513359069824219  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6846275329589844  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.685227394104004  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9844546318054199  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.873735427856445  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.92530298233032  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9733405113220215  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7050871849060059  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7056870460510254  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0025019645690918  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.74703931808472  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.798606872558594  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9910488128662109  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7272138595581055  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.727813720703125  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0263614654541016  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.13670349121094  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.188271045684814  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0149688720703125  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7480573654174805  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7486572265625  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.042707920074463  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.00747871398926  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.059046268463135  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0316495895385742  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7662744522094727  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7668743133544922  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0639114379882812  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.97648811340332  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.0280556678772  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0532231330871582  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7889952659606934  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.789595127105713  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0850920677185059  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.94946479797363  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.001089572906494  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0744409561157227  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8073081970214844  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.807908058166504  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1022624969482422  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.9105224609375  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.96209001541138  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0915155410766602  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8274168968200684  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.828016757965088  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1252999305725098  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.12980794906616  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.18143653869629  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23058398
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1660833358764648  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.541233539581299
pure train time :  9.649812698364258
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.15226459503173828
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029767990112304688
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16118359565734863
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8351926803588867  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5644559860229492  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5650558471679688  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8584070205688477  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.54766273498535  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.577420711517334  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8299436569213867  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5585660934448242  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5591659545898438  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8584613800048828  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.554091930389404  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.60565948486328  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8489789962768555  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5833721160888672  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5839719772338867  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8840827941894531  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.864956855773926  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.9165244102478  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8759284019470215  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6097755432128906  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6103754043579102  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9047603607177734  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.92946529388428  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.981032848358154  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8957505226135254  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.628321647644043  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6289215087890625  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9238295555114746  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.84554958343506  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.897117137908936  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9148540496826172  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6469674110412598  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6475672721862793  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9445090293884277  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.97453784942627  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.0263876914978  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9353585243225098  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6707005500793457  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6713004112243652  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9679117202758789  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.902719020843506  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.95428657531738  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.958651065826416  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6979799270629883  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6985797882080078  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9920434951782227  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.01816129684448  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.06972885131836  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9837970733642578  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7215256690979004  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.72212553024292  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0116376876831055  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.02420425415039  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.07577180862427  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0022754669189453  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7335448265075684  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.734144687652588  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0265836715698242  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.95781183242798  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.009379386901855  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0167927742004395  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7484383583068848  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7490382194519043  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0480546951293945  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.932302474975586  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.98420572280884  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0362772941589355  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7666664123535156  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7672662734985352  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0661664009094238  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.697999000549316  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.74956655502319  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0548033714294434  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.786268711090088  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7868685722351074  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.086777687072754  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.96379613876343  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.015363693237305  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0761380195617676  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.810293197631836  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8108930587768555  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.109677791595459  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.06689214706421  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.11865043640137  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.098188877105713  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8327608108520508  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8333606719970703  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1294584274291992  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.16489505767822  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.2164626121521  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23061765
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.168501377105713  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4771389961242676
pure train time :  9.699068069458008
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.16326904296875
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.035570621490478516
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.17235708236694336
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.832003116607666  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5650935173034668  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5656933784484863  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8598289489746094  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.80858755111694  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.84028959274292  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8336286544799805  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5644278526306152  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5650277137756348  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8610334396362305  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.547425270080566  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.59899282455444  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8507633209228516  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.581031322479248  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5816311836242676  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8799824714660645  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.77773380279541  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.82930135726929  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8701066970825195  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5997591018676758  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6003589630126953  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8995318412780762  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.687450885772705  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.73916721343994  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8897109031677246  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6228857040405273  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6234855651855469  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9237971305847168  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.93961048126221  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.99153280258179  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9127426147460938  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.645118236541748  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6457180976867676  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9427080154418945  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.98584461212158  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.03741216659546  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.934199333190918  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.668795108795166  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6693949699401855  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9669747352600098  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.84108543395996  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.89270257949829  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9559383392333984  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6898279190063477  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6904277801513672  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9857921600341797  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.899991512298584  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.95196342468262  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.974609375  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7068872451782227  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7074871063232422  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.003706932067871  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.83759832382202  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.8891658782959  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9933857917785645  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7263894081115723  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7269892692565918  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0246548652648926  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.01751232147217  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.06941556930542  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.013808250427246  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7522377967834473  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7528376579284668  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0497918128967285  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.18590450286865  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.23747205734253  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0391907691955566  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7733182907104492  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7739181518554688  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0654120445251465  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.91575765609741  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.96732521057129  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.054736614227295  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7873802185058594  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.787980079650879  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.083763599395752  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.91876697540283  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.97080373764038  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0723323822021484  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8021860122680664  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.802785873413086  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1000466346740723  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.81342172622681  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.864989280700684  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0895142555236816  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8232312202453613  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8238310813903809  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1240930557250977  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.09836149215698  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.15007400512695  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23051682
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1636934280395508  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4354231357574463
pure train time :  10.061354398727417
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.16113972663879395
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.041835784912109375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.17200064659118652
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8322405815124512  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.561537742614746  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5621376037597656  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8582510948181152  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.64552593231201  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.6760516166687  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8303670883178711  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5636529922485352  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5642528533935547  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8636317253112793  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.75835084915161  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.80991840362549  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8555121421813965  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.589829921722412  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5904297828674316  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8868446350097656  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.824095726013184  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.87566328048706  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8760294914245605  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6113576889038086  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6119575500488281  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9075264930725098  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.09262657165527  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.14419412612915  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8966641426086426  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6279501914978027  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6285500526428223  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9218730926513672  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.70564794540405  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.75721549987793  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9120097160339355  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6421103477478027  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6427102088928223  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9402751922607422  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.71726655960083  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.76884937286377  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9310812950134277  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6645193099975586  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6651191711425781  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9639420509338379  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.80026054382324  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85229730606079  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9540214538574219  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6877126693725586  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6883125305175781  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9837117195129395  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.76921558380127  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.82093572616577  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9750561714172363  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7130770683288574  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.713676929473877  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0104303359985352  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.018105030059814  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.07026767730713  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9983654022216797  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7299556732177734  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.730555534362793  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0219635963439941  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.80300235748291  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85456991195679  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0124707221984863  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7441825866699219  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7447824478149414  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0436463356018066  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.00337553024292  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.05530548095703  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0332961082458496  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7646551132202148  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7652549743652344  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.062983512878418  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.82723379135132  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.8790225982666  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0528430938720703  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7865548133850098  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7871546745300293  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0862774848937988  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.136783599853516  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.18891954421997  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0759620666503906  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8079500198364258  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8085498809814453  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1042742729187012  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.883912563323975  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.93548011779785  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0938982963562012  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.827244758605957  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8278446197509766  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1255693435668945  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.06083536148071  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.112399101257324  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23052887
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.161928653717041  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3806188106536865
pure train time :  9.675839900970459
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
range partition time  0.1573033332824707
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03020620346069336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16776180267333984
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8305044174194336  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5652589797973633  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5658588409423828  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8613371849060059  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.94191789627075  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.973809242248535  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8360786437988281  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5710902214050293  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5716900825500488  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8672609329223633  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.80711507797241  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85868263244629  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8572144508361816  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.5897202491760254  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.590320110321045  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8847851753234863  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.83979272842407  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.89136028289795  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.8745498657226562  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6070151329040527  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6076149940490723  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9046287536621094  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.74025630950928  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.79233503341675  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.894045352935791  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.623537540435791  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6241374015808105  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9220623970031738  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.565078258514404  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.61664581298828  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9114723205566406  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6439032554626465  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.644503116607666  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9459147453308105  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85289144515991  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.90445899963379  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9341812133789062  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.669323444366455  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6699233055114746  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9677343368530273  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.92795753479004  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.979525089263916  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9591031074523926  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6937599182128906  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.6943597793579102  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9894375801086426  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.76179313659668  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.81339502334595  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9773087501525879  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.708364486694336  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7089643478393555  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0047025680541992  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.73215103149414  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.78371858596802  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 0.9944281578063965  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7255048751831055  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.726104736328125  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0253081321716309  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.99713373184204  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.04896831512451  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0138516426086426  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7499713897705078  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7505712509155273  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0497431755065918  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.01506948471069  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.06663703918457  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.040421485900879  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7764983177185059  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7770981788635254  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.071249008178711  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.128212451934814  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.180325508117676  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0615215301513672  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7912483215332031  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.7918481826782227  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0861330032348633  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.89804220199585  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.94960975646973  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0760998725891113  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8072171211242676  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.807816982269287  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1082639694213867  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.98708486557007  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 37.03923988342285  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.0987067222595215  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.8293070793151855  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.829906940460205  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.12890625  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.85488271713257  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 36.906450271606445  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

number of input  23052383
----------------------------------------after optimizer
 Nvidia-smi: 75.38714599609375 GB
    Memory Allocated: 1.1672286987304688  GigaBytes
Max Memory Allocated: 38.38766527175903  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3394362926483154
pure train time :  9.643559455871582
epoch_time_list  [46.978827476501465, 46.509846210479736, 52.22812247276306, 46.6041693687439, 47.94323468208313, 49.81218075752258, 47.73325800895691, 47.23228454589844, 47.38150143623352, 48.43862271308899, 51.61076235771179, 48.86103582382202, 48.36385369300842, 46.827417612075806, 46.509090185165405, 46.49181842803955, 47.68878221511841, 48.78737831115723, 47.60868740081787, 47.55496072769165]

loading_time list   [0.8674333095550537, 0.8790645599365234, 0.6231091022491455, 1.1286773681640625, 0.6764652729034424, 1.209782361984253, 0.9343891143798828, 0.6743302345275879, 0.7249436378479004, 0.7326216697692871, 0.679368257522583, 0.9078269004821777, 0.9091615676879883, 0.7744355201721191, 0.7406086921691895, 0.7368574142456055, 0.7613441944122314, 0.7594025135040283, 1.1726014614105225, 0.9319653511047363]

 data loader gen time  33.274662017822266
	---backpack schedule time  [0.33989739418029785, 0.3261551856994629, 0.4571192264556885, 0.3433818817138672, 0.28641819953918457, 0.32344579696655273, 0.31471896171569824, 0.30408716201782227, 0.3166627883911133, 0.3199145793914795, 0.3184971809387207, 0.3383626937866211, 0.3295459747314453, 0.32027101516723633, 0.3142557144165039, 0.3245265483856201, 0.3192157745361328, 0.35968613624572754, 0.3479328155517578, 0.3230094909667969]
	---connection_check_time_list  [5.938939332962036, 5.677725076675415, 12.222509145736694, 6.193129777908325, 7.501545190811157, 8.086546659469604, 7.122700452804565, 6.756110668182373, 6.817642450332642, 8.140355348587036, 10.396451950073242, 7.57566499710083, 7.02824330329895, 6.373805284500122, 6.303361415863037, 6.453362703323364, 7.398542165756226, 7.284541845321655, 6.726545572280884, 6.7211713790893555]
	---block_gen_time_list  [3.496279001235962, 3.3858020305633545, 3.164996385574341, 2.941713809967041, 2.7028141021728516, 3.3222177028656006, 3.18338942527771, 3.328871726989746, 3.2875287532806396, 3.2550535202026367, 3.1948764324188232, 3.1835436820983887, 3.0883805751800537, 3.1897504329681396, 3.0728981494903564, 3.086189031600952, 3.2033181190490723, 3.5445971488952637, 3.4117791652679443, 3.6575748920440674]
training time  [13.629409551620483, 13.676042318344116, 13.025471687316895, 13.4656822681427, 14.279199838638306, 14.093258380889893, 13.517175197601318, 13.496558666229248, 13.486572027206421, 13.295684337615967, 13.478938817977905, 14.135978937149048, 13.73014211654663, 13.56210446357727, 13.488336563110352, 13.287955045700073, 13.26968002319336, 14.176574945449829, 13.374974012374878, 13.312161684036255]
---feature block loading time  [3.57558536529541, 4.568396329879761, 3.802424192428589, 4.196799278259277, 4.297162771224976, 4.188794374465942, 3.8774986267089844, 3.8509774208068848, 3.825587034225464, 3.642024040222168, 3.7147438526153564, 4.0598509311676025, 4.038984537124634, 3.8445496559143066, 3.825421094894409, 3.608598232269287, 3.5401861667633057, 4.085255861282349, 3.6681015491485596, 3.636793851852417]


epoch_time avg   48.05280430614948
loading_time avg   0.832881510257721
 data loader gen time avg 33.5627828091383
	---backpack schedule time avg 0.3225344270467758
	---connection_check_time avg  7.29291196167469
	---block_gen_time avg  3.2320489287376404
training time  13.624080941081047
---feature block loading time  3.8565331250429153
pure train time per /epoch  [10.035356760025024, 9.083083152770996, 9.191819906234741, 9.239262104034424, 9.962598323822021, 9.880980253219604, 9.618257761001587, 9.622283220291138, 9.639275312423706, 9.634159564971924, 9.735345840454102, 10.042844533920288, 9.662668466567993, 9.690223217010498, 9.634902954101562, 9.649812698364258, 9.699068069458008, 10.061354398727417, 9.675839900970459, 9.643559455871582]
pure train time average  9.711319769130034
num_input list  [23053720, 23052935, 23049792, 23048833, 23049260, 23056814, 23059717, 23053365, 23056703, 23054647, 23048601, 23050076, 23051271, 23056754, 23051652, 23058398, 23061765, 23051682, 23052887, 23052383]
num_input  average  23053562.75
