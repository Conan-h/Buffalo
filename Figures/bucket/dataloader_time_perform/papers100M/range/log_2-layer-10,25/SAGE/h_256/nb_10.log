main start at this time 1714073966.5994697
-----------------------------------------before load data 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
# Nodes: 111059956
# Edges: 1615685872
# Train: 1207179
# Val: 125265
# Test: 109727512
# Classes: 172

----------------------------------------start of run function 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([ 31540385,  58940113,  13915461,  ...,  49725274, 105865038,
         13938117]), tensor([24123243, 40441543,  4563033,  ..., 46335028, 71470094, 14479878]), tensor([  4271313,  16900950, 106590984,  ..., 106296810,  33659401,
         71074407]), tensor([ 23561901, 106347241, 106015976,  ...,  13997015,  14334451,
         77929393]), tensor([21221490, 14064346, 68345585,  ..., 32850574, 58515891, 48943142]), tensor([ 51954560,  29746759,  14174970,  ...,  83694796,  14554726,
        105847602]), tensor([57100586, 57745177, 62409926,  ..., 10202396, 42906570, 14973699]), tensor([13864891, 72949064, 79231810,  ..., 14178351, 15731671, 26747682]), tensor([28864207, 35577572, 45822904,  ..., 61989851, 39930325, 67149588]), tensor([ 9346100, 41220411, 12258316,  ..., 42967702, 39722183, 56629538])]
range partition time  0.1485157012939453
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.038817405700683594
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15756726264953613
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 1.22113037109375 GB
    Memory Allocated: 0.003025054931640625  GigaBytes
Max Memory Allocated: 0.003025054931640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.13519287109375 GB
    Memory Allocated: 0.9170875549316406  GigaBytes
Max Memory Allocated: 0.9170875549316406  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 2.13714599609375 GB
    Memory Allocated: 0.9179873466491699  GigaBytes
Max Memory Allocated: 0.9179873466491699  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.19183349609375 GB
    Memory Allocated: 0.9579520225524902  GigaBytes
Max Memory Allocated: 0.9579520225524902  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.72698974609375 GB
    Memory Allocated: 50.76204872131348  GigaBytes
Max Memory Allocated: 52.237956523895264  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 53.72698974609375 GB
    Memory Allocated: 50.83939981460571  GigaBytes
Max Memory Allocated: 52.237956523895264  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 54.79730224609375 GB
    Memory Allocated: 1.0440583229064941  GigaBytes
Max Memory Allocated: 52.237956523895264  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 54.79730224609375 GB
    Memory Allocated: 1.9583888053894043  GigaBytes
Max Memory Allocated: 52.237956523895264  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 54.79730224609375 GB
    Memory Allocated: 1.9592885971069336  GigaBytes
Max Memory Allocated: 52.237956523895264  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.79730224609375 GB
    Memory Allocated: 1.0842394828796387  GigaBytes
Max Memory Allocated: 52.237956523895264  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.18402099609375 GB
    Memory Allocated: 50.69690275192261  GigaBytes
Max Memory Allocated: 52.24488878250122  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 56.18402099609375 GB
    Memory Allocated: 50.774253368377686  GigaBytes
Max Memory Allocated: 52.24488878250122  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 56.18402099609375 GB
    Memory Allocated: 1.07319974899292  GigaBytes
Max Memory Allocated: 52.24488878250122  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 56.18402099609375 GB
    Memory Allocated: 1.98726224899292  GigaBytes
Max Memory Allocated: 52.24488878250122  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 56.18402099609375 GB
    Memory Allocated: 1.9881620407104492  GigaBytes
Max Memory Allocated: 52.24488878250122  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.18402099609375 GB
    Memory Allocated: 1.1128783226013184  GigaBytes
Max Memory Allocated: 52.24488878250122  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 50.751744747161865  GigaBytes
Max Memory Allocated: 52.30624008178711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 50.82909536361694  GigaBytes
Max Memory Allocated: 52.30624008178711  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 1.1016831398010254  GigaBytes
Max Memory Allocated: 52.30624008178711  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 2.016749858856201  GigaBytes
Max Memory Allocated: 52.30624008178711  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 2.0176496505737305  GigaBytes
Max Memory Allocated: 52.30624008178711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 1.1426119804382324  GigaBytes
Max Memory Allocated: 52.30624008178711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 50.78750562667847  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 50.864856243133545  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 1.131303310394287  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 2.0432181358337402  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 2.0441179275512695  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 1.1679844856262207  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 50.69928312301636  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 50.776633739471436  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 1.1576347351074219  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 2.068075656890869  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 2.0689754486083984  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 1.1959776878356934  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 50.64367389678955  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 50.72102451324463  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 1.1850895881652832  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 2.103177070617676  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 2.104076862335205  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 57.56878662109375 GB
    Memory Allocated: 1.2327570915222168  GigaBytes
Max Memory Allocated: 52.34081172943115  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.98870849609375 GB
    Memory Allocated: 50.98956918716431  GigaBytes
Max Memory Allocated: 52.5459041595459  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.98870849609375 GB
    Memory Allocated: 51.066919803619385  GigaBytes
Max Memory Allocated: 52.5459041595459  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 60.98870849609375 GB
    Memory Allocated: 1.2212204933166504  GigaBytes
Max Memory Allocated: 52.5459041595459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.98870849609375 GB
    Memory Allocated: 2.1439709663391113  GigaBytes
Max Memory Allocated: 52.5459041595459  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.98870849609375 GB
    Memory Allocated: 2.1448707580566406  GigaBytes
Max Memory Allocated: 52.5459041595459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.98870849609375 GB
    Memory Allocated: 1.2662267684936523  GigaBytes
Max Memory Allocated: 52.5459041595459  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 51.395009994506836  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 51.472360610961914  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 1.254837989807129  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 2.1708383560180664  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 2.1717381477355957  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 1.2880973815917969  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 51.0881872177124  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 51.16553783416748  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 1.27783203125  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 2.1896095275878906  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 2.19050931930542  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 1.3134956359863281  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 50.92227363586426  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 51.00026082992554  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19185349
----------------------------------------after optimizer
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 1.3714838027954102  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.175512313842773
pure train time :  8.841891288757324
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([43253794, 79058266, 58925171,  ..., 36637426, 67595878, 13980608]), tensor([51527117, 27617903, 46535213,  ...,  9110798, 42953897, 34219131]), tensor([ 65886980,  25122443,  60760136,  ...,  45485614,  64257730,
        106379093]), tensor([14831607, 45954907, 14949204,  ..., 78727713, 26722771, 56339318]), tensor([14632667, 14070540, 15333460,  ..., 18049748, 11039451, 39435485]), tensor([ 53347688,  82339727, 105939047,  ...,  82461106,  76474986,
         53807328]), tensor([ 77919569, 105909520,  35101504,  ...,  29776379,  14256604,
         46351604]), tensor([78455314, 40880844, 59080183,  ..., 14324168, 28790497, 47286776]), tensor([ 21092044, 105795344,  80038846,  ...,  36318224, 105824043,
         81756120]), tensor([ 61870364,  14695122,  65634147,  ..., 106461769,  34131079,
         32428530])]
range partition time  0.14815855026245117
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03436779975891113
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1570606231689453
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 1.0440902709960938  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 1.9597253799438477  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 1.960625171661377  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 1.088120937347412  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 50.65295219421387  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 50.701412200927734  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 1.0518064498901367  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 1.9646825790405273  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 1.9655823707580566  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.97894287109375 GB
    Memory Allocated: 1.0888395309448242  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98284912109375 GB
    Memory Allocated: 50.515015602111816  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.98284912109375 GB
    Memory Allocated: 50.592366218566895  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 73.98284912109375 GB
    Memory Allocated: 1.078061580657959  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.98284912109375 GB
    Memory Allocated: 1.989509105682373  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.98284912109375 GB
    Memory Allocated: 1.9904088973999023  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98284912109375 GB
    Memory Allocated: 1.1164898872375488  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98284912109375 GB
    Memory Allocated: 50.66238498687744  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.98284912109375 GB
    Memory Allocated: 50.73973560333252  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 73.98284912109375 GB
    Memory Allocated: 1.1055026054382324  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.98284912109375 GB
    Memory Allocated: 2.0248003005981445  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.98284912109375 GB
    Memory Allocated: 2.025700092315674  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98284912109375 GB
    Memory Allocated: 1.1534309387207031  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 50.97884750366211  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 51.05619812011719  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 1.142591953277588  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 2.0527219772338867  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 2.053621768951416  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 1.1732382774353027  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 50.73465967178345  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 50.812010288238525  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 1.1624736785888672  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 2.0723586082458496  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 2.073258399963379  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 1.2021245956420898  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 50.77027130126953  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 50.84762191772461  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 1.1902713775634766  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 2.104611396789551  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 2.10551118850708  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 1.2347064018249512  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 50.99146223068237  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 51.06881284713745  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 1.2239012718200684  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 2.141019821166992  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 2.1419196128845215  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98480224609375 GB
    Memory Allocated: 1.2668819427490234  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98675537109375 GB
    Memory Allocated: 51.0940523147583  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 73.98675537109375 GB
    Memory Allocated: 51.17181444168091  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 73.98675537109375 GB
    Memory Allocated: 1.2574591636657715  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 73.98675537109375 GB
    Memory Allocated: 2.1787257194519043  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 73.98675537109375 GB
    Memory Allocated: 2.1796255111694336  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 73.98675537109375 GB
    Memory Allocated: 1.301828384399414  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 51.31448173522949  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 51.39183235168457  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.2913718223571777  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 2.2088613510131836  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 2.209761142730713  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.3276185989379883  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 51.08195972442627  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 51.15931034088135  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19187863
----------------------------------------after optimizer
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.3805732727050781  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.74208927154541
pure train time :  7.73356556892395
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([78587153, 14087121, 32984780,  ..., 60872800, 14800017, 56176658]), tensor([ 44270887,  20505645,   2953390,  ..., 106199688,  25694026,
         44241159]), tensor([57573691,  1309935, 61875615,  ..., 22792725, 56878478, 72039574]), tensor([ 36558527,   4976148, 106611836,  ...,  52868975,  66174456,
         73108109]), tensor([ 54646365,  11283412, 105990971,  ..., 106530006,  19738132,
         55961750]), tensor([69032191, 43878278, 62011371,  ..., 32287185, 57777976, 12738660]), tensor([45698628, 81685667,  9274023,  ..., 77157087, 12121637, 12652980]), tensor([61629840, 47806514, 21469366,  ..., 43257566, 19890274, 51850821]), tensor([14243940, 41365444, 45900966,  ..., 26650045, 14783512, 13409024]), tensor([17746385, 83346933, 80053918,  ..., 16752907, 38544035, 45681083])]
range partition time  0.15213799476623535
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03098130226135254
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16095805168151855
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.04933500289917  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.9606213569641113  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.9615211486816406  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.083444595336914  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 50.68827962875366  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 50.73720693588257  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.0473785400390625  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.9608187675476074  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.9617185592651367  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.0893912315368652  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 50.660887241363525  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 50.7382378578186  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.078455924987793  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.9912810325622559  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.9921808242797852  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.117640495300293  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 50.52084159851074  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 50.59819221496582  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.106985092163086  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 2.0229969024658203  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 2.0238966941833496  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.1502079963684082  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 50.971866607666016  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 51.049217224121094  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.139932632446289  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 2.055662155151367  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 2.0565619468688965  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.179549217224121  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 50.76484966278076  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 50.84220027923584  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.1689519882202148  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 2.08431339263916  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 2.0852131843566895  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.2085552215576172  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 50.845946311950684  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 50.92329692840576  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.19706392288208  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 2.119467258453369  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 2.1203670501708984  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 75.37738037109375 GB
    Memory Allocated: 1.2446722984313965  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 51.26466131210327  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 51.34201192855835  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 1.2330350875854492  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 2.147404670715332  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 2.1483044624328613  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 1.2650680541992188  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 51.02316999435425  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 51.100520610809326  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 1.254422664642334  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 2.165717601776123  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 2.1666173934936523  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 1.291196346282959  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 50.86978340148926  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 50.947134017944336  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 1.2798347473144531  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 2.196575164794922  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 2.197474956512451  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.77386474609375 GB
    Memory Allocated: 1.3253602981567383  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.12281799316406  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.20016860961914  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19187814
----------------------------------------after optimizer
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.3814024925231934  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.530509948730469
pure train time :  7.745588064193726
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([  3222184, 106174431,  51960606,  ...,  24603288,  28779474,
         20391962]), tensor([ 30849109,  50483643,  10672713,  ..., 106171625,  43590301,
         35861248]), tensor([110314254,  81265466, 105961182,  ...,  36245522,   4042835,
          4656971]), tensor([14450609, 47553346, 13900849,  ..., 11597767, 15629349, 16264395]), tensor([106398541,  30903721,  50538824,  ...,  13856118,  56846125,
         37716236]), tensor([38870529, 84671236, 36599874,  ..., 15451458, 46621309, 18681447]), tensor([72527792, 80104010, 10190561,  ..., 43303379, 14361026, 20636929]), tensor([ 37479804,  82018188,   9239977,  ...,  46758028, 105882721,
         45864142]), tensor([ 27690483,  75153043,  17005512,  ...,  36210393, 105992277,
         15316299]), tensor([ 59082659,  75800174,  43456510,  ..., 106483381,  59422343,
         65879226])]
range partition time  0.1545581817626953
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03294229507446289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16489696502685547
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0523719787597656  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9736394882202148  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9745392799377441  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0974559783935547  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.95081663131714  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.99595785140991  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0588812828063965  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9732093811035156  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.974109172821045  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0919561386108398  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.821921825408936  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.899272441864014  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.081296443939209  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9966487884521484  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9975485801696777  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1223406791687012  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.86427402496338  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.94162464141846  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.111079216003418  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0228347778320312  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0237345695495605  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.147407054901123  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.79039525985718  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.867745876312256  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1368951797485352  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0498619079589844  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0507616996765137  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1780357360839844  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.83788442611694  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.91523504257202  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1666436195373535  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0794920921325684  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0803918838500977  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.206425666809082  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.8270149230957  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.90436553955078  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1959342956542969  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.1131272315979004  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.1140270233154297  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.24043607711792  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.164071559906006  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.241422176361084  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.230013370513916  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.144075870513916  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.1449756622314453  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2668137550354004  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.85937023162842  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.936720848083496  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.25529146194458  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.169619560241699  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.1705193519592285  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.295393943786621  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.78604221343994  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.86339282989502  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2838869094848633  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.199563503265381  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.20046329498291  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.3251457214355469  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.9228515625  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.00020217895508  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19188199
----------------------------------------after optimizer
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.3772425651550293  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.29965353012085
pure train time :  7.815518140792847
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([ 14308691,  44207840,  79299051,  ..., 106209877,  65687388,
         10266131]), tensor([ 74662541,  53905019,  60934355,  ...,  25937442,  31238964,
        106237554]), tensor([ 32961609,  15447762, 106438365,  ...,  41915556,  23255423,
         28059984]), tensor([ 69937265,  61072352, 106367061,  ...,  25209433,  51794909,
         14294023]), tensor([ 46501412,  13762177, 106246238,  ..., 105860501, 103417878,
         67421345]), tensor([39970960, 66326411, 16483880,  ..., 21786852, 23508098, 43181015]), tensor([ 65780251,  78964438,  16229055,  ...,  82862366, 105810697,
        106553412]), tensor([ 50034047, 106107154,  79108997,  ..., 105819462,  29257009,
         10764951]), tensor([105839282,  41063702,  14208807,  ...,  35677594, 106509965,
         56582681]), tensor([15429357, 78243620, 27467967,  ..., 44982819, 73161531,  9565010])]
range partition time  0.16640877723693848
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04105854034423828
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.18338656425476074
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.047438144683838  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9532175064086914  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9541172981262207  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0774645805358887  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.41158962249756  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.46060085296631  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.041111946105957  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9573354721069336  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.958235263824463  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0914921760559082  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.73278999328613  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.81014060974121  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0802216529846191  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9926977157592773  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9935975074768066  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1164636611938477  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.86561346054077  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.94296407699585  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.106318473815918  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.021745204925537  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0226449966430664  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.149308204650879  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.83840560913086  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.91575622558594  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1385555267333984  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0529322624206543  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0538320541381836  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.177464485168457  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.84879922866821  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.92614984512329  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1668624877929688  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0809249877929688  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.081824779510498  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2064156532287598  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.70186710357666  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.77994251251221  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1955952644348145  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.1129860877990723  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.1138858795166016  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2389874458312988  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.034156799316406  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.111507415771484  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2282371520996094  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.1471171379089355  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.148016929626465  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2698683738708496  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.1263632774353  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.203715801239014  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.259291648864746  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.173354148864746  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.1742539405822754  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2943778038024902  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.91780662536621  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.99515724182129  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2831807136535645  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.2024941444396973  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.2033939361572266  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.3286118507385254  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.25655269622803  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.333903312683105  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19182264
----------------------------------------after optimizer
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.3817687034606934  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.001487731933594
pure train time :  7.782458543777466
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([ 56370318, 106470269,  76527938,  ...,  25595462, 105797482,
         25103874]), tensor([ 61780722,  11350617,  25922764,  ...,  14714956, 105993018,
         39489426]), tensor([15770604, 38428055, 66245275,  ..., 59801441, 53158133, 59888130]), tensor([105891078,  17720046,  31548473,  ...,  27223810,  22011232,
        105900822]), tensor([  7601077,  13551959, 110850471,  ...,  27242925,  51276965,
         61115555]), tensor([ 22134169,  78705984,  60044713,  ..., 106436854,  15726111,
         57660262]), tensor([11996691, 82248680, 28592246,  ..., 55748487, 14630122,   636072]), tensor([61901011, 14677900, 14873487,  ..., 60116545, 74177600, 26506591]), tensor([ 25315216,  41553807,  12545177,  ...,  34159859, 106291098,
         16556952]), tensor([25676989, 32761065, 35007625,  ..., 38624718, 32088970, 62224278])]
range partition time  0.15307974815368652
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03625750541687012
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16342902183532715
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.052011489868164  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9644293785095215  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9653291702270508  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0849947929382324  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.54931640625  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.59739112854004  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0479216575622559  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9653449058532715  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9662446975708008  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0933942794799805  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.80674457550049  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.884095191955566  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0834660530090332  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9978857040405273  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9987854957580566  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1204032897949219  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.78011178970337  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.85792779922485  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1087369918823242  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0196337699890137  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.020533561706543  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1451549530029297  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.80816173553467  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.885512351989746  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1348648071289062  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0532989501953125  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.054198741912842  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1824383735656738  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.973244190216064  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.05123949050903  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1713972091674805  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0884175300598145  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0893173217773438  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2099494934082031  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.896605014801025  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.97447490692139  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1982064247131348  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.1161041259765625  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.117003917694092  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.239199161529541  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.0778021812439  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.155152797698975  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2278237342834473  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.1421804428100586  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.143080234527588  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2643742561340332  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.090556621551514  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.16790723800659  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2562007904052734  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.172478675842285  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.1733784675598145  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2980437278747559  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.92088222503662  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.9982328414917  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.2868232727050781  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.1992530822753906  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.20015287399292  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.323577880859375  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.96583366394043  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 51.04318380355835  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19192242
----------------------------------------after optimizer
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.3764262199401855  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.737274646759033
pure train time :  7.929218769073486
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([ 10238643,  60043158,  13594554,  ...,  66973902,  59719006,
        106274534]), tensor([ 8764858, 27072038, 21484530,  ..., 48171197, 53064200, 46597294]), tensor([12154108, 14013613, 61146130,  ..., 81534003, 50890811, 33415243]), tensor([ 12107534,  75547188,  28403163,  ...,  44148451,  59171216,
        106606027]), tensor([ 45190256,  77283793, 105825657,  ...,  38385168,  33057090,
         14059101]), tensor([105834153, 106290413, 106387842,  ...,  15239379,  49567522,
         60255772]), tensor([ 15345123, 106310496, 106299018,  ..., 106192284, 106615774,
        106483156]), tensor([73895243, 14771337, 64260253,  ..., 81308319, 77383367, 50268409]), tensor([48640006, 14081589, 25398900,  ..., 13897783,  8664489, 13975750]), tensor([ 81664211,  17204955,  21391354,  ...,  75276541, 106323899,
         35552640])]
range partition time  0.15250873565673828
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029653310775756836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1614055633544922
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0456180572509766  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.963986873626709  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9648866653442383  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.092109203338623  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.929431438446045  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.97701597213745  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0555133819580078  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9714503288269043  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9723501205444336  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0930595397949219  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.79749059677124  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.87484121322632  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.0831489562988281  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.9989242553710938  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.999824047088623  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.122992992401123  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.85280656814575  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 50.93015718460083  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1118841171264648  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.031545639038086  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 2.0324454307556152  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.89886474609375 GB
    Memory Allocated: 1.1559057235717773  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.01710510253906  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.09445571899414  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.144968032836914  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.058473587036133  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.059373378753662  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1788148880004883  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.9048810005188  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.98223161697388  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1675496101379395  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.076693534851074  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0775933265686035  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2029848098754883  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.679391384124756  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.756742000579834  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1916799545288086  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.10711669921875  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1080164909362793  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2379484176635742  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.895684242248535  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.97303485870361  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.226485252380371  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.13950777053833  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1404075622558594  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2639508247375488  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.800715923309326  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.878066539764404  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.253105640411377  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.170660972595215  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.171560764312744  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.297621250152588  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.03105306625366  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.10840368270874  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.286363124847412  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.2001919746398926  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.201091766357422  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.3226022720336914  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.02555561065674  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.10290575027466  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19193142
----------------------------------------after optimizer
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.3751368522644043  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.5103511810302734
pure train time :  8.057193517684937
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([ 37197976,  15186067,  15863810,  ...,  38872310,  24560896,
        106022142]), tensor([30486777, 15327642, 39050870,  ..., 21058579, 20679482, 56104291]), tensor([105904459,  12640432,  13967427,  ...,  14315346,  37312632,
         15596418]), tensor([ 60162581,  28793426,  23257867,  ...,  14828411, 106431545,
         22335990]), tensor([106186317, 106198575,  27133820,  ...,  14063127,  34057148,
         73862124]), tensor([13841499, 83097567, 12947454,  ..., 14830790, 49763526, 43257530]), tensor([83116319, 21946812, 14108161,  ..., 56981858, 76312341, 43123591]), tensor([17095245, 83460960, 35940580,  ..., 29998248, 14682007, 14308813]), tensor([ 56522950,  74410660,  18734234,  ...,  79447380, 106212563,
        106235637]), tensor([21156736, 56564348, 23328860,  ..., 51917044, 36206416, 36746740])]
range partition time  0.15195894241333008
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.028713226318359375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.160797119140625
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0460233688354492  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9616594314575195  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9625592231750488  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.088364601135254  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.94451904296875  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.99309730529785  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0512456893920898  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9683165550231934  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9692163467407227  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0926995277404785  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.815815925598145  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.89316654205322  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.081772804260254  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.995903491973877  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9968032836914062  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1188135147094727  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.83382558822632  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.9111762046814  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1089587211608887  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.023198127746582  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0240979194641113  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1490468978881836  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.843273639678955  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.92062425613403  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1369390487670898  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0518546104431152  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0527544021606445  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1776189804077148  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.89702653884888  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.974377155303955  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1661176681518555  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0836100578308105  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.08450984954834  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.208754539489746  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.987571239471436  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.064921855926514  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1978955268859863  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1159448623657227  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.116844654083252  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.238487720489502  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.07446336746216  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.151813983917236  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2276067733764648  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1388955116271973  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1397953033447266  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.260629653930664  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.67373323440552  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.751083850860596  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2493538856506348  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.160493850708008  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.161393642425537  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.289085865020752  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.92458963394165  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.00194025039673  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2777037620544434  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1917662620544434  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1926660537719727  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.3204841613769531  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.91543006896973  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.992780685424805  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19183384
----------------------------------------after optimizer
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.3733172416687012  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.378851890563965
pure train time :  8.058337688446045
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([13893473, 60786630, 14257922,  ..., 16337122, 22717300, 53828041]), tensor([11209713, 57738192, 15694073,  ..., 18605285, 73804385, 22956166]), tensor([ 38796723,  14169284, 105908784,  ...,  40946698,  32414646,
         57389249]), tensor([ 71878229,  35163093,  25806474,  ..., 106345072,  71923620,
         60016619]), tensor([ 16728584,  35546643, 106248479,  ..., 105886788,  24259698,
         14914742]), tensor([66260895, 56330146, 13852485,  ..., 83431246, 20910779, 73421671]), tensor([ 15937311,  22723470,  81377184,  ...,   4190629,  17418287,
        110312487]), tensor([ 61561991,  46725564,  13897153,  ..., 106068140,    795717,
         14518656]), tensor([82771257, 66203059, 13850336,  ..., 11869755, 25683487, 39852513]), tensor([ 42766808,   3014185,  27841021,  ...,  14859262,  22677344,
        106448208])]
range partition time  0.15744352340698242
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.034076690673828125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16638731956481934
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.046621322631836  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9622101783752441  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9631099700927734  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.088235855102539  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.57639265060425  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.62460660934448  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.05100679397583  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.969985008239746  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9708847999572754  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0943760871887207  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.72678899765015  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.804139614105225  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0833988189697266  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0021791458129883  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0030789375305176  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1232867240905762  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.918437480926514  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.99578809738159  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1148266792297363  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.028933048248291  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0298328399658203  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.15006685256958  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.79124402999878  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.86859464645386  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1390938758850098  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.056217670440674  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.057117462158203  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1822152137756348  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.97771453857422  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.0550651550293  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1710491180419922  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0795445442199707  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0804443359375  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2021937370300293  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.664236545562744  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.74158716201782  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1936535835266113  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.109804630279541  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1107044219970703  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2413530349731445  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.02311134338379  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.10046195983887  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2301177978515625  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.142256736755371  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1431565284729004  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.266134262084961  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.07345914840698  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.15080976486206  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2549142837524414  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1689276695251465  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.169827461242676  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2967066764831543  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.97666025161743  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.05401086807251  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2854886054992676  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.200859546661377  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.2017593383789062  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.326878547668457  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.120118618011475  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.19746923446655  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19190508
----------------------------------------after optimizer
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.379460334777832  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.291365623474121
pure train time :  8.068834781646729
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([ 11094903,  78446459, 106186120,  ...,  82419054,  51082830,
         16239755]), tensor([ 37560655,  18063721, 105991454,  ..., 108729350,  16433055,
          9719613]), tensor([  9131645,  56078636,  50601925,  ...,  35336507, 105982040,
         13888287]), tensor([106483640,  54088826,  78911627,  ...,  13463393, 106185328,
        101241615]), tensor([27234401, 46861100, 51913954,  ...,  7128607, 76928789, 13896506]), tensor([25030243, 16595187, 35176173,  ..., 14676690, 39979509, 51881120]), tensor([ 18023939,  35170690, 106283302,  ..., 106322908,  45008118,
        106237059]), tensor([ 32600379,  42430098,  38490288,  ..., 105845487,  14844295,
         48336637]), tensor([105828977,  40670111,  14916410,  ...,  49757106,  28503323,
        106601697]), tensor([106544973,  81952100,  23196172,  ...,  14544278,  71301600,
         18899334])]
range partition time  0.15501880645751953
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02971053123474121
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1639397144317627
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0476183891296387  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9573698043823242  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9582695960998535  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.081984043121338  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.52909755706787  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.57762289047241  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.045969009399414  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9614248275756836  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.962324619293213  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0916190147399902  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.717740058898926  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.795090675354004  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0814805030822754  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9989962577819824  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9998960494995117  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1235594749450684  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.852952003479004  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.93030261993408  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1123690605163574  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.03122615814209  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.032125949859619  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.153773307800293  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.96180295944214  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.03915357589722  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1449956893920898  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0576672554016113  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0585670471191406  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1787452697753906  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.84149980545044  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.91885042190552  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.167555809020996  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0903282165527344  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0912280082702637  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.217822551727295  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.097716331481934  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.17506694793701  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2071552276611328  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.117062568664551  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.11796236038208  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2341079711914062  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.7478289604187  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.82517957687378  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.222726821899414  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1377053260803223  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1386051177978516  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2677617073059082  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.95379114151001  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.03114175796509  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2563753128051758  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1713786125183105  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.17227840423584  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.29638671875  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.993956089019775  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.07130670547485  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2860016822814941  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.197782039642334  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1986818313598633  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.3227272033691406  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.04677438735962  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.12495279312134  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19186201
----------------------------------------after optimizer
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.3743338584899902  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0937280654907227
pure train time :  8.06368350982666
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([ 16730411,  13848112,  54324137,  ..., 106609182,  39163463,
        106258837]), tensor([  9741961,  80943277,  54457245,  ...,  41570717, 105965802,
         49928798]), tensor([25010552, 32479012,  9775739,  ..., 27448207, 81693415, 25553324]), tensor([ 21697284,   3174319, 105899483,  ...,  37192070,  19595862,
         44121052]), tensor([  9975706, 106311779, 106472930,  ...,  10061331,  78647903,
         81109542]), tensor([ 21802581,  66230224, 106089864,  ...,  24061052,  24722917,
         56324765]), tensor([ 65278829,  66233417,  33074005,  ..., 106623347,  50410034,
         41646528]), tensor([45913379, 36790685, 47461842,  ..., 22928127, 72353627, 44535182]), tensor([ 15165098,   8379935, 106589056,  ...,  18611762,  14101260,
         50401854]), tensor([ 28914748,   9953713, 106118612,  ...,  20879653,  20827682,
         21931480])]
range partition time  0.15322494506835938
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02968120574951172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1622464656829834
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0439090728759766  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9592628479003906  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.96016263961792  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0880069732666016  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.89165115356445  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.94029521942139  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0516643524169922  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.963395118713379  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9642949104309082  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0879316329956055  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.69841766357422  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.7757682800293  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0774965286254883  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9949455261230469  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9958453178405762  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1232452392578125  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.85966491699219  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.937015533447266  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.112717628479004  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.02694034576416  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0278401374816895  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1495304107666016  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.86129713058472  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.938647747039795  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1381769180297852  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0530924797058105  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.05399227142334  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1795082092285156  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.8225302696228  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.89988088607788  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1682782173156738  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0831732749938965  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.084073066711426  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2083206176757812  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.05884504318237  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.13619565963745  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1973495483398438  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.113616466522217  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.114516258239746  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.238633632659912  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.85001468658447  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.92736530303955  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2273306846618652  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1386666297912598  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.139566421508789  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2622013092041016  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.76434898376465  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.84169960021973  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2516708374023438  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.162120819091797  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.163020610809326  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.290597915649414  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.7666392326355  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.843989849090576  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2791681289672852  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1989192962646484  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1998190879821777  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.3286018371582031  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.211541175842285  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.28889179229736  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19181330
----------------------------------------after optimizer
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.381396770477295  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9691054821014404
pure train time :  8.207061290740967
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([82569597, 49085316, 14883925,  ..., 27765372, 80282748, 41978602]), tensor([ 20709696, 109579505,  13973370,  ...,  39962700, 106012852,
         42345020]), tensor([ 34817897,  51793342,  57149677,  ...,  14390635,  12022314,
        106536888]), tensor([105973205, 106350186,  42464319,  ...,  47976581,  80028900,
         30940646]), tensor([ 14166578,   8644209, 106415259,  ...,  46042072,  81060778,
         24350880]), tensor([73794353, 54493385, 33517458,  ..., 38783463, 41685612, 32733562]), tensor([ 75937698,  20988318,  50060956,  ...,  41704235,  24485142,
        106177321]), tensor([ 14471542,  56935418,  53970319,  ..., 106320725,   9668813,
         72890048]), tensor([110551083,  23624301, 106334850,  ...,  77026471,  53556276,
         15107404]), tensor([ 24221136,  50820603,  47549524,  ..., 105939304, 106203707,
         46305237])]
range partition time  0.15829896926879883
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.043764591217041016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16875314712524414
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0520968437194824  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9697556495666504  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9706554412841797  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0904488563537598  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.81481742858887  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.86324453353882  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0544490814208984  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9685115814208984  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9694113731384277  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.091752052307129  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.824360847473145  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.90171146392822  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.081064224243164  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0014095306396484  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0023093223571777  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.127446174621582  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.9532527923584  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.03060340881348  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1159954071044922  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.030989170074463  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.031888961791992  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1505885124206543  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.82648944854736  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.90384006500244  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1392426490783691  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.060666084289551  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.06156587600708  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.185849666595459  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.1045355796814  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.181886196136475  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.174703598022461  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.086231231689453  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0871310234069824  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2046914100646973  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.7638373374939  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.841187953948975  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.193225383758545  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.111257553100586  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1121573448181152  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2397336959838867  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.92742919921875  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.00477981567383  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2282624244689941  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.136012554168701  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1369123458862305  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2577238082885742  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.62297582626343  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.700326442718506  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2479467391967773  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1580958366394043  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1589956283569336  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2902569770812988  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.94500684738159  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.02235746383667  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.279008388519287  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1921792030334473  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1930789947509766  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.3218622207641602  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.78622579574585  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.86357593536377  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19186207
----------------------------------------after optimizer
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.3743300437927246  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8748552799224854
pure train time :  8.136885166168213
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([ 12117602, 105899447,  33154818,  ...,  15494732,  49995646,
         13952437]), tensor([ 24093863,  19396221,  11235921,  ..., 105982581,  32893128,
        106126185]), tensor([ 50507585,  21128238,  83664470,  ..., 106065975,  14375521,
         14306276]), tensor([50546316, 59137342, 12309849,  ..., 38138169, 10307095, 25442350]), tensor([ 12494975,  57936287,  46825861,  ..., 106470836, 106390624,
         40055427]), tensor([ 65790414, 106118610,  53352654,  ...,  15968961,  47266485,
        105955579]), tensor([ 6888737, 15615394, 24012236,  ..., 38981419, 15345649, 44860931]), tensor([ 10785759,  22774399,  17040323,  ...,  65788996, 106374199,
        106061949]), tensor([ 20513966,  79815136,  37578032,  ...,  56535718, 106547678,
        105897621]), tensor([13056394, 64307066, 16598764,  ..., 14200294, 49573753, 49608404])]
range partition time  0.15622401237487793
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.034769296646118164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16538357734680176
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0453906059265137  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9594531059265137  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.960352897644043  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0867180824279785  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.80943298339844  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.857985973358154  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0510540008544922  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9736223220825195  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9745221138000488  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.099675178527832  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.958927154541016  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.03716993331909  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0881075859069824  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0021700859069824  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0030698776245117  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.119509220123291  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.76935291290283  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.84670352935791  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.108144760131836  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0259108543395996  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.026810646057129  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.151909351348877  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.93997383117676  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.017324447631836  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.140645980834961  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.055041790008545  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.055941581726074  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.177210807800293  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.863301277160645  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.94065189361572  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1665892601013184  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0772461891174316  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.078145980834961  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2026548385620117  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.665324211120605  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.742674827575684  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1914434432983398  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1040802001953125  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.104979991912842  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2334165573120117  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.98933935165405  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.06668996810913  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2222070693969727  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1418466567993164  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1427464485168457  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2692346572875977  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.98845434188843  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.065804958343506  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2581276893615723  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.168332099914551  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.16923189163208  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.288599967956543  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.90122318267822  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.9785737991333  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2777929306030273  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1922879219055176  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.193187713623047  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.322007179260254  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.985520362854004  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.062870502471924  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19186552
----------------------------------------after optimizer
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.374267578125  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.758197546005249
pure train time :  8.196757555007935
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([25250834, 17519948, 55782451,  ..., 54221599, 10525732, 36908510]), tensor([81126503, 53697997, 38813333,  ..., 71439719, 14380979, 19822427]), tensor([ 47584088, 106588901,  56562754,  ...,  14603235,  53882532,
         32813447]), tensor([41074574,   408321, 32505636,  ..., 50516210, 42711053, 78983754]), tensor([ 21757838,  34017488,  25052559,  ..., 106131628,  23852836,
         45198286]), tensor([47930598, 60216448, 30884166,  ..., 83526111,  9308912, 42811231]), tensor([36892610, 74642845, 34392944,  ..., 14388995, 34726308, 36390483]), tensor([  8775167,  22625230,  82835711,  ..., 106588379,  29384004,
         24342889]), tensor([76570229, 34201836, 41338410,  ..., 59571551, 74651743, 52631784]), tensor([ 46453557, 106384903,  48433180,  ...,  44701331,  79191429,
         62458106])]
range partition time  0.1531054973602295
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03128337860107422
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16219282150268555
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.046463966369629  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9651517868041992  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9660515785217285  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0912299156188965  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.9517936706543  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.00059747695923  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0548977851867676  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9726629257202148  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9735627174377441  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0940427780151367  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.88566875457764  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.963019371032715  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0836315155029297  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9962611198425293  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9971609115600586  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1184148788452148  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.6878137588501  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.765164375305176  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1075868606567383  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0212888717651367  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.022188663482666  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1485919952392578  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.71094799041748  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.78829860687256  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.137519359588623  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.051581859588623  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0524816513061523  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.177812099456787  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.79676103591919  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.87411165237427  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1663846969604492  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0822501182556152  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0831499099731445  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2080883979797363  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.82010221481323  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.89745283126831  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.196753978729248  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.116426944732666  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1173267364501953  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2406415939331055  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.021464824676514  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.09881544113159  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2293510437011719  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.140044689178467  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.140944480895996  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.260216236114502  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.83248710632324  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.90983772277832  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2487616539001465  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.166285514831543  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1671853065490723  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2956366539001465  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.11605215072632  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.1934027671814  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.284226417541504  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1941232681274414  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1950230598449707  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.3164715766906738  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.83350467681885  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.910855293273926  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19189439
----------------------------------------after optimizer
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.3689041137695312  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.68284010887146
pure train time :  8.088299751281738
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([ 81184467, 106097425,  28512274,  ..., 106087249,  51653266,
         81153062]), tensor([65089595, 41457810, 21463214,  ..., 17398569, 43059751, 12262464]), tensor([51702517, 62362006, 14284946,  ...,  8680016, 24622957, 52900487]), tensor([ 41357275,  25493868,  77511517,  ...,  32144671,  14473861,
        106607114]), tensor([56729347, 71031532,  9414636,  ..., 14494308,  3245911, 78405077]), tensor([ 11392826, 106391368,  79649966,  ..., 106078305,  77111340,
          9162556]), tensor([106015075,  72780906,  40085262,  ...,  35220875,  62006330,
        106428987]), tensor([ 33825517, 105980232, 106064704,  ...,  13661382,  80040660,
         37600482]), tensor([47833949, 14233747, 29770902,  ..., 36614637, 17005729, 25096093]), tensor([12090335, 14213693, 50542326,  ..., 40851056, 78214394, 18752750])]
range partition time  0.15260648727416992
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.031141996383666992
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16169428825378418
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0421085357666016  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9511451721191406  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.95204496383667  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0813145637512207  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.60824728012085  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.656808376312256  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0446829795837402  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9567852020263672  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9576849937438965  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0876426696777344  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.70755386352539  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.78490447998047  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.0772747993469238  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.990889549255371  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.9917893409729004  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.118696689605713  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.737308502197266  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.814659118652344  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1081771850585938  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0249547958374023  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0258545875549316  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1513190269470215  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.84259748458862  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.9199481010437  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1402006149291992  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0544333457946777  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.055333137512207  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.177537441253662  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.79869508743286  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.87604570388794  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.1663742065429688  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.0822815895080566  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.083181381225586  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2081432342529297  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.99060010910034  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.06795072555542  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2003326416015625  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1156325340270996  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.116532325744629  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2397432327270508  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.99936056137085  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 51.07671117782593  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.228513240814209  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1435885429382324  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.1444883346557617  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2682671546936035  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.91943645477295  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 50.99678707122803  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.2574763298034668  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.17671537399292  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 2.177615165710449  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.93988037109375 GB
    Memory Allocated: 1.3017868995666504  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.50433349609375 GB
    Memory Allocated: 51.186036109924316  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 78.50433349609375 GB
    Memory Allocated: 51.263386726379395  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2919716835021973  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.2091145515441895  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.2100143432617188  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.329810619354248  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.91910696029663  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.99645709991455  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19185645
----------------------------------------after optimizer
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.3822040557861328  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6323540210723877
pure train time :  8.365422010421753
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([16315915, 16923064, 56154485,  ..., 80002564, 14515038, 29278972]), tensor([ 44799884,  19880852,   1735323,  ..., 106431266,  29691025,
          7005089]), tensor([ 13784303, 106065324,  26517006,  ...,  59138929,  14389282,
         14138675]), tensor([65975409, 11395299,  8681650,  ..., 40837961, 33527686, 19817579]), tensor([105832501,  50899871,  40959675,  ...,  43681445,  80075366,
         15916788]), tensor([ 47613026,  13905520,  13246426,  ...,  77580780,  26250968,
        105833438]), tensor([67569272, 32041939, 35818416,  ..., 20330397, 13997080, 17418319]), tensor([ 32620538,  45508831,  35379316,  ...,  82114188,  37167490,
        105896106]), tensor([23355341, 51676029, 14944361,  ..., 68634483, 75482121, 15760760]), tensor([68484383, 13209772, 74026923,  ..., 11192675, 47094662, 59033447])]
range partition time  0.15223169326782227
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03338432312011719
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.163252592086792
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.0491628646850586  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9616222381591797  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.962522029876709  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.0849113464355469  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.79705619812012  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.84580898284912  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.049058437347412  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9597487449645996  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.960648536682129  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.0871567726135254  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.61198091506958  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.690112590789795  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.076035499572754  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9928836822509766  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9937834739685059  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1222991943359375  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.92774200439453  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.00509262084961  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1108722686767578  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.0229010581970215  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.023800849914551  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1459264755249023  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.67882013320923  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.75617074966431  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1352567672729492  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.0492444038391113  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.0501441955566406  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1772146224975586  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.9217643737793  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.999114990234375  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.165999412536621  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.0789504051208496  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.079850196838379  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2048254013061523  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.73306131362915  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.81041193008423  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1937761306762695  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.1122899055480957  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.113189697265625  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2394819259643555  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.11546182632446  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.19281244277954  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2300472259521484  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.1470422744750977  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.147942066192627  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2685093879699707  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.96556329727173  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.04291391372681  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2576017379760742  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.1756491661071777  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.176548957824707  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2986350059509277  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.04536962509155  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.12272024154663  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2873754501342773  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.2050561904907227  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.205955982208252  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.3270163536071777  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.06783437728882  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.14518451690674  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19189365
----------------------------------------after optimizer
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.3795852661132812  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5785984992980957
pure train time :  8.36638855934143
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([ 8914233,  9188027, 33003210,  ..., 14156869, 39213487, 47497921]), tensor([62030224, 14727934, 19812795,  ..., 83710696, 26453665, 14045998]), tensor([52256065, 77816197, 50688444,  ..., 25628795, 36581441, 41911864]), tensor([61570133,  4601014, 24172411,  ..., 75522508, 42281762, 61159854]), tensor([ 15697376,  12781039,  23427741,  ...,  16317920,  44124957,
        106297860]), tensor([19496748, 82059836, 39337192,  ..., 62050205, 28580086, 29355791]), tensor([41962493, 28463000, 28236454,  ..., 19707832, 12500354, 57062729]), tensor([  8751100,   4882233,  45376745,  ...,  22607977,  79189686,
        105860991]), tensor([84494050, 14360171, 38187959,  ..., 53830256, 10144307, 36567650]), tensor([ 4475113, 76155330, 16498736,  ..., 79648821, 25693854, 81276739])]
range partition time  0.15218186378479004
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030952930450439453
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16125226020812988
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.0498619079589844  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9601531028747559  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9610528945922852  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.0822834968566895  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.53041744232178  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.57900905609131  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.0457987785339355  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9613118171691895  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9622116088867188  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.0909185409545898  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.69754886627197  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.77489948272705  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.0807628631591797  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9954252243041992  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9963250160217285  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1199169158935547  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.86578369140625  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.94313430786133  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1091680526733398  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.023697853088379  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.024597644805908  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1491203308105469  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.992926597595215  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.07027721405029  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1382741928100586  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.058389186859131  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.05928897857666  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1839251518249512  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.94051456451416  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.01786518096924  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1725807189941406  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.0938377380371094  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.0947375297546387  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2138714790344238  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.06915235519409  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.14650297164917  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.202958583831787  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.113945484161377  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.1148452758789062  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2326607704162598  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.93064498901367  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.00799560546875  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2212743759155273  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.1353249549865723  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.1362247467041016  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.264148235321045  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.71388244628906  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.79123306274414  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2534866333007812  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.168541431427002  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.1694412231445312  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2944507598876953  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.99364471435547  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.07099533081055  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.283278465270996  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.1995134353637695  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.200413227081299  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.3245158195495605  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.14027690887451  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.21762752532959  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19194594
----------------------------------------after optimizer
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.3771257400512695  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.495365619659424
pure train time :  8.07076644897461
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([ 41967257,  49462136,  56101906,  ..., 106598585, 106533467,
         32493417]), tensor([ 76257723, 106248010, 106119730,  ...,  15677508,  39661390,
          9859012]), tensor([67461121, 43509857, 39211743,  ..., 62903957, 42130969, 82052644]), tensor([13156944,  9389427, 15011901,  ..., 18481084, 83298719, 35277213]), tensor([ 82452884,  36486168, 106053396,  ...,  18748581,  54615534,
         22470986]), tensor([ 37342631,  32616048,  39661951,  ..., 105865058,  14029709,
         29134124]), tensor([56345003, 26865902, 31988957,  ..., 48023645, 82772473, 16512305]), tensor([ 66439162,  67536957,   9029482,  ...,  77016840, 105898712,
         12127108]), tensor([37863973, 28007288, 41408549,  ..., 79280844, 70861576, 77161735]), tensor([ 15593208,  74539538, 105954929,  ...,  45108412,  74847897,
        107520491])]
range partition time  0.17260456085205078
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03542041778564453
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.18169164657592773
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.0484709739685059  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9608807563781738  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9617805480957031  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.084540843963623  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.68535757064819  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.73389434814453  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.0478882789611816  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9606990814208984  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9615988731384277  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.0886802673339844  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.7204155921936  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.79776620864868  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.0782127380371094  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.9903488159179688  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.991248607635498  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1174216270446777  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.677884101867676  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.755234718322754  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1065220832824707  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.020568370819092  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.021468162536621  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.148545742034912  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.998223304748535  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.07557392120361  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1403131484985352  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.059682846069336  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.0605826377868652  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.185715675354004  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.978482246398926  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.055832862854004  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1743507385253906  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.0884132385253906  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.08931303024292  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2089385986328125  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.77227210998535  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.84962272644043  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.1984195709228516  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.116487979888916  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.1173877716064453  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2425446510314941  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.13474750518799  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.212098121643066  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2336392402648926  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.152026653289795  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.152926445007324  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.27398681640625  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.05519914627075  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 51.13254976272583  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.263038158416748  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.1758909225463867  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.176790714263916  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.297372817993164  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.836955070495605  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 50.914305686950684  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.2862505912780762  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.201812744140625  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 2.2027125358581543  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57464599609375 GB
    Memory Allocated: 1.3289332389831543  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.99452257156372  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 51.07187271118164  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19186481
----------------------------------------after optimizer
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.3812217712402344  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4425318241119385
pure train time :  8.0542573928833
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([35687448, 75457426, 50555649,  ..., 66461656, 13899167, 48580488]), tensor([106145566,  16332879, 106186646,  ..., 105860479,  39157176,
         31761978]), tensor([ 80429292,  47159984,  40881909,  ...,  13935466, 105820880,
         29315111]), tensor([ 14920544, 106032334,  49923663,  ...,  41772577,  19153595,
        106513446]), tensor([106283479,  78791165,  50791632,  ...,  30233285,  78739287,
        106180137]), tensor([ 28871204,  53409201,      9519,  ..., 106003261,  16815822,
         68392908]), tensor([110651947,  65779758,  24804983,  ...,  16879515,  25599148,
        105993296]), tensor([22619661, 57050088, 17075570,  ..., 49343985, 32850420,  8854253]), tensor([76826513, 58022374, 45789197,  ..., 42277015, 46523708, 26641597]), tensor([106124305,  75864254,  82183478,  ...,  70009683,  47395889,
         56094111])]
range partition time  0.15604043006896973
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03759193420410156
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16642355918884277
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.047515869140625  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.9593749046325684  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.9602746963500977  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.083953857421875  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.66309309005737  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.71191215515137  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.047518253326416  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.9631905555725098  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.964090347290039  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.0913372039794922  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.82987356185913  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.90722417831421  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.080892562866211  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.9966301918029785  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.9975299835205078  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.121049404144287  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.94369983673096  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 51.021050453186035  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.1114616394042969  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.024508476257324  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.0254082679748535  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.1486916542053223  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.7875542640686  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.86490488052368  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.1375393867492676  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.054530143737793  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.0554299354553223  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.1813921928405762  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.7647500038147  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.842100620269775  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.1705870628356934  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.090665817260742  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.0915656089782715  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.2136693000793457  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.909667015075684  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.98701763153076  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.2021522521972656  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.114267349243164  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.1151671409606934  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.234095573425293  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.85119342803955  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.92854404449463  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.2226223945617676  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.136019706726074  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.1369194984436035  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.2638311386108398  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.88031768798828  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.95766830444336  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.2522740364074707  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.166490077972412  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.1673898696899414  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.293105125427246  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 51.04818677902222  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 51.125537395477295  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.2819108963012695  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.1971006393432617  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.198000431060791  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.3228569030761719  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 51.05392551422119  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 51.13127613067627  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19185383
----------------------------------------after optimizer
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.3753418922424316  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.406512498855591
pure train time :  8.075273990631104
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
batches_nid_list  [tensor([ 77154999,  13139475,  67598111,  ...,  18511560, 105885196,
         20717740]), tensor([ 31553199, 106080924,  23317767,  ...,  38967370, 106339911,
         52163169]), tensor([30644090, 10130179, 54250621,  ..., 48940857, 62299131, 48323198]), tensor([29374266, 13946480, 12661753,  ..., 56892037, 16783578, 75013854]), tensor([ 60131529,  15744467, 106103075,  ...,  50218977,  12552862,
          1633548]), tensor([ 80808114,  42535789,  70756732,  ...,  58327089,  82886041,
        106012464]), tensor([106176911,  31780351,  53673429,  ...,  32397994, 106015400,
         57854350]), tensor([ 16635571,  82238571,  14134635,  ..., 106549030,  43002175,
         10446346]), tensor([ 38191561,   5851161,  29467760,  ...,  16929278,  10607815,
        105874228]), tensor([106447135,  11342328, 106191819,  ...,  46234025,  17024539,
         51999631])]
range partition time  0.15344452857971191
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.033132076263427734
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1623227596282959
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.0473556518554688  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.9629096984863281  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.9638094902038574  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.0882148742675781  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.86521673202515  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.91477298736572  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.0531091690063477  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.9691834449768066  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.970083236694336  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.0937199592590332  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.918596267700195  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.99642896652222  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.0827374458312988  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.9967999458312988  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.9976997375488281  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.120600700378418  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.67334175109863  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.75069236755371  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.1096820831298828  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.022512912750244  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.0234127044677734  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.148338794708252  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.729355335235596  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.806705951690674  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.1371779441833496  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.0548572540283203  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.0557570457458496  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.1820712089538574  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.936097145080566  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 51.013447761535645  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.1705975532531738  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.084829330444336  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.0857291221618652  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.2069830894470215  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.69545269012451  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.77280330657959  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.1957736015319824  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.112422466278076  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.1133222579956055  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.2383060455322266  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 51.06227922439575  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 51.13962984085083  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.226884365081787  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.1433987617492676  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.144298553466797  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.2668108940124512  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 51.07874298095703  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 51.15609359741211  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.2555699348449707  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.167062282562256  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.167962074279785  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.2904729843139648  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.92728233337402  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 51.0046329498291  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.2794556617736816  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.192389488220215  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 2.193289279937744  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.3209633827209473  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.8404107093811  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 50.91776132583618  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

number of input  19184722
----------------------------------------after optimizer
 Nvidia-smi: 79.57659912109375 GB
    Memory Allocated: 1.3736348152160645  GigaBytes
Max Memory Allocated: 52.96920442581177  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.346792459487915
pure train time :  8.083476781845093
epoch_time_list  [44.48474311828613, 43.40291905403137, 43.32207155227661, 45.23026132583618, 43.31152009963989, 43.590248346328735, 43.49598526954651, 47.73605966567993, 43.1242036819458, 42.95213532447815, 43.90361714363098, 44.49152612686157, 43.97704839706421, 43.19612503051758, 43.84102463722229, 43.82264828681946, 44.189189434051514, 43.34338045120239, 43.0535454750061, 42.908222675323486]

loading_time list   [0.8652434349060059, 0.9094388484954834, 0.8265230655670166, 0.840667724609375, 0.974940299987793, 0.9153573513031006, 0.9348280429840088, 0.8990843296051025, 0.8617923259735107, 0.8503320217132568, 0.835186243057251, 1.1425015926361084, 1.1020843982696533, 1.0579955577850342, 0.8556275367736816, 1.0180740356445312, 1.0603957176208496, 0.8232977390289307, 0.8481559753417969, 0.8626224994659424]

 data loader gen time  30.831035375595093
	---backpack schedule time  [0.33417391777038574, 0.3246879577636719, 0.32152795791625977, 0.3282756805419922, 0.36666083335876465, 0.3293795585632324, 0.3185305595397949, 0.31989502906799316, 0.3310701847076416, 0.32001590728759766, 0.3188636302947998, 0.34398984909057617, 0.3283071517944336, 0.3207685947418213, 0.3195662498474121, 0.3288428783416748, 0.317582368850708, 0.3426668643951416, 0.342026948928833, 0.320742130279541]
	---connection_check_time_list  [5.964069843292236, 5.7559099197387695, 5.760267496109009, 7.802018165588379, 5.977788925170898, 5.842151641845703, 5.891371488571167, 10.0941641330719, 5.492500305175781, 5.387195825576782, 6.232545375823975, 6.643144369125366, 5.700396299362183, 5.6444549560546875, 5.423846006393433, 5.658504247665405, 6.406048536300659, 6.182642698287964, 5.642603397369385, 5.347006320953369]
	---block_gen_time_list  [2.9760491847991943, 2.786949872970581, 2.783242702484131, 2.7275521755218506, 2.7291836738586426, 2.6552703380584717, 2.6853737831115723, 2.6541073322296143, 2.6013150215148926, 2.426640272140503, 2.654895067214966, 2.8055741786956787, 2.7765121459960938, 2.7323572635650635, 3.133613348007202, 2.772930145263672, 3.035949230194092, 2.6996262073516846, 2.7309460639953613, 2.731104850769043]
training time  [12.065627098083496, 11.308301448822021, 11.101698160171509, 10.78777527809143, 10.758317947387695, 11.421324491500854, 11.238779067993164, 11.112867593765259, 11.377501964569092, 11.364572525024414, 11.27846074104309, 11.187751531600952, 11.501490592956543, 11.118641138076782, 11.635480642318726, 11.682265758514404, 10.947633981704712, 10.916129112243652, 10.963502407073975, 11.194671154022217]
---feature block loading time  [3.213104486465454, 3.5581960678100586, 3.340639352798462, 2.9560916423797607, 2.9609110355377197, 3.4763360023498535, 3.1659655570983887, 3.038938045501709, 3.2924814224243164, 3.2847537994384766, 3.054089307785034, 3.0352425575256348, 3.2872300148010254, 3.015242099761963, 3.251295804977417, 3.297755718231201, 2.8612093925476074, 2.843693733215332, 2.872864007949829, 3.0946104526519775]


epoch_time avg   43.80853000283241
loading_time avg   0.9401422291994095
 data loader gen time avg 31.61766493320465
	---backpack schedule time avg 0.32930679619312286
	---connection_check_time avg  6.097897782921791
	---block_gen_time avg  2.7390874326229095
training time  11.23121191561222
---feature block loading time  3.114538684487343
pure train time per /epoch  [8.841891288757324, 7.73356556892395, 7.745588064193726, 7.815518140792847, 7.782458543777466, 7.929218769073486, 8.057193517684937, 8.058337688446045, 8.068834781646729, 8.06368350982666, 8.207061290740967, 8.136885166168213, 8.196757555007935, 8.088299751281738, 8.365422010421753, 8.36638855934143, 8.07076644897461, 8.0542573928833, 8.075273990631104, 8.083476781845093]
pure train time average  8.083519641090842
num_input list  [19185349, 19187863, 19187814, 19188199, 19182264, 19192242, 19193142, 19183384, 19190508, 19186201, 19181330, 19186207, 19186552, 19189439, 19185645, 19189365, 19194594, 19186481, 19185383, 19184722]
num_input  average  19187334.2
