main start at this time 1714075132.3552456
-----------------------------------------before load data 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
# Nodes: 111059956
# Edges: 1615685872
# Train: 1207179
# Val: 125265
# Test: 109727512
# Classes: 172

----------------------------------------start of run function 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.14683294296264648
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.042525529861450195
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16275453567504883
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 1.22113037109375 GB
    Memory Allocated: 0.003025054931640625  GigaBytes
Max Memory Allocated: 0.003025054931640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.24847412109375 GB
    Memory Allocated: 1.0303688049316406  GigaBytes
Max Memory Allocated: 1.0303688049316406  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 2.26800537109375 GB
    Memory Allocated: 1.0314931869506836  GigaBytes
Max Memory Allocated: 1.0314931869506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.30706787109375 GB
    Memory Allocated: 1.0785937309265137  GigaBytes
Max Memory Allocated: 1.0785937309265137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.58831787109375 GB
    Memory Allocated: 60.18881177902222  GigaBytes
Max Memory Allocated: 62.03206157684326  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.58831787109375 GB
    Memory Allocated: 60.28550100326538  GigaBytes
Max Memory Allocated: 62.03206157684326  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 64.92230224609375 GB
    Memory Allocated: 1.1834521293640137  GigaBytes
Max Memory Allocated: 62.03206157684326  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.92230224609375 GB
    Memory Allocated: 2.2130236625671387  GigaBytes
Max Memory Allocated: 62.03206157684326  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.92230224609375 GB
    Memory Allocated: 2.2144246101379395  GigaBytes
Max Memory Allocated: 62.03206157684326  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.92230224609375 GB
    Memory Allocated: 1.233649730682373  GigaBytes
Max Memory Allocated: 62.03206157684326  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.87542724609375 GB
    Memory Allocated: 60.30484676361084  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.87542724609375 GB
    Memory Allocated: 60.401535511016846  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 65.20745849609375 GB
    Memory Allocated: 1.2223033905029297  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.20745849609375 GB
    Memory Allocated: 2.2499876022338867  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.20745849609375 GB
    Memory Allocated: 2.2511119842529297  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.20745849609375 GB
    Memory Allocated: 1.2671623229980469  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 60.21015644073486  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 60.30684518814087  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 1.25581693649292  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 2.281813144683838  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 2.2830328941345215  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 1.301135540008545  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 60.170907497406006  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 60.26759624481201  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 1.2901525497436523  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 2.3153843879699707  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 2.3165087699890137  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 1.336270809173584  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 60.256675720214844  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 60.35336446762085  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 1.3246192932128906  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 2.358552932739258  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 2.3597726821899414  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.89105224609375 GB
    Memory Allocated: 1.3806614875793457  GigaBytes
Max Memory Allocated: 62.2470006942749  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.09222412109375 GB
    Memory Allocated: 60.65407848358154  GigaBytes
Max Memory Allocated: 62.60867357254028  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.09222412109375 GB
    Memory Allocated: 60.75076723098755  GigaBytes
Max Memory Allocated: 62.60867357254028  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 65.42816162109375 GB
    Memory Allocated: 1.3703422546386719  GigaBytes
Max Memory Allocated: 62.60867357254028  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.42816162109375 GB
    Memory Allocated: 2.4021658897399902  GigaBytes
Max Memory Allocated: 62.60867357254028  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.42816162109375 GB
    Memory Allocated: 2.403290271759033  GigaBytes
Max Memory Allocated: 62.60867357254028  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.42816162109375 GB
    Memory Allocated: 1.415412425994873  GigaBytes
Max Memory Allocated: 62.60867357254028  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 60.68399429321289  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 60.7806830406189  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 1.4036121368408203  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 2.429126739501953  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 2.4303464889526367  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 1.444373607635498  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 60.3166766166687  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 60.4133620262146  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

number of input  17252726
----------------------------------------after optimizer
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 1.5137214660644531  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.17535400390625
pure train time :  10.977578401565552
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.14715218544006348
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.038329362869262695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.157881498336792
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 1.184831142425537  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 2.2131919860839844  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 2.214592933654785  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 1.2353954315185547  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 60.07771635055542  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 60.137938022613525  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 1.1922688484191895  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 2.2206554412841797  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 2.2220349311828613  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.78753662109375 GB
    Memory Allocated: 1.2393054962158203  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 60.230140686035156  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 60.32682943344116  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 1.2276511192321777  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 2.2565479278564453  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 2.2579078674316406  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 1.275162696838379  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 60.17855453491211  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 60.275243282318115  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 1.2634592056274414  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 2.2881722450256348  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 2.2895493507385254  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 1.3062725067138672  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 60.24034595489502  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 60.337034702301025  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 1.2979722023010254  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 2.319875717163086  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 2.3212356567382812  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 1.3421216011047363  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 60.23086977005005  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 60.327558517456055  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 1.3321442604064941  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 2.3638534545898438  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 2.3652172088623047  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.79144287109375 GB
    Memory Allocated: 1.3891901969909668  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.79339599609375 GB
    Memory Allocated: 60.617756366729736  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 67.79339599609375 GB
    Memory Allocated: 60.71444511413574  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 67.79339599609375 GB
    Memory Allocated: 1.3780179023742676  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 67.79339599609375 GB
    Memory Allocated: 2.408541679382324  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 67.79339599609375 GB
    Memory Allocated: 2.409853935241699  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.79339599609375 GB
    Memory Allocated: 1.4239859580993652  GigaBytes
Max Memory Allocated: 62.637742042541504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.79339599609375 GB
    Memory Allocated: 60.69031238555908  GigaBytes
Max Memory Allocated: 62.645999908447266  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 67.79339599609375 GB
    Memory Allocated: 60.78700113296509  GigaBytes
Max Memory Allocated: 62.645999908447266  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 67.79534912109375 GB
    Memory Allocated: 1.41294527053833  GigaBytes
Max Memory Allocated: 62.645999908447266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 67.79534912109375 GB
    Memory Allocated: 2.4462943077087402  GigaBytes
Max Memory Allocated: 62.645999908447266  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 67.79534912109375 GB
    Memory Allocated: 2.4474754333496094  GigaBytes
Max Memory Allocated: 62.645999908447266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.79534912109375 GB
    Memory Allocated: 1.4629101753234863  GigaBytes
Max Memory Allocated: 62.645999908447266  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.80706787109375 GB
    Memory Allocated: 60.781861305236816  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.80706787109375 GB
    Memory Allocated: 60.878546714782715  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

number of input  17255037
----------------------------------------after optimizer
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 1.5256843566894531  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.737351417541504
pure train time :  7.189925193786621
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.14925456047058105
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03362560272216797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16016674041748047
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 1.1919102668762207  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 2.2192540168762207  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 2.2206549644470215  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 1.2336101531982422  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 60.08031892776489  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 60.14125728607178  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 1.189521312713623  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 2.2156004905700684  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 2.2168374061584473  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 1.2351312637329102  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 60.179418087005615  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 60.27610683441162  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 1.2250447273254395  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 2.2547049522399902  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 2.256037712097168  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 1.2758350372314453  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 60.37659502029419  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 60.473283767700195  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 1.2651491165161133  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 2.2935633659362793  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 2.294800281524658  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 1.3112773895263672  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 60.19437599182129  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 60.291064739227295  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 1.3012394905090332  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 2.32973051071167  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 2.3310632705688477  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 1.3485283851623535  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 60.38731336593628  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 60.484002113342285  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 1.3392210006713867  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 2.37539005279541  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 2.376626968383789  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.13909912109375 GB
    Memory Allocated: 1.3941454887390137  GigaBytes
Max Memory Allocated: 62.732954025268555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.80568790435791  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.902376651763916  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3831253051757812  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.40762996673584  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4089317321777344  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4190020561218262  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.37160921096802  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.46829795837402  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4073338508605957  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4357614517211914  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4369983673095703  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.458317756652832  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.54487323760986  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.64156198501587  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17256065
----------------------------------------after optimizer
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.520601749420166  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.529226303100586
pure train time :  7.194324731826782
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.15273332595825195
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03307819366455078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16980457305908203
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1866455078125  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2211599349975586  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2224979400634766  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2406044006347656  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.41371536254883  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.47505283355713  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1965432167053223  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2238869667053223  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2252187728881836  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2364544868469238  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.2844557762146  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.381144523620605  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2246503829956055  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.251680374145508  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2530298233032227  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2714152336120605  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.242645263671875  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.33933401107788  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2596330642700195  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2855916023254395  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.286923408508301  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3055944442749023  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.32624530792236  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.42293405532837  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2939696311950684  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.321662425994873  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.322990894317627  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3427848815917969  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.39274787902832  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.489436626434326  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3310365676879883  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3624887466430664  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3638172149658203  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3820438385009766  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.619473457336426  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.71616220474243  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3703908920288086  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3988184928894043  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.400129795074463  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4143481254577637  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.319695472717285  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.41638422012329  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4025225639343262  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.430356979370117  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4316811561584473  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4488697052001953  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.262256145477295  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.3589448928833  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17258144
----------------------------------------after optimizer
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.5122270584106445  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.299208164215088
pure train time :  7.327168941497803
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.15133142471313477
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04040026664733887
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16227984428405762
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1863341331481934  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2068238258361816  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2082176208496094  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2264413833618164  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 59.91402196884155  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 59.97516489028931  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1829400062561035  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2147159576416016  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2161169052124023  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2413620948791504  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.29130220413208  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.387990951538086  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.229600429534912  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.252499580383301  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2538604736328125  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.267672061920166  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.171457290649414  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.26814603805542  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2598862648010254  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.289379596710205  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.290724277496338  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3135700225830078  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.35901165008545  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.455700397491455  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.302295207977295  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3315157890319824  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3328604698181152  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3490862846374512  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.34887170791626  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.445560455322266  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.337252140045166  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.364595890045166  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.365940570831299  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3824706077575684  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.4230170249939  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.5197057723999  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3711509704589844  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.403494358062744  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4048266410827637  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4233622550964355  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.6030797958374  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.69976854324341  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4123592376708984  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4436254501342773  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.444957733154297  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4584898948669434  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.644333362579346  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.741018772125244  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17248652
----------------------------------------after optimizer
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.5230169296264648  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.9978251457214355
pure train time :  7.407315731048584
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.1529233455657959
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03071451187133789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1619274616241455
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1915297508239746  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2190980911254883  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.220424175262451  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2348580360412598  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.18776178359985  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.2471489906311  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1902709007263184  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.218519687652588  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2199206352233887  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2386150360107422  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.17496299743652  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.27165174484253  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2283730506896973  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2557168006896973  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.25704288482666  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.274444580078125  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.27833127975464  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.375020027160645  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2627201080322266  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2923741340637207  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2937216758728027  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3121519088745117  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.36858510971069  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.4652738571167  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3005542755126953  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3289523124694824  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3302783966064453  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3463306427001953  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.30809688568115  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.40478563308716  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.334897518157959  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3654870986938477  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3668155670166016  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.384373664855957  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.64014434814453  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.73683309555054  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3726272583007812  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.405364990234375  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.406691074371338  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4219245910644531  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.50288486480713  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.599573612213135  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4100561141967773  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4348297119140625  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4360508918762207  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4489822387695312  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.35250520706177  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.449190616607666  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17257492
----------------------------------------after optimizer
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.512707233428955  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.732588529586792
pure train time :  7.489917278289795
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.15291643142700195
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03499102592468262
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1627063751220703
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.183781623840332  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.216498374938965  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.217855453491211  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2396636009216309  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.53545427322388  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.595985889434814  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1947479248046875  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2243857383728027  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2257156372070312  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.238694190979004  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.1656436920166  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.26233243942261  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.226879596710205  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2586050033569336  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2597365379333496  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2760138511657715  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.48178291320801  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.578471660614014  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2641386985778809  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.291482448577881  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.292799472808838  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.30704927444458  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.34271955490112  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.43940830230713  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2953147888183594  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.318694591522217  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.319826126098633  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3380985260009766  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.15531921386719  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.25200796127319  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3297877311706543  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3575572967529297  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3588743209838867  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.381392478942871  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.33676528930664  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.43345403671265  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3718409538269043  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4012675285339355  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4023990631103516  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4203362464904785  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.3847541809082  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.48144292831421  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.408696174621582  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4369025230407715  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4382195472717285  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.454721450805664  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.4812068939209  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.577895641326904  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17259025
----------------------------------------after optimizer
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.5172810554504395  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.5086262226104736
pure train time :  7.346482992172241
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.1609961986541748
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.041828155517578125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16974902153015137
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1868352890014648  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.217373847961426  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.218719482421875  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2369670867919922  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.43486833572388  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.495874881744385  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.192518711090088  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.220167636871338  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2215685844421387  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2367205619812012  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.22595262527466  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.322641372680664  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2261133193969727  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.254530906677246  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2558822631835938  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2739896774291992  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.42848443984985  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.52517318725586  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2623729705810547  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2911806106567383  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.292487144470215  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.309823989868164  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.316054344177246  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.41274309158325  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2979884147644043  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.330152988433838  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3314595222473145  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3484902381896973  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.41010808944702  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.50679683685303  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.336728572845459  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3664093017578125  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.367715835571289  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3813157081604004  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.358975410461426  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.45566415786743  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3696041107177734  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3927860260009766  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.394092559814453  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4100427627563477  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.23632049560547  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.333009243011475  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4013395309448242  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4270243644714355  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.428330898284912  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4507699012756348  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.29683780670166  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.39352321624756  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17251434
----------------------------------------after optimizer
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.5130763053894043  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.376682996749878
pure train time :  7.301455974578857
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.15345382690429688
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03308272361755371
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16216158866882324
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1841297149658203  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.21370792388916  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.214928150177002  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.235494613647461  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.10029983520508  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.16147994995117  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1916522979736328  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2279019355773926  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2293028831481934  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2457389831542969  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.419095516204834  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.51578426361084  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2356162071228027  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2654013633728027  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.266777992248535  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2762627601623535  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.456034660339355  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.55272340774536  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2645721435546875  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.293335437774658  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.294663906097412  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3106107711791992  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.361770153045654  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.45845890045166  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2992143630981445  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3219637870788574  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.323094367980957  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3399271965026855  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.22081136703491  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.31750011444092  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.32859468460083  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3573408126831055  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3586692810058594  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3819618225097656  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.52489137649536  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.62158012390137  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3702497482299805  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.398135185241699  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.399454116821289  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.416459560394287  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.44734811782837  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.544036865234375  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4059104919433594  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4332542419433594  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4345827102661133  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.452432632446289  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.569968700408936  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.66665744781494  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17261277
----------------------------------------after optimizer
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.5164294242858887  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2859413623809814
pure train time :  7.470777750015259
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.15285563468933105
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03050827980041504
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16174650192260742
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1865286827087402  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.212205410003662  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2135329246520996  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.231886863708496  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.130435943603516  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.190897941589355  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1884312629699707  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2174596786499023  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.218860626220703  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2394790649414062  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.221481800079346  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.31817054748535  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.228102684020996  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2577176094055176  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2590603828430176  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2757225036621094  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.32553148269653  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.42222023010254  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.266127109527588  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2944211959838867  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.295771598815918  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3118863105773926  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.36174774169922  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.458436489105225  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3004465103149414  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3347244262695312  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3360671997070312  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3536763191223145  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.64037275314331  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.737061500549316  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.344308853149414  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3706507682800293  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.371962070465088  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3832898139953613  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.26841735839844  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.36510610580444  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3743534088134766  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.401185989379883  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.402528762817383  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4219040870666504  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.40021276473999  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.496901512145996  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.411635398864746  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4391140937805176  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.440425395965576  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4593806266784668  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.5582594871521  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.654944896698  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17254413
----------------------------------------after optimizer
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.5216560363769531  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0874834060668945
pure train time :  7.4687111377716064
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.15101885795593262
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02832651138305664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15990471839904785
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1857538223266602  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.21309757232666  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.214435577392578  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2333073616027832  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.32712411880493  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.38847875595093  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.1907415390014648  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.220986843109131  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.222322463989258  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2411608695983887  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.28970670700073  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.38639545440674  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2293853759765625  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2615299224853516  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.262894630432129  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.278559684753418  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.530664920806885  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.62735366821289  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2674264907836914  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.292789936065674  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2941198348999023  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3076143264770508  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.266918659210205  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.36360740661621  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2962231636047363  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.325385570526123  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3267154693603516  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3472089767456055  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.573060512542725  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.66974925994873  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3357930183410645  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3652267456054688  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.366530418395996  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3830246925354004  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.18268442153931  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.27937316894531  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3715577125549316  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.394357204437256  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.395660877227783  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.411829948425293  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.24002981185913  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.33671855926514  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4009709358215332  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.431978225708008  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.4331436157226562  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.4561986923217773  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.581347942352295  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.6780366897583  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17253406
----------------------------------------after optimizer
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.519455909729004  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9604804515838623
pure train time :  7.465059280395508
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.16002368927001953
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04005026817321777
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16899895668029785
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.190103530883789  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2213144302368164  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2226457595825195  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2381415367126465  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.3128342628479  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.37322187423706  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.193164348602295  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2215914726257324  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.222992420196533  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.23756742477417  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.30855655670166  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.405245304107666  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2258477210998535  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.257615566253662  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.2588047981262207  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2762084007263184  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.48786687850952  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.58455562591553  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.2644991874694824  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.298276901245117  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.299579620361328  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3138513565063477  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.517441272735596  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.6141300201416  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3028044700622559  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3286170959472656  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.329806327819824  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.341721534729004  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.29408025741577  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.39076900482178  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3324689865112305  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3603601455688477  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3616628646850586  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.3817133903503418  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.382171630859375  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 60.47886037826538  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.370412826538086  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.391423225402832  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 2.3926124572753906  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.50238037109375 GB
    Memory Allocated: 1.410268783569336  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54730224609375 GB
    Memory Allocated: 60.15692186355591  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54730224609375 GB
    Memory Allocated: 60.253610610961914  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.401099681854248  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.427114486694336  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4282755851745605  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4530634880065918  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.381972789764404  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.47866153717041  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17250989
----------------------------------------after optimizer
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.5151104927062988  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.864171266555786
pure train time :  7.482544422149658
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.1537494659423828
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.035781145095825195
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16467690467834473
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.1840038299560547  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2142462730407715  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.215582847595215  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2361245155334473  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.39436340332031  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.4558539390564  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.192171573638916  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2227425575256348  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.224085807800293  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2395915985107422  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.29640531539917  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.393094062805176  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.227806568145752  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2584962844848633  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2598371505737305  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2750916481018066  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.395591735839844  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.49228048324585  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2635045051574707  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.292745590209961  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.294076919555664  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3090806007385254  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.28021812438965  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.376906871795654  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2973265647888184  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.321687698364258  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.323028564453125  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.339357852935791  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.09183883666992  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.18852758407593  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3300161361694336  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.359252452850342  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.360583782196045  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3819818496704102  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.40388536453247  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.50057411193848  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.370358943939209  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.398322105407715  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.399658203125  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4162373542785645  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.55385494232178  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.65054368972778  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4054722785949707  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.43166446685791  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4328160285949707  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4504737854003906  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.34032678604126  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.43701219558716  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17256409
----------------------------------------after optimizer
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.5146942138671875  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.749886989593506
pure train time :  7.482859373092651
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.1519303321838379
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03241562843322754
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1628127098083496
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.1864113807678223  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.218893051147461  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2202353477478027  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.240696907043457  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.53097915649414  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.590229988098145  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.1946392059326172  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2231292724609375  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.224431037902832  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2377190589904785  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.313297748565674  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.40998649597168  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2285876274108887  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2559313774108887  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2572593688964844  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2744669914245605  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.14977407455444  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.24646282196045  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.262613296508789  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.289185047149658  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2904868125915527  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.308854103088379  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.347787380218506  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.44447612762451  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2981209754943848  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3301877975463867  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3315157890319824  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3507070541381836  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.35761260986328  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.45430135726929  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3389997482299805  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3663434982299805  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.367645263671875  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3812923431396484  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.385695934295654  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.48238468170166  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3695673942565918  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.398921012878418  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4002490043640137  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4186463356018066  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.413620948791504  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.51030969619751  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.407968521118164  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4337258338928223  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.435027599334717  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4513916969299316  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.45262336730957  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.549312114715576  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17257525
----------------------------------------after optimizer
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.513613224029541  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.676354169845581
pure train time :  7.488090515136719
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.15411686897277832
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03044724464416504
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16306567192077637
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.1840429306030273  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2056307792663574  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.206979274749756  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2273988723754883  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.045917987823486  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.10725259780884  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.1843757629394531  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.211719512939453  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.213014602661133  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2371487617492676  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.22177839279175  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.318467140197754  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2285280227661133  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2573904991149902  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.258735179901123  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.27714204788208  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.25269365310669  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.349382400512695  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2653617858886719  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.293454170227051  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2947492599487305  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3115572929382324  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.261271953582764  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.35796070098877  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3009285926818848  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3296728134155273  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.33101749420166  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3487796783447266  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.46782970428467  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.564518451690674  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3374133110046387  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3664278984069824  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.367722988128662  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3847570419311523  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.463496685028076  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.56018543243408  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.373702049255371  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4046707153320312  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4059982299804688  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.422903060913086  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.662827491760254  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.75951623916626  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4113659858703613  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4435300827026367  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4448232650756836  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.459671974182129  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.46993827819824  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.56662368774414  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17251879
----------------------------------------after optimizer
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.5226187705993652  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6156973838806152
pure train time :  7.4477949142456055
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.1516566276550293
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030924081802368164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16062474250793457
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.1911253929138184  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.21549129486084  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2168664932250977  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2309870719909668  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.21529245376587  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.2759428024292  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.187483787536621  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2152724266052246  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.216583728790283  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2379331588745117  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.251723289489746  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.34841203689575  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.226198673248291  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.255702495574951  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.257051944732666  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2750515937805176  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.30518198013306  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.40187072753906  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.263199806213379  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.287599563598633  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2889108657836914  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3050813674926758  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.28886413574219  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.38555288314819  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2936887741088867  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3210878372192383  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.322437286376953  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3437561988830566  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.34489917755127  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.441587924957275  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3319993019104004  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.36586856842041  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3671798706054688  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3856163024902344  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.51504707336426  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.611735820770264  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3743338584899902  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4061813354492188  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.407520294189453  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4194798469543457  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.50248908996582  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.599177837371826  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4081101417541504  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4380125999450684  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.439323902130127  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4532136917114258  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.43850231170654  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.53519105911255  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17257624
----------------------------------------after optimizer
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.5171566009521484  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5621330738067627
pure train time :  7.708539009094238
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.15111851692199707
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03258800506591797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16198968887329102
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.1889615058898926  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.213913917541504  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2152605056762695  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2314987182617188  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 59.99558782577515  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.05615854263306  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.187047004699707  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.218355178833008  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2195920944213867  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2404656410217285  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.35799169540405  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.45468044281006  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.228713035583496  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.256056785583496  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2574214935302734  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2723455429077148  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.34763765335083  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.444326400756836  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.260596752166748  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2922816276550293  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.293518543243408  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3119864463806152  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.48985433578491  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.58654308319092  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3001594543457031  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3307886123657227  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.332122802734375  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3463630676269531  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.45834398269653  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.55503273010254  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3352246284484863  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.362715721130371  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.36395263671875  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3791394233703613  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.410831928253174  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.50752067565918  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3680524826049805  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3953962326049805  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.396730422973633  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.414964199066162  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.23085594177246  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.32754468917847  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4071683883666992  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4381208419799805  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4393577575683594  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4579048156738281  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.63390493392944  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.73059034347534  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17259108
----------------------------------------after optimizer
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.5212054252624512  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4914193153381348
pure train time :  7.67310094833374
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.14995861053466797
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03133416175842285
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15897607803344727
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.1892304420471191  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.216574192047119  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2178826332092285  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2332062721252441  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.07820701599121  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.13948440551758  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.1903009414672852  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2142176628112793  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2155652046203613  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2338948249816895  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.17910099029541  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.275789737701416  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2241764068603516  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2515201568603516  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.252889633178711  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2747626304626465  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.37405872344971  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.47074747085571  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.263108253479004  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.296420097351074  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2977542877197266  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3163042068481445  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.57621669769287  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.67290544509888  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3049297332763672  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.332273483276367  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.333582878112793  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3459959030151367  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.250266551971436  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.34695529937744  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3341865539550781  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.368885040283203  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.370194435119629  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3888349533081055  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.72688293457031  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.82357168197632  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.377469539642334  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4057998657226562  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4070258140563965  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4180693626403809  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.41198396682739  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.5086727142334  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.406351089477539  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4338550567626953  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.435164451599121  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4526233673095703  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.43033790588379  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.527026653289795  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17256224
----------------------------------------after optimizer
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.5170373916625977  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4395668506622314
pure train time :  7.482148885726929
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.151594877243042
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04328751564025879
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16240620613098145
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.1870641708374023  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.212303638458252  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.21366024017334  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.232398509979248  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.12384366989136  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.18391132354736  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.187232494354248  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.217123031616211  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2185239791870117  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2391366958618164  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.38653898239136  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.48322772979736  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2273197174072266  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.25541353225708  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.256743907928467  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2725772857666016  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.382490158081055  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.47917890548706  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.260937213897705  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.290252685546875  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2915802001953125  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3091344833374023  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.158514976501465  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.25520372390747  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.297956943511963  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3320655822753906  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3333959579467773  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3498377799987793  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.369444847106934  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.46613359451294  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3381128311157227  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3630924224853516  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.364419937133789  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3760418891906738  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.33345985412598  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.43014860153198  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.364333152770996  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.392075538635254  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3934059143066406  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4142227172851562  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.509013175964355  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.60570192337036  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4025325775146484  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.43106746673584  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4323949813842773  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4503822326660156  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.45987129211426  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.556560039520264  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17255167
----------------------------------------after optimizer
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.5143122673034668  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3910090923309326
pure train time :  7.468131065368652
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
range partition time  0.1539463996887207
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03732872009277344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16481471061706543
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.1885337829589844  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.219193935394287  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2205357551574707  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2384305000305176  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.42942667007446  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.489073753356934  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.1928253173828125  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2201690673828125  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2215700149536133  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2366385459899902  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.25558853149414  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.35227727890015  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2250070571899414  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.254042148590088  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.255375862121582  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2736740112304688  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.23688793182373  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.333576679229736  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2621140480041504  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2907962799072266  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.2919716835021973  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3087201118469238  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.40687656402588  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.503565311431885  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.2969765663146973  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3243203163146973  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.3256540298461914  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3427457809448242  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.182551860809326  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.27924060821533  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3345932960510254  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.365267753601074  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.366443157196045  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3849868774414062  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.564051151275635  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.66073989868164  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.3734779357910156  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.401297092437744  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4026198387145996  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.41788911819458  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.499688148498535  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.59637689590454  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.408505916595459  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.4343695640563965  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 2.435544967651367  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.4533514976501465  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.365057945251465  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 60.46174669265747  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

number of input  17252945
----------------------------------------after optimizer
 Nvidia-smi: 74.54925537109375 GB
    Memory Allocated: 1.515829086303711  GigaBytes
Max Memory Allocated: 62.75938940048218  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3456714153289795
pure train time :  7.450990915298462
epoch_time_list  [46.64478516578674, 43.09370684623718, 43.39357233047485, 44.50047445297241, 44.61440420150757, 44.72599673271179, 45.561294078826904, 48.4454562664032, 44.50373029708862, 44.17266225814819, 45.65975093841553, 45.78505539894104, 43.707706451416016, 43.54769945144653, 43.48474884033203, 44.00654697418213, 45.85353994369507, 46.229843854904175, 42.44228911399841, 42.460224628448486]

loading_time list   [0.8825087547302246, 0.875952959060669, 0.8097569942474365, 0.7951085567474365, 0.9046494960784912, 0.9817676544189453, 1.0251822471618652, 0.799452543258667, 0.840731143951416, 0.8085048198699951, 0.8352587223052979, 0.7892322540283203, 0.8624584674835205, 0.7845118045806885, 0.8128821849822998, 0.7964725494384766, 0.9872641563415527, 0.9934232234954834, 0.8274679183959961, 0.7831244468688965]

 data loader gen time  31.476484060287476
	---backpack schedule time  [0.3488748073577881, 0.3368659019470215, 0.33061861991882324, 0.34126877784729004, 0.34052252769470215, 0.3247997760772705, 0.32353854179382324, 0.3733205795288086, 0.32730555534362793, 0.32549166679382324, 0.31764960289001465, 0.35266566276550293, 0.33539795875549316, 0.3288605213165283, 0.3254058361053467, 0.323270320892334, 0.32718777656555176, 0.32587289810180664, 0.33938145637512207, 0.33260273933410645]
	---connection_check_time_list  [6.016183853149414, 5.848077297210693, 5.812953472137451, 7.007765769958496, 6.802327871322632, 6.145021438598633, 8.830624103546143, 10.441723108291626, 6.71380090713501, 6.577756404876709, 8.66962718963623, 7.747324228286743, 6.191124439239502, 6.1417741775512695, 6.106191158294678, 6.106342315673828, 7.851856231689453, 8.596388816833496, 5.385822296142578, 5.345403671264648]
	---block_gen_time_list  [3.5658929347991943, 3.465125560760498, 3.6258952617645264, 3.558533191680908, 3.6331868171691895, 3.8829283714294434, 3.1677467823028564, 3.950932741165161, 3.656933307647705, 3.6162126064300537, 3.4649734497070312, 4.2254111766815186, 3.665363311767578, 3.5814976692199707, 3.5792269706726074, 3.6738438606262207, 3.8254945278167725, 3.750291347503662, 3.5029473304748535, 3.6102049350738525]
training time  [13.637943029403687, 10.395715475082397, 10.491931915283203, 10.31039810180664, 10.519865989685059, 10.956320524215698, 10.099679470062256, 10.176885604858398, 10.483593225479126, 10.465677976608276, 10.113364934921265, 10.202264785766602, 10.353033065795898, 10.34857988357544, 10.274684190750122, 10.779528379440308, 10.540487051010132, 10.26924991607666, 10.165660619735718, 10.1850106716156]
---feature block loading time  [2.651333808898926, 3.1915249824523926, 3.2842772006988525, 2.96779727935791, 3.0975019931793213, 3.4496564865112305, 2.7353081703186035, 2.8628995418548584, 2.998506546020508, 2.98330020904541, 2.6319949626922607, 2.7048757076263428, 2.8560969829559326, 2.8451151847839355, 2.8124077320098877, 3.0545260906219482, 2.852381944656372, 2.7726552486419678, 2.6844189167022705, 2.720130443572998]


epoch_time avg   44.700059339404106
loading_time avg   0.8645239770412445
 data loader gen time avg 33.447950288653374
	---backpack schedule time avg 0.3327045887708664
	---connection_check_time avg  7.103319272398949
	---block_gen_time avg  3.67419970035553
training time  10.370867893099785
---feature block loading time  2.8788610100746155
pure train time per /epoch  [10.977578401565552, 7.189925193786621, 7.194324731826782, 7.327168941497803, 7.407315731048584, 7.489917278289795, 7.346482992172241, 7.301455974578857, 7.470777750015259, 7.4687111377716064, 7.465059280395508, 7.482544422149658, 7.482859373092651, 7.488090515136719, 7.4477949142456055, 7.708539009094238, 7.67310094833374, 7.482148885726929, 7.468131065368652, 7.450990915298462]
pure train time average  7.468299360836253
num_input list  [17252726, 17255037, 17256065, 17258144, 17248652, 17257492, 17259025, 17251434, 17261277, 17254413, 17253406, 17250989, 17256409, 17257525, 17251879, 17257624, 17259108, 17256224, 17255167, 17252945]
num_input  average  17255277.05
