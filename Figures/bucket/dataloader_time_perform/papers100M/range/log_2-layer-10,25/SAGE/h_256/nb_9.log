main start at this time 1714076169.491971
-----------------------------------------before load data 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
# Nodes: 111059956
# Edges: 1615685872
# Train: 1207179
# Val: 125265
# Test: 109727512
# Classes: 172

----------------------------------------start of run function 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.15089774131774902
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03957414627075195
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.17362570762634277
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 1.22113037109375 GB
    Memory Allocated: 0.003025054931640625  GigaBytes
Max Memory Allocated: 0.003025054931640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.18792724609375 GB
    Memory Allocated: 0.9682097434997559  GigaBytes
Max Memory Allocated: 0.9682097434997559  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 2.18792724609375 GB
    Memory Allocated: 0.9698219299316406  GigaBytes
Max Memory Allocated: 0.9698219299316406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.24261474609375 GB
    Memory Allocated: 1.0141849517822266  GigaBytes
Max Memory Allocated: 1.0141849517822266  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 58.04925537109375 GB
    Memory Allocated: 55.04780197143555  GigaBytes
Max Memory Allocated: 56.68782186508179  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 58.04925537109375 GB
    Memory Allocated: 55.133747577667236  GigaBytes
Max Memory Allocated: 56.68782186508179  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 59.23675537109375 GB
    Memory Allocated: 1.1083683967590332  GigaBytes
Max Memory Allocated: 56.68782186508179  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.23675537109375 GB
    Memory Allocated: 2.0761356353759766  GigaBytes
Max Memory Allocated: 56.68782186508179  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.23675537109375 GB
    Memory Allocated: 2.077768325805664  GigaBytes
Max Memory Allocated: 56.68782186508179  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.23675537109375 GB
    Memory Allocated: 1.1553544998168945  GigaBytes
Max Memory Allocated: 56.68782186508179  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.19573974609375 GB
    Memory Allocated: 55.167431354522705  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 77.19573974609375 GB
    Memory Allocated: 55.253376483917236  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 77.19573974609375 GB
    Memory Allocated: 1.1426353454589844  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 77.19573974609375 GB
    Memory Allocated: 2.110438823699951  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 77.19573974609375 GB
    Memory Allocated: 2.1115365028381348  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 77.19573974609375 GB
    Memory Allocated: 1.186476707458496  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.68011474609375 GB
    Memory Allocated: 55.0207314491272  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 78.68011474609375 GB
    Memory Allocated: 55.10667657852173  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 78.68011474609375 GB
    Memory Allocated: 1.1737279891967773  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 78.68011474609375 GB
    Memory Allocated: 2.1418800354003906  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 78.68011474609375 GB
    Memory Allocated: 2.143378257751465  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.68011474609375 GB
    Memory Allocated: 1.2192134857177734  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.68011474609375 GB
    Memory Allocated: 55.148491859436035  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 78.68011474609375 GB
    Memory Allocated: 55.234436988830566  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 78.68011474609375 GB
    Memory Allocated: 1.2062983512878418  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 78.68011474609375 GB
    Memory Allocated: 2.1671056747436523  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 78.68011474609375 GB
    Memory Allocated: 2.168203353881836  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.68011474609375 GB
    Memory Allocated: 1.2428903579711914  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.68206787109375 GB
    Memory Allocated: 54.872376918792725  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 78.68206787109375 GB
    Memory Allocated: 54.958322048187256  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 78.68206787109375 GB
    Memory Allocated: 1.2299399375915527  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 78.68206787109375 GB
    Memory Allocated: 2.1973876953125  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 78.68206787109375 GB
    Memory Allocated: 2.198786735534668  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.68206787109375 GB
    Memory Allocated: 1.281257152557373  GigaBytes
Max Memory Allocated: 56.89496612548828  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 58.40863037109375 GB
    Memory Allocated: 55.302109241485596  GigaBytes
Max Memory Allocated: 57.03112602233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 58.40863037109375 GB
    Memory Allocated: 55.38805437088013  GigaBytes
Max Memory Allocated: 57.03112602233887  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 59.59222412109375 GB
    Memory Allocated: 1.2686676979064941  GigaBytes
Max Memory Allocated: 57.03112602233887  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.59222412109375 GB
    Memory Allocated: 2.2424731254577637  GigaBytes
Max Memory Allocated: 57.03112602233887  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.59222412109375 GB
    Memory Allocated: 2.2435708045959473  GigaBytes
Max Memory Allocated: 57.03112602233887  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.59222412109375 GB
    Memory Allocated: 1.3191604614257812  GigaBytes
Max Memory Allocated: 57.03112602233887  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 55.55748701095581  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 55.64343214035034  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 1.3063993453979492  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 2.277003765106201  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 2.278402805328369  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 1.3479194641113281  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 55.446242332458496  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 55.53218746185303  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 1.3350958824157715  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 2.2984399795532227  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 2.2995376586914062  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 1.3718914985656738  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 55.164483070373535  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.71331787109375 GB
    Memory Allocated: 55.250428199768066  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

number of input  18255533
----------------------------------------after optimizer
 Nvidia-smi: 68.71527099609375 GB
    Memory Allocated: 1.4369053840637207  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.175433158874512
pure train time :  10.670578479766846
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.1523456573486328
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.036756038665771484
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1631934642791748
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 68.71527099609375 GB
    Memory Allocated: 1.1075639724731445  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.71527099609375 GB
    Memory Allocated: 2.0752205848693848  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.71527099609375 GB
    Memory Allocated: 2.0768532752990723  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.71527099609375 GB
    Memory Allocated: 1.156785488128662  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.71527099609375 GB
    Memory Allocated: 54.96972036361694  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.71527099609375 GB
    Memory Allocated: 55.02343273162842  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 68.71527099609375 GB
    Memory Allocated: 1.1152944564819336  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.71527099609375 GB
    Memory Allocated: 2.0806336402893066  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.71527099609375 GB
    Memory Allocated: 2.0816869735717773  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.71527099609375 GB
    Memory Allocated: 1.156726360321045  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 54.84144592285156  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 54.927391052246094  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.1463241577148438  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.1131210327148438  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.1145596504211426  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.1925320625305176  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 55.049882888793945  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 55.13582801818848  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.1806178092956543  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.1480188369750977  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.1490721702575684  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.2252130508422852  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 55.25026035308838  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 55.33620548248291  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.213301658630371  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.172506809234619  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.173820972442627  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.2496953010559082  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 54.8674111366272  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 54.95335626602173  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.2369475364685059  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.2063021659851074  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.207355499267578  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.2912344932556152  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 55.39746379852295  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 55.48340892791748  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.2784380912780762  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.2454075813293457  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.2467217445373535  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.3208770751953125  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 55.29563617706299  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 55.38158130645752  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.3086414337158203  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.2814159393310547  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.2824692726135254  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.3586373329162598  GigaBytes
Max Memory Allocated: 57.304548263549805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 55.61852550506592  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 55.70447063446045  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.3467130661010742  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.3176803588867188  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 2.318737030029297  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76409912109375 GB
    Memory Allocated: 1.3893342018127441  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76605224609375 GB
    Memory Allocated: 55.48172616958618  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76605224609375 GB
    Memory Allocated: 55.56767129898071  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18257767
----------------------------------------after optimizer
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.4471006393432617  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.740943908691406
pure train time :  7.495310306549072
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.1542966365814209
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03270602226257324
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16510558128356934
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.1144986152648926  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.079476833343506  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.0811095237731934  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.1534886360168457  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 54.97848653793335  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 55.032846450805664  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.1128568649291992  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.0775632858276367  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.0785775184631348  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.156327724456787  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 55.05225849151611  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 55.138203620910645  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.1443896293640137  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.1134042739868164  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.1144185066223145  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.193063735961914  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 55.16811561584473  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 55.25406074523926  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.1829962730407715  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.147707462310791  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.148721694946289  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.2230424880981445  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 54.98392391204834  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 55.06986904144287  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.2109565734863281  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.1797080039978027  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.180722236633301  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.2593474388122559  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 55.14807653427124  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 55.23402166366577  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.246826171875  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.2179923057556152  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.2190065383911133  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.2936573028564453  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 55.429200649261475  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 55.515145778656006  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.280839443206787  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.252068519592285  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 2.253082752227783  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.76800537109375 GB
    Memory Allocated: 1.3254575729370117  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.44750452041626  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.53344964981079  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.3130412101745605  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.2751293182373047  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.2761435508728027  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.348264217376709  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.19105768203735  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.277002811431885  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.3375930786132812  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.30588436126709  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.306898593902588  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.388181209564209  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.33227777481079  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.41822290420532  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18255575
----------------------------------------after optimizer
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.4464712142944336  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.527696132659912
pure train time :  7.681787014007568
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.16184115409851074
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04573965072631836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1708695888519287
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.1122698783874512  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.085610866546631  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.08705997467041  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.1621623039245605  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.30911445617676  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.3629846572876  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.1211352348327637  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.0886340141296387  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.090266704559326  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.1598358154296875  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.10016965866089  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.18611478805542  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.1486396789550781  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.1133294105529785  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.1143288612365723  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.1895842552185059  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.145042419433594  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.230987548828125  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.176887035369873  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.141903877258301  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.1430115699768066  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.2216978073120117  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.16087245941162  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.24681758880615  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.2093696594238281  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.175713062286377  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.177178382873535  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.2554473876953125  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.301305294036865  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.3872504234314  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.243614673614502  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.209071636199951  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.210411548614502  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.287015438079834  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.31071472167969  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.39665985107422  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.2755684852600098  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.2457804679870605  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.2472457885742188  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.3248167037963867  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.29800844192505  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.38395357131958  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.3123841285705566  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.2791810035705566  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.280646324157715  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.353299617767334  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.17442750930786  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.26037263870239  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.3403000831604004  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.306882858276367  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.3083481788635254  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.3844194412231445  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.15571594238281  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.241661071777344  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18256521
----------------------------------------after optimizer
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.4457645416259766  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.302248954772949
pure train time :  7.533405065536499
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.16002607345581055
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.042269229888916016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.17179274559020996
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.1134190559387207  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.0727672576904297  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.074399948120117  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.1506891250610352  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 54.80429029464722  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 54.855753898620605  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.107508659362793  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.0760154724121094  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.077014923095703  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.1604018211364746  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.12326908111572  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.209214210510254  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.1496968269348145  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.115236759185791  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.116776943206787  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.1916508674621582  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.1784553527832  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.264400482177734  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.180433750152588  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.1457176208496094  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.146717071533203  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.2240180969238281  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.19742965698242  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.28337478637695  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.2112531661987305  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.1768813133239746  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.1782007217407227  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.256269931793213  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.18020248413086  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.26614761352539  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.243891716003418  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.2131733894348145  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.214806079864502  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.292607307434082  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.278019428253174  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.363964557647705  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.2805233001708984  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.2508959770202637  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.2522153854370117  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.325706958770752  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.44217014312744  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.52811527252197  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.312929630279541  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.2829670906066895  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.284599781036377  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.3572883605957031  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.359705448150635  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 55.445650577545166  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.3456521034240723  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.3155593872070312  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 2.3168787956237793  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.10589599609375 GB
    Memory Allocated: 1.3897738456726074  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.53608322143555  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.62252378463745  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18253414
----------------------------------------after optimizer
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.447373390197754  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.001695156097412
pure train time :  7.556062459945679
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.15578603744506836
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0313260555267334
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16470885276794434
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1141676902770996  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0780491828918457  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.079681873321533  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1527972221374512  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 54.91206359863281  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 54.965957164764404  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1116790771484375  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0814895629882812  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0827579498291016  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1616191864013672  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.157384395599365  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.2433295249939  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1502776145935059  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1157522201538086  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.117074489593506  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1903557777404785  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.04230833053589  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.12825345993042  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1796541213989258  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.146273612976074  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1475419998168945  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2251405715942383  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.20735692977905  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.293302059173584  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2130208015441895  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1829090118408203  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1842880249023438  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.261113166809082  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.16873264312744  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.25467777252197  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2492480278015137  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.220065116882324  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2213335037231445  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2944636344909668  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.36681413650513  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.45275926589966  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2823190689086914  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2491159439086914  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.250494956970215  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3228278160095215  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.41030168533325  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.49624681472778  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3105511665344238  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2804927825927734  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2817611694335938  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3579773902893066  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.29650640487671  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.38245153427124  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3464245796203613  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.3105649948120117  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.311944007873535  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3850908279418945  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.282028675079346  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.36797380447388  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18260262
----------------------------------------after optimizer
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.4428496360778809  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.736917495727539
pure train time :  7.5456695556640625
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.1510939598083496
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.033016204833984375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16185355186462402
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1078171730041504  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.077983856201172  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0796165466308594  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.158980369567871  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.24854612350464  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.30308294296265  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1183357238769531  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.088538646697998  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.089538097381592  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.162135124206543  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.22466516494751  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.31061029434204  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1493687629699707  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1204066276550293  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.122039318084717  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1952276229858398  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.30706024169922  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.39300537109375  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1827521324157715  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1495490074157715  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1507253646850586  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.222442626953125  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.28740644454956  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.37335157394409  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2098078727722168  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.170599937438965  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1722326278686523  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2485857009887695  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 54.97998523712158  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.06593036651611  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.237203598022461  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.206233501434326  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2074098587036133  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2893853187561035  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.25478219985962  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.34072732925415  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.277000904083252  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.244192123413086  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2458248138427734  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.319941520690918  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.07573890686035  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.16168403625488  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3069310188293457  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.275038719177246  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.276215076446533  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.351759910583496  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.334961891174316  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.42090702056885  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3394908905029297  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.306450843811035  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.3080549240112305  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3831472396850586  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.372623920440674  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.458569049835205  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18264976
----------------------------------------after optimizer
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.4414019584655762  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.5100314617156982
pure train time :  7.802737474441528
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.1581873893737793
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03880763053894043
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1690845489501953
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1114897727966309  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0795326232910156  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.081165313720703  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1570119857788086  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.3012375831604  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.355146408081055  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.115699291229248  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.082915782928467  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0839152336120605  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1586127281188965  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.06640577316284  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.15235090255737  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1462807655334473  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1152429580688477  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1163735389709473  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1925482749938965  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.227274894714355  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.31322002410889  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1814837455749512  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.149777889251709  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1509084701538086  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2252016067504883  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.19916296005249  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.28586149215698  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2126002311706543  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.180349349975586  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1814799308776855  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.256448745727539  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.331406116485596  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.41735124588013  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.244194507598877  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2158846855163574  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.217015266418457  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2925128936767578  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.3099422454834  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.39588737487793  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2801790237426758  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.246975898742676  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2481064796447754  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.319645881652832  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.24431228637695  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.330257415771484  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3067121505737305  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.268584728240967  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2697153091430664  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.346118450164795  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.01963949203491  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.10558462142944  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3340134620666504  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.298953056335449  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.3000612258911133  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.38140869140625  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.18047332763672  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.26641845703125  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18255917
----------------------------------------after optimizer
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.4408845901489258  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.370344638824463
pure train time :  7.7743237018585205
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.15491080284118652
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.035330772399902344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16553020477294922
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1096830368041992  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.078657627105713  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0802903175354004  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1585760116577148  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 54.95786428451538  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.01106357574463  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1165361404418945  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.087772846221924  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.088780403137207  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.162513256072998  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.0504674911499  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.136412620544434  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1509389877319336  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1198649406433105  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1208724975585938  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1930198669433594  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.177361488342285  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.263306617736816  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1805238723754883  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1495394706726074  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1505470275878906  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2249994277954102  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.24350309371948  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.329448223114014  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2127652168273926  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1769895553588867  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.17799711227417  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2523488998413086  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.09995651245117  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.1859016418457  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2401251792907715  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2055225372314453  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2065300941467285  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2856688499450684  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.15420913696289  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.24015426635742  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2732782363891602  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.240504264831543  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.241511821746826  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.320047378540039  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.45939922332764  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.54534435272217  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3078093528747559  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2746706008911133  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2756781578063965  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3518123626708984  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.322556495666504  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.408501625061035  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.339315414428711  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.3051881790161133  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.3061957359313965  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3827176094055176  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.29550361633301  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.38144874572754  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18261443
----------------------------------------after optimizer
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.4410128593444824  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2800118923187256
pure train time :  7.830596446990967
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.15279626846313477
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030970096588134766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16174888610839844
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1093626022338867  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.073540687561035  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0751733779907227  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1526641845703125  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 54.955989360809326  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.01034164428711  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.112661361694336  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0789504051208496  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0799498558044434  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.158480167388916  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 54.98846435546875  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.07440948486328  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1456623077392578  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.11513614654541  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.116361141204834  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1934614181518555  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.2035756111145  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.28952074050903  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1806836128234863  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1499123573303223  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.151186943054199  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2251758575439453  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.22181272506714  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.30775785446167  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.212449073791504  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1816110610961914  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1828360557556152  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2567424774169922  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.35972023010254  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.44566535949707  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2441329956054688  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.213205337524414  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.214479923248291  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2884693145751953  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.225430488586426  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.31137561798096  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.27557373046875  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2402567863464355  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2414817810058594  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3154854774475098  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.174757957458496  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.26070308685303  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3029890060424805  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2711358070373535  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2724103927612305  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3508853912353516  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.36257886886597  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.4485239982605  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3380918502807617  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.3025026321411133  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.303727626800537  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3786883354187012  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.35630226135254  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.44224739074707  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18254963
----------------------------------------after optimizer
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.4368762969970703  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0858395099639893
pure train time :  7.784966707229614
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.15264463424682617
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029430866241455078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16156721115112305
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1080193519592285  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0754637718200684  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.077096462249756  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1558637619018555  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.200395584106445  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.25484657287598  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.115004539489746  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.082157611846924  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0831570625305176  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1589336395263672  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.08382225036621  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.16976737976074  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1497001647949219  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.120908737182617  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.121929168701172  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.198178768157959  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.321178913116455  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.407124042510986  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1858816146850586  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1471571922302246  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1481566429138184  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2213315963745117  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 54.92425346374512  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.01019859313965  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2119560241699219  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1789493560791016  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1799697875976562  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.262096881866455  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.32486915588379  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.41081428527832  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2492766380310059  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2213687896728516  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2223682403564453  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.298746109008789  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.416592597961426  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.50253772735596  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.286107063293457  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.251504421234131  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2525248527526855  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3237714767456055  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.09365177154541  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.17959690093994  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3110566139221191  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.273707389831543  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2747068405151367  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3526253700256348  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.086416721343994  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.172361850738525  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3405652046203613  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.3102149963378906  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.3112354278564453  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3919720649719238  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.426223278045654  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.512168407440186  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18253328
----------------------------------------after optimizer
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.4505362510681152  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.963906764984131
pure train time :  7.802772521972656
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.15746450424194336
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.032364606857299805
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16837358474731445
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.113907814025879  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0840888023376465  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.085721492767334  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1594181060791016  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.17264270782471  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.2262396812439  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1196260452270508  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.086422920227051  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0874223709106445  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1599974632263184  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.1229510307312  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.20889616012573  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1477012634277344  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1188721656799316  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1203808784484863  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1969809532165527  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.29865550994873  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.38460063934326  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1850461959838867  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.157327175140381  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1583266258239746  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.230051040649414  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.35532474517822  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.441269874572754  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2176246643066406  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1850619316101074  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.186570644378662  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2576689720153809  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.09654235839844  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.18248748779297  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2447409629821777  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2115378379821777  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2125372886657715  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2879762649536133  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.26034593582153  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.346291065216064  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.276261329650879  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.240565299987793  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2419443130493164  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.318497657775879  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.14451217651367  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.2304573059082  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3056540489196777  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2666964530944824  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.268075466156006  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3467717170715332  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.15564012527466  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.24158525466919  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3361411094665527  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.3018131256103516  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.3029561042785645  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3848719596862793  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.197598934173584  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.283544063568115  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18254486
----------------------------------------after optimizer
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.4434823989868164  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.871100425720215
pure train time :  8.048869132995605
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.15349149703979492
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03245401382446289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1643054485321045
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1095848083496094  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.076871871948242  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0785045623779297  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1560745239257812  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.18852186203003  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.242586612701416  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1152958869934082  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.086672782897949  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.087672233581543  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1631450653076172  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.20886707305908  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.29481220245361  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1509037017822266  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.118607997894287  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1201224327087402  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1921281814575195  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.215717792510986  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.30166292190552  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1800041198730469  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.151442527770996  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.15244197845459  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.227607250213623  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.30768442153931  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.39362955093384  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2149295806884766  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.179368495941162  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1804089546203613  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2523317337036133  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 54.97277641296387  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.0587215423584  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2398467063903809  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.202375888824463  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2037644386291504  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2826480865478516  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.22364950180054  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.30959463119507  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2697057723999023  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.239950180053711  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.24099063873291  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3214540481567383  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.30376052856445  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.389705657958984  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3091120719909668  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2742104530334473  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2755990028381348  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3489928245544434  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.315431118011475  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.401376247406006  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3360891342163086  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.3021669387817383  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.3032073974609375  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.3811006546020508  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.25191831588745  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.33786344528198  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18258215
----------------------------------------after optimizer
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.439272403717041  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7523670196533203
pure train time :  7.998721599578857
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.16229581832885742
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04028487205505371
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.17129182815551758
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1094822883605957  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0809378623962402  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.0825705528259277  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1603460311889648  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.306623458862305  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.36109399795532  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1196064949035645  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.088393211364746  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.08939266204834  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1607036590576172  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.18661546707153  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.272560596466064  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1484899520874023  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1139397621154785  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1152868270874023  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1899614334106445  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 54.960872173309326  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.04681730270386  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.1772236824035645  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1439881324768066  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.1452908515930176  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2228636741638184  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.146976947784424  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.232922077178955  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2102117538452148  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.173567771911621  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.174593448638916  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.25087308883667  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 54.944838523864746  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 55.03078365325928  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.2392573356628418  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2173027992248535  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 2.2183284759521484  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.28948974609375 GB
    Memory Allocated: 1.298367977142334  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.571322441101074  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.657267570495605  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2856922149658203  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.246829032897949  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.247854709625244  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3133463859558105  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.051063537597656  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.13700866699219  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3013296127319336  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2700462341308594  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2710719108581543  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.353281021118164  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.28606557846069  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.372010707855225  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3409276008605957  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.304500102996826  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.305525779724121  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3801465034484863  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.302478313446045  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.388423442840576  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18260498
----------------------------------------after optimizer
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.4379563331604004  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.680617570877075
pure train time :  7.785637617111206
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.15744709968566895
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.035624027252197266
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16662311553955078
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1070685386657715  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0686535835266113  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.070286273956299  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1506595611572266  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 54.998751640319824  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.05311584472656  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1093087196350098  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0746097564697266  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.076477527618408  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1576180458068848  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 54.995633125305176  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.08157825469971  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1470918655395508  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.111539363861084  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1131720542907715  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1903796195983887  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.102388858795166  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.1883339881897  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.177882194519043  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1486926078796387  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1505603790283203  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2288451194763184  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.213003158569336  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.29894828796387  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2167949676513672  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.182582378387451  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1842150688171387  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.255906581878662  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.13088083267212  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.21682596206665  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2461905479431152  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.214280605316162  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2159953117370605  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2929725646972656  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.35154581069946  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.437490940093994  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.280557632446289  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2483649253845215  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.249997615814209  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.324575424194336  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.34332084655762  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.42926597595215  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3121442794799805  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2833595275878906  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.284395694732666  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3593969345092773  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.517160415649414  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.603105545043945  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3470683097839355  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.31699800491333  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.3186306953430176  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3907155990600586  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.236998081207275  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.32294321060181  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18255653
----------------------------------------after optimizer
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.4483356475830078  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6139917373657227
pure train time :  7.5837721824646
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.15343332290649414
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030741214752197266
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16240644454956055
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.113802433013916  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0778021812438965  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0788016319274902  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1521062850952148  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.05905532836914  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.11364984512329  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1110801696777344  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0770010948181152  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.078540325164795  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1579184532165527  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.1227011680603  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.208646297454834  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1466021537780762  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.114849090576172  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1159720420837402  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1929025650024414  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.26279973983765  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.34874486923218  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.180586814880371  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1440653800964355  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.145188331604004  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2201886177062988  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.00474977493286  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.09069490432739  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2092914581298828  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.174642562866211  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1757655143737793  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2555289268493652  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.102134227752686  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.18807935714722  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2427949905395508  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2123818397521973  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2135047912597656  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.291419506072998  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.41303825378418  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.49898338317871  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2790827751159668  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2461771965026855  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.247300148010254  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3212227821350098  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.21182155609131  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.29776668548584  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3088536262512207  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2827677726745605  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.283890724182129  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3600544929504395  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.409435749053955  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.495380878448486  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3471660614013672  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.316150665283203  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.3172736167907715  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.386612892150879  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.34483098983765  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.43077611923218  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18259016
----------------------------------------after optimizer
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.4451894760131836  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5545663833618164
pure train time :  7.838201284408569
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.1528160572052002
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03096294403076172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16175031661987305
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1133480072021484  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.076138973236084  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0777716636657715  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1520304679870605  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 54.84008836746216  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 54.8936824798584  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1098980903625488  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.079562187194824  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0806941986083984  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1606345176696777  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.07934761047363  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.165292739868164  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1482844352722168  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.115081310272217  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.116213321685791  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.189814567565918  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.22947454452515  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.31541967391968  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1784486770629883  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.146444797515869  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1475768089294434  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2240281105041504  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.19742155075073  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.283687591552734  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2114100456237793  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1847987174987793  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1859307289123535  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2611894607543945  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.38564443588257  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.4715895652771  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2494149208068848  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2176027297973633  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2187347412109375  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2886009216308594  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.346797943115234  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.432743072509766  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.275787353515625  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2405943870544434  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2417263984680176  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3167901039123535  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.067336559295654  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.153281688690186  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3047966957092285  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2710165977478027  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.272148609161377  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3505668640136719  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.122843742370605  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.20878887176514  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3381390571594238  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.307253837585449  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.3083858489990234  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.385446548461914  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.51525688171387  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.6012020111084  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18262403
----------------------------------------after optimizer
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.4432902336120605  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4821197986602783
pure train time :  7.829144477844238
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.15448784828186035
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030806303024291992
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16356945037841797
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1127872467041016  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.078200340270996  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0795841217041016  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.153719425201416  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.01145601272583  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.06575012207031  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1127820014953613  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0760388374328613  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0771117210388184  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.154651165008545  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 54.94582271575928  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.03176784515381  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1426715850830078  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.109468460083008  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1111011505126953  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1911630630493164  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.19386959075928  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.27981472015381  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1786155700683594  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1459169387817383  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1469898223876953  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2229595184326172  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.33574056625366  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.42168569564819  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2107844352722168  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.179075241088867  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1807079315185547  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2569527626037598  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.17987108230591  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.26581621170044  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2455086708068848  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.212801456451416  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.213874340057373  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2883367538452148  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.28969669342041  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.37564182281494  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2755498886108398  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2483606338500977  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.249993324279785  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.326019287109375  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.410831451416016  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.49677658081055  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3145880699157715  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2830452919006348  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.284118175506592  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3544745445251465  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.282233238220215  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.368178367614746  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3411407470703125  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.30656099319458  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.3079376220703125  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3827743530273438  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.2934775352478  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.379422664642334  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18255191
----------------------------------------after optimizer
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.4405183792114258  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.430340051651001
pure train time :  7.808135032653809
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.15241670608520508
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03044581413269043
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16140413284301758
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1092019081115723  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0723824501037598  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0740151405334473  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1515955924987793  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 54.950207233428955  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.00463676452637  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1112542152404785  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.080491065979004  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0817909240722656  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1613550186157227  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.19247245788574  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.27841758728027  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.148998737335205  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.116016387939453  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1176490783691406  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1915249824523926  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.28699731826782  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.37294244766235  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1788272857666016  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.14370059967041  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.145000457763672  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2209539413452148  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 54.92243814468384  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.00838327407837  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2081193923950195  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1816577911376953  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.183091163635254  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2613029479980469  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.26618003845215  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.35212516784668  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.248723030090332  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2165040969848633  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.217803955078125  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.287184715270996  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.19567108154297  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.2816162109375  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2749686241149902  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2417654991149902  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2429370880126953  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3182363510131836  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.30694818496704  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.39289331436157  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3081350326538086  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2720389366149902  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2732105255126953  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3496479988098145  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.338223934173584  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.424169063568115  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.337712287902832  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.3060317039489746  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.3072032928466797  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.386728286743164  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.37490892410278  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.460854053497314  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18253568
----------------------------------------after optimizer
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.4446535110473633  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3862950801849365
pure train time :  7.81885838508606
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
range partition time  0.15398931503295898
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03437638282775879
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16498804092407227
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1123042106628418  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0824031829833984  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0835752487182617  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1584844589233398  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.24173545837402  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.295756816864014  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1173439025878906  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.0841407775878906  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.085773468017578  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.15889310836792  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.19312524795532  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.27907037734985  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1466636657714844  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1116819381713867  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1126813888549805  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1886072158813477  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 54.996678829193115  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.08262395858765  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.1766934394836426  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.142414093017578  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.1434903144836426  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2218241691589355  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.13822078704834  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.22416591644287  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2098956108093262  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.182856559753418  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.184396743774414  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.261983871459961  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.32470512390137  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.4106502532959  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2503724098205566  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.214634418487549  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.21574068069458  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2856016159057617  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.12719964981079  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.21314477920532  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.2734713554382324  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2431459426879883  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2446861267089844  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3237295150756836  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.45254707336426  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.53849220275879  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3109674453735352  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.277764320373535  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.2788705825805664  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3520359992980957  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.285733699798584  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.371678829193115  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.339235782623291  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.3048720359802246  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 2.3062644004821777  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.3827109336853027  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.16443109512329  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 55.25037622451782  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

number of input  18258074
----------------------------------------after optimizer
 Nvidia-smi: 76.48089599609375 GB
    Memory Allocated: 1.4424619674682617  GigaBytes
Max Memory Allocated: 57.36402654647827  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.339818239212036
pure train time :  7.81040620803833
epoch_time_list  [46.08642268180847, 43.772830963134766, 46.08934736251831, 44.82444930076599, 47.979177713394165, 43.99748611450195, 44.35509181022644, 43.212140798568726, 43.128480195999146, 42.93502616882324, 43.06518316268921, 44.00282168388367, 44.52285194396973, 44.266457080841064, 42.94977927207947, 43.0559298992157, 43.14878225326538, 42.52714967727661, 42.53431534767151, 42.48615312576294]

loading_time list   [0.9191691875457764, 0.8560855388641357, 0.8006811141967773, 1.1220877170562744, 0.8466141223907471, 0.8323185443878174, 0.9053525924682617, 0.9198112487792969, 0.806119441986084, 0.8121922016143799, 0.8321700096130371, 0.9870226383209229, 0.9919312000274658, 1.0019068717956543, 0.8451735973358154, 0.8391036987304688, 0.9685959815979004, 0.794360876083374, 0.758793830871582, 0.8039426803588867]

 data loader gen time  30.903484106063843
	---backpack schedule time  [0.35089755058288574, 0.337954044342041, 0.33060240745544434, 0.3509984016418457, 0.3625798225402832, 0.3327515125274658, 0.32670068740844727, 0.3483893871307373, 0.3337090015411377, 0.3229644298553467, 0.32061171531677246, 0.333636999130249, 0.32913827896118164, 0.34245920181274414, 0.33078789710998535, 0.3200995922088623, 0.32096385955810547, 0.3220252990722656, 0.31781792640686035, 0.3307628631591797]
	---connection_check_time_list  [5.86359977722168, 5.729864835739136, 7.840775012969971, 6.221502304077148, 9.853546380996704, 6.153163909912109, 6.789492130279541, 5.660991668701172, 5.417125463485718, 5.344704627990723, 5.3492114543914795, 5.5771589279174805, 6.534858226776123, 6.551977157592773, 5.420202970504761, 5.36334490776062, 5.64956521987915, 5.331806421279907, 5.285005807876587, 5.312190055847168]
	---block_gen_time_list  [2.4060966968536377, 2.353870391845703, 2.6660783290863037, 2.9065732955932617, 2.664374589920044, 2.921779155731201, 2.6167562007904053, 2.604275703430176, 2.654850959777832, 2.5426993370056152, 2.5549991130828857, 2.625389575958252, 2.573577642440796, 2.5841095447540283, 2.84893536567688, 2.760310411453247, 2.4873971939086914, 2.481578826904297, 2.431173324584961, 2.4332797527313232]
training time  [13.481407403945923, 11.49527621269226, 11.004352331161499, 11.034766435623169, 10.90026593208313, 10.669026136398315, 10.70205307006836, 10.656968832015991, 10.9269278049469, 10.87341856956482, 10.914981365203857, 11.353046655654907, 11.107284307479858, 10.625572919845581, 10.480712652206421, 10.793428897857666, 10.757423400878906, 10.666396617889404, 10.825072050094604, 10.760189771652222]
---feature block loading time  [2.7998435497283936, 3.9865806102752686, 3.3063948154449463, 3.485896110534668, 3.3291847705841064, 3.109302043914795, 2.8818368911743164, 2.8647220134735107, 3.0812153816223145, 3.073385000228882, 3.0968031883239746, 3.286062717437744, 3.093043088912964, 2.8246843814849854, 2.885104179382324, 2.939009428024292, 2.9115328788757324, 2.8417863845825195, 2.9911856651306152, 2.9347469806671143]


epoch_time avg   43.63542664051056
loading_time avg   0.8715880960226059
 data loader gen time avg 31.933086693286896
	---backpack schedule time avg 0.3309624046087265
	---connection_check_time avg  5.974646583199501
	---block_gen_time avg  2.6115929186344147
training time  10.813298061490059
---feature block loading time  3.008975312113762
pure train time per /epoch  [10.670578479766846, 7.495310306549072, 7.681787014007568, 7.533405065536499, 7.556062459945679, 7.5456695556640625, 7.802737474441528, 7.7743237018585205, 7.830596446990967, 7.784966707229614, 7.802772521972656, 8.048869132995605, 7.998721599578857, 7.785637617111206, 7.5837721824646, 7.838201284408569, 7.829144477844238, 7.808135032653809, 7.81885838508606, 7.81040620803833]
pure train time average  7.773663520812988
num_input list  [18255533, 18257767, 18255575, 18256521, 18253414, 18260262, 18264976, 18255917, 18261443, 18254963, 18253328, 18254486, 18258215, 18260498, 18255653, 18259016, 18262403, 18255191, 18253568, 18258074]
num_input  average  18257340.15
