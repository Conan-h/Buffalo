main start at this time 1714081636.344324
-----------------------------------------before load data 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
# Nodes: 111059956
# Edges: 1615685872
# Train: 1207179
# Val: 125265
# Test: 109727512
# Classes: 172

----------------------------------------start of run function 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.014763355255126953
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.036429405212402344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014818429946899414
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 1.22113037109375 GB
    Memory Allocated: 0.003025054931640625  GigaBytes
Max Memory Allocated: 0.003025054931640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.13714599609375 GB
    Memory Allocated: 0.9190406799316406  GigaBytes
Max Memory Allocated: 0.9190406799316406  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 2.13909912109375 GB
    Memory Allocated: 0.9199404716491699  GigaBytes
Max Memory Allocated: 0.9199404716491699  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.19378662109375 GB
    Memory Allocated: 0.9598984718322754  GigaBytes
Max Memory Allocated: 0.9598984718322754  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.71917724609375 GB
    Memory Allocated: 50.730446338653564  GigaBytes
Max Memory Allocated: 52.20847129821777  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 53.71917724609375 GB
    Memory Allocated: 50.8077974319458  GigaBytes
Max Memory Allocated: 52.20847129821777  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 54.78948974609375 GB
    Memory Allocated: 1.0466561317443848  GigaBytes
Max Memory Allocated: 52.20847129821777  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 54.78948974609375 GB
    Memory Allocated: 1.9586734771728516  GigaBytes
Max Memory Allocated: 52.20847129821777  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 54.78948974609375 GB
    Memory Allocated: 1.9595732688903809  GigaBytes
Max Memory Allocated: 52.20847129821777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.78948974609375 GB
    Memory Allocated: 1.0825519561767578  GigaBytes
Max Memory Allocated: 52.20847129821777  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.78948974609375 GB
    Memory Allocated: 50.66162300109863  GigaBytes
Max Memory Allocated: 52.21054553985596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 54.78948974609375 GB
    Memory Allocated: 50.73897361755371  GigaBytes
Max Memory Allocated: 52.21054553985596  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 54.78948974609375 GB
    Memory Allocated: 1.0720157623291016  GigaBytes
Max Memory Allocated: 52.21054553985596  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 54.78948974609375 GB
    Memory Allocated: 1.984975814819336  GigaBytes
Max Memory Allocated: 52.21054553985596  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 54.78948974609375 GB
    Memory Allocated: 1.9858756065368652  GigaBytes
Max Memory Allocated: 52.21054553985596  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.78948974609375 GB
    Memory Allocated: 1.1128029823303223  GigaBytes
Max Memory Allocated: 52.21054553985596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.81097412109375 GB
    Memory Allocated: 50.61526679992676  GigaBytes
Max Memory Allocated: 52.21054553985596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 56.81097412109375 GB
    Memory Allocated: 50.692617416381836  GigaBytes
Max Memory Allocated: 52.21054553985596  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 56.81097412109375 GB
    Memory Allocated: 1.1018409729003906  GigaBytes
Max Memory Allocated: 52.21054553985596  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 56.81097412109375 GB
    Memory Allocated: 2.0172901153564453  GigaBytes
Max Memory Allocated: 52.21054553985596  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 56.81097412109375 GB
    Memory Allocated: 2.0181899070739746  GigaBytes
Max Memory Allocated: 52.21054553985596  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.81097412109375 GB
    Memory Allocated: 1.1444120407104492  GigaBytes
Max Memory Allocated: 52.21054553985596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.32659912109375 GB
    Memory Allocated: 50.978928565979004  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.32659912109375 GB
    Memory Allocated: 51.05627918243408  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 60.32659912109375 GB
    Memory Allocated: 1.1332249641418457  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.32659912109375 GB
    Memory Allocated: 2.0435237884521484  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.32659912109375 GB
    Memory Allocated: 2.0444235801696777  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.32659912109375 GB
    Memory Allocated: 1.167837142944336  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.32659912109375 GB
    Memory Allocated: 50.575082778930664  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.32659912109375 GB
    Memory Allocated: 50.65243339538574  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 60.32659912109375 GB
    Memory Allocated: 1.1565542221069336  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.32659912109375 GB
    Memory Allocated: 2.0744781494140625  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.32659912109375 GB
    Memory Allocated: 2.075377941131592  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.32659912109375 GB
    Memory Allocated: 1.20418119430542  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.85198974609375 GB
    Memory Allocated: 50.924673080444336  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.85198974609375 GB
    Memory Allocated: 51.002023696899414  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 72.85198974609375 GB
    Memory Allocated: 1.1944327354431152  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.85198974609375 GB
    Memory Allocated: 2.111941337585449  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.85198974609375 GB
    Memory Allocated: 2.1128411293029785  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.85198974609375 GB
    Memory Allocated: 1.234121322631836  GigaBytes
Max Memory Allocated: 52.54515218734741  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.024126052856445  GigaBytes
Max Memory Allocated: 52.58631992340088  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.10147666931152  GigaBytes
Max Memory Allocated: 52.58631992340088  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.2225995063781738  GigaBytes
Max Memory Allocated: 52.58631992340088  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.141334056854248  GigaBytes
Max Memory Allocated: 52.58631992340088  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.1422338485717773  GigaBytes
Max Memory Allocated: 52.58631992340088  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.2638978958129883  GigaBytes
Max Memory Allocated: 52.58631992340088  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.113564014434814  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.19091463088989  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.252833366394043  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.169299602508545  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.170199394226074  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.290656566619873  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.07930088043213  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.15665149688721  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.279675006866455  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.1932830810546875  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.194182872772217  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.316770076751709  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 50.99244022369385  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.06979036331177  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

number of input  19189133
----------------------------------------after optimizer
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.3753514289855957  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.175510406494141
pure train time :  8.982020139694214
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.01438283920288086
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03803682327270508
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014423847198486328
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.046006202697754  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.960580825805664  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.9614806175231934  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.0876317024230957  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 50.79825973510742  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 50.84683561325073  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.0515589714050293  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.9695119857788086  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.970411777496338  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.0950326919555664  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 50.92712116241455  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.00447177886963  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.0837178230285645  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.9961662292480469  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.9970660209655762  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.1180305480957031  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 50.56570816040039  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 50.64305877685547  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.1072711944580078  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.023318290710449  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.0242180824279785  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.1508145332336426  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 50.77314043045044  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 50.85049104690552  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.139237403869629  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.055253028869629  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.056152820587158  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.1792535781860352  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 50.927563190460205  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.00491380691528  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.168043613433838  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.0801806449890137  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.081080436706543  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.2039966583251953  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 50.66840219497681  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 50.745752811431885  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.1933436393737793  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.110548496246338  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.111448287963867  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.2384514808654785  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.02146244049072  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.0988130569458  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.2272047996520996  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.1433300971984863  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.1442298889160156  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.266127109527588  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.01793384552002  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.0952844619751  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.2552952766418457  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.1696829795837402  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.1705827713012695  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.2935376167297363  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 50.97568130493164  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.05303192138672  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.2828607559204102  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.19718599319458  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 2.1980857849121094  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.3228001594543457  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.060476303100586  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 51.137826442718506  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

number of input  19189825
----------------------------------------after optimizer
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.3762164115905762  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.741535186767578
pure train time :  8.005347490310669
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.014430522918701172
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030518770217895508
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014467954635620117
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.0476064682006836  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.960679531097412  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.9615793228149414  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.88714599609375 GB
    Memory Allocated: 1.0869770050048828  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 50.565439224243164  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 50.61313199996948  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 1.049187183380127  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 1.9644699096679688  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 1.965369701385498  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 1.0914788246154785  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 50.95413017272949  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 51.03148078918457  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 1.080955982208252  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 1.996971607208252  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 1.9978713989257812  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 1.1216650009155273  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 50.79910182952881  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 50.87645244598389  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 1.1102309226989746  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 2.023505210876465  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 2.024405002593994  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 1.1474599838256836  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 50.84043502807617  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 50.91778564453125  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 1.136268138885498  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 2.054042339324951  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 2.0549421310424805  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 74.89300537109375 GB
    Memory Allocated: 1.180912971496582  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.070332050323486  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.147682666778564  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1706304550170898  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.0828371047973633  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.0837368965148926  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2050590515136719  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.922340393066406  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.999691009521484  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1939492225646973  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.106027603149414  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.1069273948669434  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2335996627807617  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.62689399719238  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.70424461364746  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2248907089233398  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.1429567337036133  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.1438565254211426  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2709126472473145  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.054269790649414  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.13162040710449  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.259486198425293  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.175501823425293  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.1764016151428223  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2973403930664062  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.93856334686279  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.01591396331787  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2888407707214355  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.203770160675049  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.204669952392578  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.3276572227478027  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.90746021270752  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.9848108291626  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

number of input  19184071
----------------------------------------after optimizer
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.3798208236694336  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.529379844665527
pure train time :  8.028001308441162
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.014740228652954102
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02969837188720703
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014782428741455078
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.0469789505004883  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.9608182907104492  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.9617180824279785  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.0867409706115723  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.88031721115112  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.92924165725708  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.050088882446289  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.9716682434082031  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.9725680351257324  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.0979175567626953  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.91702890396118  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.99437952041626  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.0868749618530273  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.997293472290039  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.9981932640075684  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.115518569946289  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.56324291229248  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.64059352874756  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1044845581054688  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.0162839889526367  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.017183780670166  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1459159851074219  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.923208713531494  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.00055932998657  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1350784301757812  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.0488061904907227  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.049705982208252  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.176896095275879  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.80202293395996  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.87937355041504  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1670551300048828  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.080711841583252  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.0816116333007812  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2069058418273926  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.8195743560791  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.89692497253418  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1959176063537598  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.112118721008301  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.11301851272583  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2384543418884277  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.989853858947754  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.06720447540283  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.227003574371338  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.1447176933288574  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.1456174850463867  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2684812545776367  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.91019248962402  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.9875431060791  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2577567100524902  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.171599864959717  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.172499656677246  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2937960624694824  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.9151554107666  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.99250602722168  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.282620906829834  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.1979165077209473  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.1988162994384766  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.324110507965088  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.10264301300049  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.17999315261841  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

number of input  19184904
----------------------------------------after optimizer
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.3768458366394043  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.2996134757995605
pure train time :  7.816631078720093
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.014400720596313477
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04007077217102051
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01445150375366211
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.0478544235229492  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.95658540725708  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.9574851989746094  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.0819096565246582  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.63821077346802  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.686625957489014  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.0468435287475586  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.9640026092529297  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.964902400970459  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.0952963829040527  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.79677152633667  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.87412214279175  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.0843629837036133  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.002575397491455  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.0034751892089844  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1254591941833496  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.89839315414429  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.975743770599365  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1144123077392578  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.0328845977783203  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.0337843894958496  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1547884941101074  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.98363733291626  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.06098794937134  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1438708305358887  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.053734302520752  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.0546340942382812  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.17525053024292  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.870689392089844  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.94804000854492  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.164064884185791  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.081083297729492  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.0819830894470215  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2111907005310059  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.800357818603516  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.877708435058594  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2005810737609863  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.1155853271484375  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.116485118865967  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2384839057922363  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.93248987197876  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.00984048843384  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2269196510314941  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.142606735229492  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.1435065269470215  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2675814628601074  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.87394094467163  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.95129156112671  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2563080787658691  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.1681747436523438  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.169074535369873  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2923874855041504  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.93889236450195  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.01624298095703  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2812323570251465  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.197108268737793  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.1980080604553223  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.3258514404296875  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.95624589920044  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.03359603881836  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

number of input  19184517
----------------------------------------after optimizer
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.3783574104309082  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.997192859649658
pure train time :  7.837522029876709
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.015613555908203125
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03596901893615723
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015659093856811523
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.0489006042480469  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.9649648666381836  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.965864658355713  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.089956283569336  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.936644554138184  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.984593868255615  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.0528907775878906  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.9670476913452148  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.9679474830627441  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.090993881225586  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.8400297164917  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.91738033294678  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.0798468589782715  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.9959497451782227  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.996849536895752  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1217727661132812  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.832334995269775  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.90968561172485  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.11053466796875  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.02023983001709  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.021139621734619  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1439118385314941  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.53435134887695  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.61170196533203  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1332974433898926  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.051438808441162  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.0523386001586914  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.1817917823791504  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 50.99744367599487  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 51.07479429244995  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.170846939086914  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.086862564086914  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 2.0877623558044434  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93011474609375 GB
    Memory Allocated: 1.2086563110351562  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.75946378707886  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.836814403533936  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.197530746459961  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.1146416664123535  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.115541458129883  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.23868989944458  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 51.032031536102295  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 51.10938215255737  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.2278776168823242  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.143893241882324  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.1447930335998535  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.2666668891906738  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.89035081863403  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.96770143508911  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.2553229331970215  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.169193744659424  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.170093536376953  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.2931427955627441  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.96832990646362  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 51.0456805229187  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.2821259498596191  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.19600772857666  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.1969075202941895  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.3220281600952148  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.936821937561035  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 51.01417255401611  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

number of input  19188174
----------------------------------------after optimizer
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.3748183250427246  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7323172092437744
pure train time :  7.9497387409210205
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.015875577926635742
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030375957489013672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015913009643554688
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.0465784072875977  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.96547269821167  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.9663724899291992  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.092977523803711  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.89817142486572  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.946448802948  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.0564451217651367  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.9773406982421875  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.9782404899597168  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.098555088043213  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.925474643707275  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 51.00282526016235  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.0872511863708496  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.0035624504089355  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.004462242126465  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.1226601600646973  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.87580060958862  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.9531512260437  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.1112852096557617  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.0251102447509766  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.026010036468506  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.1487436294555664  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.831260204315186  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.908610820770264  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.1374516487121582  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.0487709045410156  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.049670696258545  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.175400733947754  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.87529277801514  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.952643394470215  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.1641173362731934  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.0798192024230957  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.080718994140625  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.2084989547729492  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.89803171157837  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.97538232803345  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.1972136497497559  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.1103625297546387  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.111262321472168  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.2345409393310547  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.787750244140625  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.8651008605957  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.2237834930419922  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.1367111206054688  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.137610912322998  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.263397216796875  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.77139234542847  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.848742961883545  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.2519917488098145  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.1669397354125977  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.167839527130127  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.293975830078125  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 50.97254514694214  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 51.04989576339722  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.2824206352233887  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.193739891052246  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 2.1946396827697754  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93597412109375 GB
    Memory Allocated: 1.3186841011047363  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.949252128601074  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.026602268218994  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

number of input  19185630
----------------------------------------after optimizer
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.3712406158447266  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.5186526775360107
pure train time :  8.089163541793823
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.016496896743774414
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.036507606506347656
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0165560245513916
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0438284873962402  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9555015563964844  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9564013481140137  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.084885597229004  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.70147466659546  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.74993944168091  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0480632781982422  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9640789031982422  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9649786949157715  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0924582481384277  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.856133460998535  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.93348407745361  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0822758674621582  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.996596336364746  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9974961280822754  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.1205253601074219  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.74957895278931  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.826929569244385  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.1090912818908691  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.0252370834350586  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.026136875152588  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.150984287261963  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.96104955673218  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.038400173187256  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.1400437355041504  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.058269500732422  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.059169292449951  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.1822247505187988  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.99499225616455  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.07234287261963  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.170931339263916  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.087890148162842  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.088789939880371  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.2095518112182617  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.804025650024414  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.88137626647949  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.1989660263061523  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.1080522537231445  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.108952045440674  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.2308902740478516  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.682175636291504  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.75952625274658  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.2198681831359863  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.1372838020324707  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.13818359375  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.268202304840088  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.02835130691528  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.10570192337036  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.2569832801818848  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.1750130653381348  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.175912857055664  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.2975850105285645  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.980713844299316  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.058064460754395  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.286423683166504  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.200652599334717  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.201552391052246  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.322634220123291  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.076480865478516  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.153831481933594  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

number of input  19192723
----------------------------------------after optimizer
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.3756942749023438  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.363759756088257
pure train time :  8.303236484527588
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.014596223831176758
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03152132034301758
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014647722244262695
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0471000671386719  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9591913223266602  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9600911140441895  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0851306915283203  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.68677806854248  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.73488092422485  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0488462448120117  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9649701118469238  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9658699035644531  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0929627418518066  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.8739447593689  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.951295375823975  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0816984176635742  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9977140426635742  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9986138343811035  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.1215424537658691  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.78362512588501  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.86097574234009  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.1103291511535645  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.024277687072754  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.025177478790283  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.1481513977050781  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.69468069076538  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.77203130722046  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.136713981628418  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.0539307594299316  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.054830551147461  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.1799345016479492  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.842777252197266  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.920127868652344  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.168504238128662  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.0845818519592285  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.085481643676758  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.2073869705200195  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.001197814941406  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.078548431396484  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.1960029602050781  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.1120858192443848  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.112985610961914  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.2360329627990723  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.97017288208008  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.047523498535156  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.2247271537780762  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.143461227416992  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.1443610191345215  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.2673726081848145  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.02577352523804  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.103124141693115  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.2565803527832031  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.1663756370544434  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.1672754287719727  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.287496566772461  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.80245113372803  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.879801750183105  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.2760348320007324  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.191987991333008  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.192887783050537  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.3221955299377441  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.08116579055786  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 51.15851640701294  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

number of input  19191295
----------------------------------------after optimizer
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.3745307922363281  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.264740467071533
pure train time :  8.076543807983398
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.014684438705444336
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030744314193725586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014737844467163086
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0481152534484863  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9623141288757324  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9632139205932617  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0870356559753418  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.633124351501465  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.681936264038086  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0512399673461914  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9691829681396484  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9700827598571777  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0950555801391602  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.912761211395264  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.99011182785034  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.0835580825805664  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.9995737075805664  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.0004734992980957  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.1216440200805664  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.87854528427124  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 50.95589590072632  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.1102104187011719  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.0286684036254883  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 2.0295681953430176  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.93792724609375 GB
    Memory Allocated: 1.1528730392456055  GigaBytes
Max Memory Allocated: 52.674349784851074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.25823974609375 GB
    Memory Allocated: 51.14015531539917  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 54.25823974609375 GB
    Memory Allocated: 51.21750593185425  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 55.32855224609375 GB
    Memory Allocated: 1.141904354095459  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.32855224609375 GB
    Memory Allocated: 2.0537190437316895  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.32855224609375 GB
    Memory Allocated: 2.0546188354492188  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.32855224609375 GB
    Memory Allocated: 1.1751189231872559  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 50.625009536743164  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 50.70236015319824  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 1.1646499633789062  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 2.0810599327087402  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 2.0819597244262695  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 1.2092595100402832  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 50.911827087402344  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 50.98917770385742  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 1.1992592811584473  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 2.1147046089172363  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 2.1156044006347656  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 1.238999366760254  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 50.78198766708374  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 50.85933828353882  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 1.2292671203613281  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 2.1385812759399414  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 2.1394810676574707  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33050537109375 GB
    Memory Allocated: 1.263902187347412  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.81519269943237  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.89254331588745  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.2542667388916016  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 2.1679000854492188  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 2.168799877166748  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.299290657043457  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.828659534454346  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.906010150909424  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.2889981269836426  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 2.2050957679748535  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 2.205995559692383  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.3322319984436035  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.92065763473511  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.99800777435303  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

number of input  19185519
----------------------------------------after optimizer
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.3850350379943848  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0639278888702393
pure train time :  8.887088298797607
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.014333486557006836
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03683900833129883
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014374971389770508
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.0495924949645996  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.9658989906311035  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.9667987823486328  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.0909714698791504  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.77942991256714  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.82690906524658  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.0560812950134277  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.9688892364501953  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.9697890281677246  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.0932731628417969  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.61165380477905  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.68900442123413  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.0834264755249023  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.99774169921875  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.9986414909362793  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.125706672668457  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.68557786941528  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.76292848587036  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.1171789169311523  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 2.036294937133789  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 2.0371947288513184  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.1622076034545898  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 51.08872699737549  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 51.166077613830566  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.151289939880371  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 2.0662360191345215  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 2.067135810852051  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.1878390312194824  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.902817249298096  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.980167865753174  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.1779375076293945  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 2.0890469551086426  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 2.089946746826172  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.2147254943847656  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.8162145614624  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 50.89356517791748  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.2041349411010742  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 2.1200904846191406  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 2.12099027633667  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.33245849609375 GB
    Memory Allocated: 1.2496552467346191  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.37347412109375 GB
    Memory Allocated: 50.815306663513184  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.37347412109375 GB
    Memory Allocated: 50.89265727996826  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 55.37347412109375 GB
    Memory Allocated: 1.2384305000305176  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.37347412109375 GB
    Memory Allocated: 2.154911994934082  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.37347412109375 GB
    Memory Allocated: 2.1558117866516113  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.37347412109375 GB
    Memory Allocated: 1.2796602249145508  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.37347412109375 GB
    Memory Allocated: 50.82070255279541  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 55.37347412109375 GB
    Memory Allocated: 50.89805316925049  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 55.37347412109375 GB
    Memory Allocated: 1.2693428993225098  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 55.37347412109375 GB
    Memory Allocated: 2.1860780715942383  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 55.37347412109375 GB
    Memory Allocated: 2.1869778633117676  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 55.37347412109375 GB
    Memory Allocated: 1.3098773956298828  GigaBytes
Max Memory Allocated: 52.71204328536987  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00433349609375 GB
    Memory Allocated: 51.15280294418335  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00433349609375 GB
    Memory Allocated: 51.23015356063843  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00433349609375 GB
    Memory Allocated: 1.2996125221252441  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00433349609375 GB
    Memory Allocated: 2.2124204635620117  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00433349609375 GB
    Memory Allocated: 2.213320255279541  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00433349609375 GB
    Memory Allocated: 1.3363127708435059  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.8089804649353  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.88633108139038  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

number of input  19188493
----------------------------------------after optimizer
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.388725757598877  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9448115825653076
pure train time :  8.085667848587036
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.014634370803833008
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0308072566986084
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014674901962280273
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.045651912689209  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9654254913330078  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.966325283050537  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0939698219299316  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.00579833984375  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.05392837524414  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0581159591674805  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.97816801071167  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9790678024291992  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0992560386657715  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.82836866378784  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.90571928024292  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0889487266540527  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0033297538757324  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0042295455932617  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.124030590057373  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.73040723800659  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.80775785446167  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.115687370300293  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.031320571899414  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0322203636169434  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.157667636871338  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.78944110870361  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.86679172515869  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1474361419677734  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0658702850341797  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.066770076751709  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.191063404083252  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.89335870742798  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.97070932388306  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1815485954284668  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0928702354431152  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0937700271606445  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2148046493530273  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.67226982116699  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.74962043762207  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2043285369873047  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.120211124420166  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1211109161376953  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2496991157531738  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.93447017669678  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.011820793151855  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.239041805267334  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.151294231414795  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.152194023132324  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2761211395263672  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.9349365234375  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.01228713989258  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2646026611328125  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.175924301147461  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1768240928649902  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.304368495941162  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.85326099395752  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.9306116104126  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2936177253723145  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.20273494720459  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.203634738922119  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3320050239562988  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.757400035858154  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.834750175476074  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

number of input  19185058
----------------------------------------after optimizer
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3846254348754883  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.851080894470215
pure train time :  8.088765621185303
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.016025066375732422
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029317855834960938
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01607537269592285
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.042212963104248  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9550790786743164  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9559788703918457  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0869312286376953  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.70634126663208  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.75421953201294  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0503668785095215  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9671101570129395  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9680099487304688  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.094985008239746  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.72705268859863  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.80440330505371  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0856833457946777  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0015816688537598  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.002481460571289  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1256866455078125  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.85275459289551  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.930105209350586  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1160130500793457  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.038590431213379  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.039490222930908  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1636147499084473  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.95728254318237  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.03463315963745  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1523466110229492  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0652127265930176  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.066112518310547  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.183356761932373  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.677658557891846  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.755009174346924  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1736516952514648  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0806288719177246  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.081528663635254  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2083945274353027  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.757121562957764  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.83447217941284  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1992297172546387  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1109933853149414  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1118931770324707  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2446880340576172  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.80809783935547  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.88544845581055  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2348847389221191  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.158047676086426  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.158947467803955  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2871503829956055  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.02894353866577  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.10629415512085  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2755870819091797  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.186333179473877  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1872329711914062  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3038067817687988  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.76741170883179  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.844762325286865  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2936677932739258  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.209249496459961  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.2101492881774902  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3393487930297852  GigaBytes
Max Memory Allocated: 52.71577072143555  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.193177700042725  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.270527839660645  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

number of input  19185213
----------------------------------------after optimizer
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3925509452819824  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7471330165863037
pure train time :  8.121774196624756
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.015280485153198242
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03497815132141113
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015331029891967773
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.049086570739746  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9696216583251953  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9705214500427246  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0954079627990723  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.01175785064697  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.059226989746094  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0577964782714844  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9695158004760742  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9704155921936035  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0890164375305176  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.671316146850586  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.748666763305664  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.079136848449707  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9947566986083984  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9956564903259277  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1238493919372559  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.83962106704712  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.9169716835022  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1148362159729004  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.029662609100342  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.030562400817871  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1547141075134277  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.72764015197754  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.80499076843262  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1455721855163574  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0594587326049805  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0603585243225098  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1854090690612793  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.83212757110596  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.909478187561035  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1747827529907227  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0865020751953125  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.087401866912842  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.213912010192871  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.68351602554321  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.76086664199829  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2037458419799805  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1174192428588867  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.118319034576416  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2464022636413574  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.84041976928711  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.91777038574219  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2361831665039062  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.151803970336914  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1527037620544434  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.278780460357666  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.708616733551025  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.7859673500061  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2678136825561523  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1823978424072266  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.183297634124756  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3067550659179688  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.98329734802246  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.06064796447754  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2959694862365723  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.2127885818481445  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.213688373565674  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3389372825622559  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.011383056640625  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.0887336730957  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

number of input  19185644
----------------------------------------after optimizer
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3918805122375488  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.672968864440918
pure train time :  8.2978036403656
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.01668095588684082
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03422403335571289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01673126220703125
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0500884056091309  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9661040306091309  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9670038223266602  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.090527057647705  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.771045207977295  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.81874990463257  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0535860061645508  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9626083374023438  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.963508129119873  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.087226390838623  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.66616106033325  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.74351167678833  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0780072212219238  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9940228462219238  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9949226379394531  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.125781536102295  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.8678297996521  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.94518041610718  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.116250991821289  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0351853370666504  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0360851287841797  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1599574089050293  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.85208606719971  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.929436683654785  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1490082740783691  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.063265800476074  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0641655921936035  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1851296424865723  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.917712688446045  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.99506330490112  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1739187240600586  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.089108467102051  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.09000825881958  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2153172492980957  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.78997564315796  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.86732625961304  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2055339813232422  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1215596199035645  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1224594116210938  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2471556663513184  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.015835762023926  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.093186378479004  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2381396293640137  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1523513793945312  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1532511711120605  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.277000904083252  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.85106372833252  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.9284143447876  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.265920639038086  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1824965476989746  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.183396339416504  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.308518886566162  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.94117021560669  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.01852083206177  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2968969345092773  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.210550308227539  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.2114500999450684  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3338007926940918  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.78687763214111  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.86422777175903  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

number of input  19187124
----------------------------------------after optimizer
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3870253562927246  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.619994640350342
pure train time :  8.094162225723267
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.016691207885742188
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03333711624145508
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016739606857299805
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0465331077575684  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.95900297164917  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9599027633666992  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0864357948303223  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.686400413513184  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.73449468612671  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0504684448242188  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.969205379486084  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9701051712036133  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0975027084350586  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.76175546646118  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.8392915725708  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0878500938415527  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.002450942993164  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0033507347106934  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1244215965270996  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.736857891082764  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.81420850753784  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1142501831054688  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0266823768615723  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0275821685791016  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1527233123779297  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.66628694534302  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.743637561798096  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1420907974243164  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.059079647064209  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0599794387817383  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1874008178710938  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.94419288635254  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.02154350280762  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.176842212677002  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0956788063049316  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.096578598022461  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.219512939453125  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.04298782348633  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.120338439941406  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.20851469039917  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1225085258483887  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.123408317565918  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2444477081298828  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.8554425239563  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.93279314041138  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2360730171203613  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1528053283691406  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.15370512008667  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2796568870544434  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.05875873565674  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.136109352111816  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2683672904968262  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1846585273742676  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.185558319091797  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3087010383605957  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.95650815963745  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.03385877609253  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2989649772644043  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.208414077758789  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.2093138694763184  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3319835662841797  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.83862352371216  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.915974140167236  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

number of input  19190056
----------------------------------------after optimizer
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3851652145385742  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5415616035461426
pure train time :  8.061591148376465
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.01687335968017578
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0321354866027832
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016928911209106445
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0422463417053223  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9597954750061035  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9606952667236328  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0916247367858887  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.87845993041992  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.926636695861816  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0551080703735352  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9725713729858398  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9734711647033691  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.095832347869873  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.82519817352295  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.90254878997803  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.086064338684082  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0003466606140137  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.001246452331543  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.123368263244629  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.56580972671509  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.643160343170166  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1140861511230469  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.028477191925049  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.029376983642578  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.154902458190918  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.815696239471436  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.893046855926514  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.14365816116333  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0581822395324707  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.05908203125  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.184432029724121  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.744250774383545  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.82160139083862  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1743474006652832  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.08402681350708  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0849266052246094  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2100682258605957  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.72759485244751  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.80494546890259  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2006516456604004  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1170878410339355  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.117987632751465  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2481427192687988  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.98713493347168  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.06448554992676  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2380561828613281  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.15055513381958  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1514549255371094  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2748346328735352  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.86369562149048  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.94104623794556  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2638731002807617  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1794581413269043  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1803579330444336  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3077073097229004  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.96031427383423  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.03766489028931  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2961583137512207  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.214099407196045  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.214999198913574  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3386898040771484  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.957491874694824  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.034842014312744  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

number of input  19189676
----------------------------------------after optimizer
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3912091255187988  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.481104850769043
pure train time :  8.09047532081604
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.016002178192138672
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03688383102416992
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01612234115600586
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.050199031829834  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9638376235961914  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9647374153137207  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.086742877960205  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.8743577003479  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.92307376861572  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0513005256652832  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9689793586730957  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.969879150390625  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.095344066619873  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.74410533905029  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.82145595550537  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0841917991638184  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.00111722946167  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.002017021179199  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1242117881774902  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.734830379486084  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.81218099594116  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1138534545898438  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0298690795898438  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.030768871307373  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.153773307800293  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.868075370788574  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.94542598724365  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1436614990234375  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0587005615234375  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.059600353240967  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1835899353027344  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.118123054504395  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.19547367095947  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1737174987792969  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0870423316955566  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.087942123413086  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.212752342224121  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.673158168792725  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.7505087852478  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.202718734741211  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1181530952453613  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1190528869628906  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2455635070800781  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.811094760894775  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.88844537734985  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2361102104187012  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1514062881469727  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.152306079864502  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2767386436462402  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.94916868209839  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.02698802947998  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2653923034667969  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.178112030029297  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.179011821746826  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3034567832946777  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.79345178604126  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.87080240249634  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2934489250183105  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.2088069915771484  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.2097067832946777  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3368544578552246  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.89625644683838  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.9736065864563  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

number of input  19191513
----------------------------------------after optimizer
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3892998695373535  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4270806312561035
pure train time :  8.102060079574585
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.015370845794677734
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.031644582748413086
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015410661697387695
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0482311248779297  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9659934043884277  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.966893196105957  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0918059349060059  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.803696155548096  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.851797103881836  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0549192428588867  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.967513084411621  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9684128761291504  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.090230941772461  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.748862743377686  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.826213359832764  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.080674171447754  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.9960999488830566  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.996999740600586  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1242117881774902  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.587096214294434  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.66444683074951  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.112637996673584  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0311264991760254  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0320262908935547  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1565818786621094  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.91172170639038  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.98907232284546  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.146286964416504  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.062671661376953  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0635714530944824  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.184901237487793  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.69308662414551  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.770437240600586  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1754016876220703  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.089597225189209  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.0904970169067383  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.213942527770996  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.82994985580444  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.90730047225952  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2032661437988281  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.113827705383301  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.11472749710083  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2403926849365234  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.838818073272705  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.91616868972778  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2293024063110352  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1426234245300293  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1435232162475586  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2728204727172852  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 50.9367880821228  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 51.01413869857788  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.2621431350708008  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.1779003143310547  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 2.178800106048584  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.3054370880126953  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 51.037155628204346  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 51.114506244659424  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.293940544128418  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.2081656455993652  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.2090654373168945  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.3331809043884277  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.95701885223389  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 51.03436899185181  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

number of input  19186247
----------------------------------------after optimizer
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.3861603736877441  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3815207481384277
pure train time :  8.075517416000366
the output layer 
self.num_batch (get_in_degree_bucketing) 10
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  10
random partition time  0.015094518661499023
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030676603317260742
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015137910842895508
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.0475916862487793  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.9644627571105957  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.965362548828125  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.0913934707641602  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.63974714279175  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.68735456466675  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.054222583770752  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.9689669609069824  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.9698667526245117  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.0928616523742676  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.64981698989868  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.72716760635376  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.0829362869262695  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.9957118034362793  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.9966115951538086  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.121741771697998  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.7692928314209  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.84664344787598  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.1113519668579102  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.021958351135254  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.022858142852783  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.1491379737854004  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.77623271942139  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.853583335876465  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.1400718688964844  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.0568737983703613  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.0577735900878906  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.186995506286621  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.83891534805298  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.91626596450806  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.1760187149047852  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.0908265113830566  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.091726303100586  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.2147469520568848  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.95962333679199  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 51.03697395324707  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.2058582305908203  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.117445468902588  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.118345260620117  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.2433319091796875  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.80683374404907  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.88418436050415  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.2322144508361816  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.149947166442871  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.1508469581604004  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.2784199714660645  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 51.03038454055786  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 51.10773515701294  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.2682294845581055  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.181934356689453  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.1828341484069824  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.304154872894287  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 50.94496393203735  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 51.02231454849243  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.2938361167907715  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.2119827270507812  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 2.2128825187683105  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.3390803337097168  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 51.09798765182495  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 51.17533779144287  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

number of input  19184282
----------------------------------------after optimizer
 Nvidia-smi: 60.39300537109375 GB
    Memory Allocated: 1.3917899131774902  GigaBytes
Max Memory Allocated: 52.75888395309448  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3387792110443115
pure train time :  8.051750898361206
epoch_time_list  [44.296425580978394, 43.70045590400696, 44.42841553688049, 44.30387258529663, 44.5598042011261, 43.4060697555542, 47.479880571365356, 44.42278552055359, 43.77969527244568, 45.494630336761475, 43.43200421333313, 42.665529012680054, 43.50148010253906, 44.14879608154297, 43.57220935821533, 42.78827714920044, 43.26344561576843, 43.58581471443176, 42.541011095047, 42.35352826118469]

loading_time list   [0.8687489032745361, 0.8697860240936279, 0.9797940254211426, 0.9821648597717285, 0.9300277233123779, 0.8724071979522705, 0.8458652496337891, 0.8617022037506104, 1.0144729614257812, 0.7862865924835205, 1.0256321430206299, 0.7984142303466797, 0.8058280944824219, 0.8725049495697021, 1.0113861560821533, 0.792844295501709, 0.7839646339416504, 0.8189847469329834, 0.8054606914520264, 0.785240888595581]

 data loader gen time  30.26635193824768
	---backpack schedule time  [0.19274568557739258, 0.18715572357177734, 0.1775977611541748, 0.180647611618042, 0.19420337677001953, 0.1828751564025879, 0.1743178367614746, 0.18805766105651855, 0.17715692520141602, 0.1774296760559082, 0.19017791748046875, 0.17766141891479492, 0.17170166969299316, 0.18178629875183105, 0.1853773593902588, 0.17963194847106934, 0.1780683994293213, 0.19854068756103516, 0.1821889877319336, 0.17471551895141602]
	---connection_check_time_list  [5.960615396499634, 5.750955581665039, 5.946200370788574, 6.703563213348389, 7.111128091812134, 5.847768545150757, 9.559499502182007, 5.909079551696777, 5.708371877670288, 7.167135953903198, 5.6610939502716064, 5.299496173858643, 6.227266311645508, 6.246468782424927, 5.697969913482666, 5.34963321685791, 6.18858528137207, 6.332813024520874, 5.371675729751587, 5.273511648178101]
	---block_gen_time_list  [3.017951726913452, 2.9087541103363037, 2.937807083129883, 2.7878470420837402, 2.608394145965576, 2.7048611640930176, 2.9745187759399414, 2.7932989597320557, 3.0128207206726074, 2.60038161277771, 2.632056713104248, 2.541701555252075, 2.6285831928253174, 2.627419948577881, 2.767942190170288, 2.7162585258483887, 2.6462230682373047, 2.6735222339630127, 2.4798145294189453, 2.548081398010254]
training time  [11.90187668800354, 11.58421802520752, 12.020399808883667, 11.10761022567749, 11.270161151885986, 11.397773742675781, 11.23018479347229, 12.092795133590698, 11.382122278213501, 12.189299583435059, 11.466929197311401, 11.438890933990479, 11.16732120513916, 11.784451007843018, 11.42147970199585, 11.42829942703247, 11.11881971359253, 11.268725633621216, 11.359344720840454, 11.283154726028442]
---feature block loading time  [2.906621217727661, 3.5613722801208496, 3.975149393081665, 3.274052619934082, 3.415940046310425, 3.4309256076812744, 3.1246395111083984, 3.773695230484009, 3.2894020080566406, 3.2865793704986572, 3.3657166957855225, 3.3342278003692627, 3.0279037952423096, 3.470381736755371, 3.31063175201416, 3.3495230674743652, 3.0104238986968994, 3.151015043258667, 3.2688050270080566, 3.2159833908081055]


epoch_time avg   43.81218507885933
loading_time avg   0.8631889224052429
 data loader gen time avg 31.473101437091827
	---backpack schedule time avg 0.18211817741394043
	---connection_check_time avg  6.184468597173691
	---block_gen_time avg  2.684742420911789
training time  11.456234559416771
---feature block loading time  3.3016121238470078
pure train time per /epoch  [8.982020139694214, 8.005347490310669, 8.028001308441162, 7.816631078720093, 7.837522029876709, 7.9497387409210205, 8.089163541793823, 8.303236484527588, 8.076543807983398, 8.887088298797607, 8.085667848587036, 8.088765621185303, 8.121774196624756, 8.2978036403656, 8.094162225723267, 8.061591148376465, 8.09047532081604, 8.102060079574585, 8.075517416000366, 8.051750898361206]
pure train time average  8.11938190460205
num_input list  [19189133, 19189825, 19184071, 19184904, 19184517, 19188174, 19185630, 19192723, 19191295, 19185519, 19188493, 19185058, 19185213, 19185644, 19187124, 19190056, 19189676, 19191513, 19186247, 19184282]
num_input  average  19187454.85
