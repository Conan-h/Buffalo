main start at this time 1714083714.5149622
-----------------------------------------before load data 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
# Nodes: 111059956
# Edges: 1615685872
# Train: 1207179
# Val: 125265
# Test: 109727512
# Classes: 172

----------------------------------------start of run function 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.013843297958374023
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0394136905670166
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.013914108276367188
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 1.22113037109375 GB
    Memory Allocated: 0.003025054931640625  GigaBytes
Max Memory Allocated: 0.003025054931640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.77972412109375 GB
    Memory Allocated: 0.5596890449523926  GigaBytes
Max Memory Allocated: 0.5596890449523926  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.77972412109375 GB
    Memory Allocated: 0.5600638389587402  GigaBytes
Max Memory Allocated: 0.5600638389587402  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.79925537109375 GB
    Memory Allocated: 0.5802617073059082  GigaBytes
Max Memory Allocated: 0.5802617073059082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 26.95941162109375 GB
    Memory Allocated: 24.832640171051025  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 26.95941162109375 GB
    Memory Allocated: 24.86487102508545  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 27.41058349609375 GB
    Memory Allocated: 0.6239385604858398  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 27.41058349609375 GB
    Memory Allocated: 1.1813912391662598  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 27.41058349609375 GB
    Memory Allocated: 1.1817660331726074  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 27.41058349609375 GB
    Memory Allocated: 0.6452274322509766  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 24.784811973571777  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 24.817042350769043  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 0.6387763023376465  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 1.1956281661987305  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 1.1960029602050781  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 0.6581554412841797  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 24.802884578704834  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 24.8351149559021  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 0.6510648727416992  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 1.2077288627624512  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 1.2081036567687988  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 28.15472412109375 GB
    Memory Allocated: 0.6709051132202148  GigaBytes
Max Memory Allocated: 25.4527006149292  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 24.92737102508545  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 24.959601402282715  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 0.6633424758911133  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 1.21830415725708  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 1.2186789512634277  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 0.6815567016601562  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 24.79548692703247  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 24.827717304229736  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 0.6737494468688965  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 1.2292399406433105  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 1.2296147346496582  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 0.6942291259765625  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 24.871795654296875  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 24.90402603149414  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 0.6872730255126953  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 1.243776798248291  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 1.2441515922546387  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 0.7082085609436035  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 24.781632900238037  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 24.813863277435303  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 0.701270580291748  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 1.2593493461608887  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 1.2597241401672363  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 29.95159912109375 GB
    Memory Allocated: 0.7229118347167969  GigaBytes
Max Memory Allocated: 25.576067447662354  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 31.01409912109375 GB
    Memory Allocated: 25.014355659484863  GigaBytes
Max Memory Allocated: 25.667877197265625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 31.01409912109375 GB
    Memory Allocated: 25.04658603668213  GigaBytes
Max Memory Allocated: 25.667877197265625  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 31.01409912109375 GB
    Memory Allocated: 0.7154073715209961  GigaBytes
Max Memory Allocated: 25.667877197265625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 31.01409912109375 GB
    Memory Allocated: 1.2757949829101562  GigaBytes
Max Memory Allocated: 25.667877197265625  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 31.01409912109375 GB
    Memory Allocated: 1.276169776916504  GigaBytes
Max Memory Allocated: 25.667877197265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 31.01409912109375 GB
    Memory Allocated: 0.7386460304260254  GigaBytes
Max Memory Allocated: 25.667877197265625  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.089460849761963  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.12169122695923  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.7314186096191406  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.2827577590942383  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.283132553100586  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.7423529624938965  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 24.759355545043945  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 24.79158592224121  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.7344703674316406  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.290043830871582  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.2904186248779297  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.7589449882507324  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 24.97195339202881  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.004183769226074  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.7523198127746582  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3079943656921387  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3083691596984863  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.7724661827087402  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 24.805819034576416  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 24.83804941177368  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.7652945518493652  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3228378295898438  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3232126235961914  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.7872567176818848  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.028756141662598  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.060986518859863  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.781102180480957  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3390803337097168  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3394551277160645  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.8016133308410645  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.055853843688965  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.088085651397705  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.7946195602416992  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3567852973937988  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3571600914001465  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.8188862800598145  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.078179359436035  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.1104097366333  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.8115749359130859  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3718485832214355  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3722233772277832  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.8297834396362305  GigaBytes
Max Memory Allocated: 25.74295997619629  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.115735054016113  GigaBytes
Max Memory Allocated: 25.767578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.14796543121338  GigaBytes
Max Memory Allocated: 25.767578125  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.8232865333557129  GigaBytes
Max Memory Allocated: 25.767578125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3767814636230469  GigaBytes
Max Memory Allocated: 25.767578125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3771562576293945  GigaBytes
Max Memory Allocated: 25.767578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.8365402221679688  GigaBytes
Max Memory Allocated: 25.767578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 24.985870361328125  GigaBytes
Max Memory Allocated: 25.767578125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.01810073852539  GigaBytes
Max Memory Allocated: 25.767578125  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.8289918899536133  GigaBytes
Max Memory Allocated: 25.767578125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3893094062805176  GigaBytes
Max Memory Allocated: 25.767578125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.3896842002868652  GigaBytes
Max Memory Allocated: 25.767578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.855919361114502  GigaBytes
Max Memory Allocated: 25.767578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.148133277893066  GigaBytes
Max Memory Allocated: 25.800496101379395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.180363655090332  GigaBytes
Max Memory Allocated: 25.800496101379395  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.8485193252563477  GigaBytes
Max Memory Allocated: 25.800496101379395  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.408750057220459  GigaBytes
Max Memory Allocated: 25.800496101379395  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.4091248512268066  GigaBytes
Max Memory Allocated: 25.800496101379395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.8685321807861328  GigaBytes
Max Memory Allocated: 25.800496101379395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.173229694366455  GigaBytes
Max Memory Allocated: 25.825261116027832  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.20546007156372  GigaBytes
Max Memory Allocated: 25.825261116027832  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.861363410949707  GigaBytes
Max Memory Allocated: 25.825261116027832  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.4168529510498047  GigaBytes
Max Memory Allocated: 25.825261116027832  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.4172277450561523  GigaBytes
Max Memory Allocated: 25.825261116027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.8766541481018066  GigaBytes
Max Memory Allocated: 25.825261116027832  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.037985801696777  GigaBytes
Max Memory Allocated: 25.825261116027832  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.070216178894043  GigaBytes
Max Memory Allocated: 25.825261116027832  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.8692607879638672  GigaBytes
Max Memory Allocated: 25.825261116027832  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.4311466217041016  GigaBytes
Max Memory Allocated: 25.825261116027832  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.4315214157104492  GigaBytes
Max Memory Allocated: 25.825261116027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.895782470703125  GigaBytes
Max Memory Allocated: 25.825261116027832  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.238892555236816  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 25.271122932434082  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.8887815475463867  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.4461350440979004  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 1.446509838104248  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27386474609375 GB
    Memory Allocated: 0.9043211936950684  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.12235736846924  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.154587745666504  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.8982734680175781  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.455491065979004  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.4558658599853516  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.9181761741638184  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.074079990386963  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.10631036758423  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.9113245010375977  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.4696135520935059  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.4699883460998535  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.932466983795166  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.14973783493042  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.181954860687256  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

number of input  28054321
----------------------------------------after optimizer
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.9644646644592285  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.175565719604492
pure train time :  12.08925986289978
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.015509843826293945
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03510427474975586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015567779541015625
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.6304931640625  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.1880903244018555  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.1884651184082031  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.650545597076416  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.85419511795044  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.872093200683594  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.6318025588989258  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.1902971267700195  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.1906719207763672  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.6527681350708008  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.938827991485596  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.97105836868286  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.6450223922729492  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.2002229690551758  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.2005977630615234  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.6617493629455566  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.794788360595703  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.82701873779297  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.6540136337280273  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.2154545783996582  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.2158293724060059  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.680516242980957  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.99775457382202  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.029984951019287  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.6724438667297363  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.229306697845459  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.2296814918518066  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.6878829002380371  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.85813856124878  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.890368938446045  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.6815776824951172  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.2367782592773438  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.2371530532836914  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.7006454467773438  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.729109287261963  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.76133966445923  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.6934800148010254  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.250744342803955  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.2511191368103027  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.7156004905700684  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.986097812652588  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.018328189849854  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.7080268859863281  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.2651286125183105  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.2655034065246582  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.7278652191162109  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.88620615005493  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.918436527252197  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.7214016914367676  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.2787542343139648  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.2791290283203125  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.7416448593139648  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.80431842803955  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.836915493011475  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.7333917617797852  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.291656494140625  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.2920312881469727  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.7543854713439941  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.05428457260132  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.086514949798584  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.7479581832885742  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.3059425354003906  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.3063173294067383  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.76776123046875  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.070204734802246  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.10243511199951  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.7601728439331055  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.3180670738220215  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.3184418678283691  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.7800827026367188  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.916531562805176  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.94876194000244  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.7741231918334961  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.3293237686157227  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.3296985626220703  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.7914371490478516  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.900434970855713  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.93266534805298  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.785954475402832  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.3421516418457031  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.3425264358520508  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.8069462776184082  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.838167667388916  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 24.87039804458618  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.8013105392456055  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.359407901763916  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.3597826957702637  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.8232250213623047  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.013415336608887  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 25.045645713806152  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.8160896301269531  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.371605396270752  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 1.3719801902770996  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.27777099609375 GB
    Memory Allocated: 0.8335027694702148  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.28753662109375 GB
    Memory Allocated: 25.001344203948975  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.28753662109375 GB
    Memory Allocated: 25.03357458114624  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 37.28753662109375 GB
    Memory Allocated: 0.8276228904724121  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.28753662109375 GB
    Memory Allocated: 1.3879823684692383  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.28753662109375 GB
    Memory Allocated: 1.388357162475586  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.28753662109375 GB
    Memory Allocated: 0.8526778221130371  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.28753662109375 GB
    Memory Allocated: 25.13752508163452  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 37.28753662109375 GB
    Memory Allocated: 25.169755458831787  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 37.28753662109375 GB
    Memory Allocated: 0.845036506652832  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 37.28753662109375 GB
    Memory Allocated: 1.4057707786560059  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 37.28753662109375 GB
    Memory Allocated: 1.4061455726623535  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 37.28753662109375 GB
    Memory Allocated: 0.8655157089233398  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 25.183772563934326  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 25.216002941131592  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 0.8589315414428711  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 1.4153709411621094  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 1.415745735168457  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 0.8746228218078613  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 25.054646492004395  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 25.08687686920166  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 0.8668212890625  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 1.4239068031311035  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 1.4242815971374512  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 0.8879399299621582  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 25.143675804138184  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 25.17590618133545  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 0.8803467750549316  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 1.4417567253112793  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 1.442131519317627  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 38.61956787109375 GB
    Memory Allocated: 0.9049510955810547  GigaBytes
Max Memory Allocated: 25.894425868988037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 25.264753818511963  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 25.29698419570923  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.8972392082214355  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.4490256309509277  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.4494004249572754  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.9075770378112793  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.87633180618286  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.908562183380127  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.9005217552185059  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.4562153816223145  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.456590175628662  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.9252986907958984  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 25.07008934020996  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 25.102319717407227  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.9185070991516113  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.4788637161254883  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.479238510131836  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.9433145523071289  GigaBytes
Max Memory Allocated: 25.917912006378174  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 25.31026792526245  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 25.342498302459717  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28057190
----------------------------------------after optimizer
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.9677896499633789  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.745417594909668
pure train time :  11.243251085281372
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.01691913604736328
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03117966651916504
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016980886459350586
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.6308908462524414  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.1894845962524414  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.189859390258789  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.6496267318725586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.771156787872314  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.79085683822632  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.6324238777160645  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.1879606246948242  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.1883354187011719  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.6493172645568848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.733148097991943  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.76537847518921  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.641512393951416  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.195329189300537  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.1957039833068848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.6599588394165039  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.765852451324463  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.79808282852173  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.652259349822998  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.2089104652404785  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.2092852592468262  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.6752820014953613  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.86502981185913  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.897260189056396  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.6677608489990234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.228222370147705  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.2285971641540527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.6918148994445801  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 25.002891063690186  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 25.03512144088745  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.6848893165588379  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.2439780235290527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.2443528175354004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.7044234275817871  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.985682487487793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 25.01791286468506  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.698035717010498  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.2554535865783691  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.2558283805847168  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.7165474891662598  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.91311025619507  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.945340633392334  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.7089648246765137  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.2668681144714355  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.2672429084777832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.7305588722229004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 25.02058506011963  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 25.052815437316895  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.7232098579406738  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.2793569564819336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.2797317504882812  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.7414608001708984  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.897573471069336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 24.9298038482666  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.733771800994873  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.289860725402832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.2902355194091797  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.755617618560791  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 25.0005784034729  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 25.032808780670166  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.7493190765380859  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.308286190032959  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 1.3086609840393066  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.35980224609375 GB
    Memory Allocated: 0.7724647521972656  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 25.128828525543213  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 25.16105890274048  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 0.7646489143371582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 1.325282096862793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 1.3256568908691406  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 0.786555290222168  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 25.1030330657959  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 25.135263442993164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 0.7788891792297363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 1.3369698524475098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 1.3373446464538574  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 0.7966012954711914  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 25.16246271133423  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 25.194693088531494  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 0.7917814254760742  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 1.3476543426513672  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 1.3480291366577148  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 0.8097395896911621  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 24.96962022781372  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 25.002322673797607  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 0.8017373085021973  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 1.3538589477539062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 1.354233741760254  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 0.8181500434875488  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 24.912415027618408  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 24.944645404815674  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 0.8101820945739746  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 1.3687934875488281  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 1.3691682815551758  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 0.8368382453918457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 24.99944496154785  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 25.031675338745117  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 0.8305525779724121  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 1.3860692977905273  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 1.386444091796875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.42816162109375 GB
    Memory Allocated: 0.8474187850952148  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.879679679870605  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.91191005706787  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8396596908569336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.399632453918457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4000072479248047  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.864349365234375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.17433500289917  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.206565380096436  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.856809139251709  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4171819686889648  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4175567626953125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8774218559265137  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.09911012649536  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.131340503692627  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8701238632202148  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.423940658569336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4243154525756836  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8835811614990234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.964932441711426  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.99716281890869  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8757619857788086  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4356260299682617  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4360008239746094  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.9020400047302246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.15629291534424  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.188523292541504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8951706886291504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4518637657165527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4522385597229004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.9121942520141602  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.9720401763916  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.004270553588867  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.9043369293212891  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.459825038909912  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4601998329162598  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.9233150482177734  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.962323665618896  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.994554042816162  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.9158873558044434  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4765715599060059  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4769463539123535  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.9421358108520508  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.249630451202393  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.28184747695923  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28054798
----------------------------------------after optimizer
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.966949462890625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.52849817276001
pure train time :  11.70465087890625
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.015495538711547852
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03116464614868164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015552043914794922
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6316819190979004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.1848440170288086  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.1852188110351562  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6447281837463379  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.8387713432312  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.85787582397461  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6272549629211426  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.1884632110595703  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.188838005065918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6554646492004395  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.030779361724854  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.06300973892212  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6478047370910645  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2063984870910645  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.206773281097412  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.666083812713623  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.812644481658936  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.8448748588562  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6589174270629883  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.220975399017334  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2213501930236816  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.682523250579834  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.966293334960938  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.998523712158203  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6752028465270996  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2326602935791016  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2330350875854492  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6907410621643066  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.951477527618408  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.983707904815674  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6834192276000977  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2359442710876465  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2363190650939941  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6985931396484375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.70946168899536  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.741692066192627  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6920247077941895  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2508492469787598  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2512240409851074  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.7185196876525879  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.02109146118164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.053321838378906  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.711186408996582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2668118476867676  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2671866416931152  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.728142261505127  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.038647651672363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.07087802886963  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.7207026481628418  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.280214786529541  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2805895805358887  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.7447366714477539  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.03892469406128  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.071155071258545  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.7368435859680176  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2949142456054688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2952890396118164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.7555246353149414  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.919143676757812  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.951374053955078  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.7484049797058105  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.304030418395996  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.3044052124023438  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.7660255432128906  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.935813426971436  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.9680438041687  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.7596735954284668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.3158817291259766  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.3162565231323242  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.7803077697753906  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.953855514526367  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.986085891723633  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.7727746963500977  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.3311090469360352  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.3314838409423828  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.7949814796447754  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.00937509536743  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.041605472564697  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.7872915267944336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.341865062713623  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.3422398567199707  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8035678863525391  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.867220401763916  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.89945077896118  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.7964224815368652  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.356454849243164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.3568296432495117  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8219857215881348  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.09203863143921  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.124269008636475  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8146724700927734  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.3736333847045898  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.3740081787109375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8344883918762207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.133800983428955  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.16603136062622  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8287215232849121  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.3814654350280762  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.3818402290344238  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.843437671661377  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.938387870788574  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.97104787826538  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8363170623779297  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.3966522216796875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.3970270156860352  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8639512062072754  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.98619031906128  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.018420696258545  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.856776237487793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4134407043457031  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4138154983520508  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8731932640075684  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.098666667938232  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.130897045135498  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8660697937011719  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4241600036621094  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.424534797668457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8882598876953125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.98688793182373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.019118309020996  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8805966377258301  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.439056396484375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4394311904907227  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.9012789726257324  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.142308235168457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.174538612365723  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.8945846557617188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4518189430236816  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4521937370300293  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.9135375022888184  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.199248790740967  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.231479167938232  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.9065313339233398  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4655752182006836  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4659500122070312  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.9284424781799316  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.207085132598877  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.239315509796143  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.9221391677856445  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.4767627716064453  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.477137565612793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.9377059936523438  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.071839809417725  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 25.10405683517456  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28053608
----------------------------------------after optimizer
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.9623847007751465  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.300775527954102
pure train time :  12.582101821899414
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.015644550323486328
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.05159711837768555
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015744924545288086
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6255779266357422  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.1796259880065918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.1800007820129395  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.645726203918457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.802765369415283  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.821913242340088  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6283979415893555  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.183366298675537  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.1837410926818848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6498394012451172  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.894078254699707  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.926308631896973  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6422743797302246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.1988143920898438  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.1991891860961914  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6641020774841309  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.693035125732422  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 24.725265502929688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6567907333374023  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2173948287963867  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 1.2177696228027344  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.43597412109375 GB
    Memory Allocated: 0.6810870170593262  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.13099479675293  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.163225173950195  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.6735477447509766  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.231457233428955  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2318320274353027  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.6908164024353027  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.772733211517334  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.8049635887146  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.6834611892700195  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2400012016296387  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2403759956359863  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7020225524902344  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.78809642791748  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.820326805114746  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.694854736328125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2532997131347656  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2536745071411133  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7167973518371582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.973318576812744  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.00554895401001  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.708979606628418  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2682113647460938  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2685861587524414  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7298564910888672  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.02717876434326  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.059409141540527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7226214408874512  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.282327651977539  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2827024459838867  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7431802749633789  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.05107307434082  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.083303451538086  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7356562614440918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2936968803405762  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2940716743469238  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7545018196105957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.057425498962402  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.089655876159668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7471966743469238  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3015122413635254  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.301887035369873  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7639565467834473  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.98527479171753  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.017505168914795  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7576894760131836  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3142704963684082  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3146452903747559  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7800049781799316  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.0188889503479  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.051119327545166  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7722086906433105  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3340792655944824  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.33445405960083  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7975645065307617  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.088736534118652  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.120966911315918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7896370887756348  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3465275764465332  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3469023704528809  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8046002388000488  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.92453384399414  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.956764221191406  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.796905517578125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3536086082458496  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3539834022521973  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8169417381286621  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.90235185623169  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.934582233428955  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8111996650695801  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3667726516723633  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.367147445678711  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8300466537475586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.94746446609497  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.979694843292236  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8240480422973633  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.381598949432373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3819737434387207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8460407257080078  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.048291206359863  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.08052158355713  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8387222290039062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3960685729980469  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3964433670043945  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.858518123626709  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.046552658081055  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.07878303527832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8514194488525391  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4083456993103027  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4087204933166504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8709845542907715  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.02772045135498  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.059950828552246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8643989562988281  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4233789443969727  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4237537384033203  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8864688873291016  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.099789142608643  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.132019519805908  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8786749839782715  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4335813522338867  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4339561462402344  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8952245712280273  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.068289756774902  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.100520133972168  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8898906707763672  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4450726509094238  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4454474449157715  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.9101505279541016  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.99149513244629  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.023725509643555  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.9055700302124023  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4630885124206543  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.463463306427002  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.9286808967590332  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.24315643310547  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.275386810302734  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.9227142333984375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4815864562988281  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4819612503051758  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.9440708160400391  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.14150905609131  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.173739433288574  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28049201
----------------------------------------after optimizer
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.9696578979492188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.999462842941284
pure train time :  12.018417119979858
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.014801025390625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.040955305099487305
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014894962310791016
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.6303915977478027  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.1889853477478027  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.1893601417541504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.6503405570983887  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.860815048217773  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.879397869110107  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.6330218315124512  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.1951713562011719  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.1955461502075195  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.6567878723144531  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.065638065338135  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.0978684425354  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.6494526863098145  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2057480812072754  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.206122875213623  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.6642932891845703  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.96127414703369  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.993504524230957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.6565642356872559  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2153019905090332  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2156767845153809  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.679105281829834  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.89910078048706  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.931331157684326  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.671630859375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2286481857299805  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2290229797363281  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.6899828910827637  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.878201484680176  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.91043186187744  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.6828451156616211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2413325309753418  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2417073249816895  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.704383373260498  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.85455322265625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.886783599853516  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.6978092193603516  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2549152374267578  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2552900314331055  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.716529369354248  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.93265962600708  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.964890003204346  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.708777904510498  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.263193130493164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2635679244995117  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7270331382751465  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.802330493927002  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.834560871124268  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7190628051757812  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2739505767822266  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2743253707885742  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7396054267883301  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.903112411499023  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.93534278869629  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7320141792297363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.2885327339172363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.288907527923584  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.753720760345459  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.94067144393921  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.972901821136475  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7460513114929199  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.305708885192871  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3060836791992188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7693109512329102  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.052917003631592  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.085147380828857  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7621684074401855  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3205151557922363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.320889949798584  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7809896469116211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.04389190673828  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.076122283935547  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7735261917114258  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3309097290039062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.331284523010254  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.792668342590332  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.980562686920166  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.01279306411743  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7861943244934082  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3447566032409668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3451313972473145  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8074765205383301  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.989365100860596  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.02159547805786  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.7994856834411621  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3546581268310547  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3550329208374023  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8170623779296875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.026784896850586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.05901527404785  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8098797798156738  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3659720420837402  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.366346836090088  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8308291435241699  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.040281772613525  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.07251214981079  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.824129581451416  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3884000778198242  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.3887748718261719  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8527240753173828  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.07822608947754  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.110456466674805  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.847010612487793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4048562049865723  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.40523099899292  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8610124588012695  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.082629203796387  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.114859580993652  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8527097702026367  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4040374755859375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4044122695922852  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8665928840637207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.892752647399902  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.924983024597168  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.858583927154541  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4158978462219238  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4162726402282715  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8849959373474121  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.09954023361206  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.131770610809326  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8772783279418945  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4388113021850586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4391860961914062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.9019904136657715  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.283008575439453  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 25.31523895263672  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.8947587013244629  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.448934555053711  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4493093490600586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.9080038070678711  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.901379108428955  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 24.93360948562622  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.9018726348876953  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.4629902839660645  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 1.463365077972412  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85003662109375 GB
    Memory Allocated: 0.9293055534362793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.29263973236084  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.324870109558105  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9239392280578613  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4759507179260254  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.476325511932373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9348959922790527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.904705047607422  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.937540531158447  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28056583
----------------------------------------after optimizer
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9586443901062012  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.73603892326355
pure train time :  12.030437707901001
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.014390230178833008
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03375411033630371
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014447450637817383
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6224169731140137  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1863975524902344  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.186772346496582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6558032035827637  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.941506385803223  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.96120309829712  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6383676528930664  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1969614028930664  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.197336196899414  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6536855697631836  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.916184902191162  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.948415279388428  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6458916664123535  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2045798301696777  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2049546241760254  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6672320365905762  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.972327709197998  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.004558086395264  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6598982810974121  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2204947471618652  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.220869541168213  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6822528839111328  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.929615020751953  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.96184539794922  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.675811767578125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2356209754943848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2359957695007324  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.695465087890625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.91279888153076  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.945029258728027  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.688748836517334  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.247342586517334  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2477173805236816  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7079834938049316  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.99107837677002  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.023308753967285  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7002010345458984  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2576870918273926  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2580618858337402  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7195415496826172  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.991329193115234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.0235595703125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7119922637939453  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.268636703491211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2690114974975586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7322545051574707  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.79523801803589  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.827468395233154  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7250056266784668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2815313339233398  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2819061279296875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.746027946472168  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.945030212402344  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.97726058959961  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.739586353302002  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2939181327819824  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.29429292678833  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7578434944152832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.002298831939697  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.034529209136963  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.749298095703125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3061370849609375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3065118789672852  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7722458839416504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.96682596206665  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.999056339263916  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7639980316162109  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3201885223388672  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3205633163452148  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7837824821472168  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.974639415740967  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.006869792938232  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7768130302429199  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3361353874206543  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.336510181427002  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.800384521484375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.033071517944336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.0653018951416  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.792625904083252  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3490033149719238  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3493781089782715  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8110237121582031  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.028467655181885  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.06069803237915  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8028774261474609  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3590679168701172  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3594427108764648  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8235516548156738  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.936153411865234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.9683837890625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8168153762817383  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.375284194946289  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3756589889526367  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8395218849182129  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.01942729949951  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.051657676696777  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8317170143127441  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3879075050354004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.388282299041748  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8498754501342773  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.99806785583496  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.030298233032227  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8419070243835449  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3974027633666992  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3977775573730469  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8612065315246582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.904248237609863  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.93647861480713  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.855252742767334  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4103469848632812  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.410721778869629  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8761916160583496  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.020546913146973  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.05277729034424  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8695464134216309  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.430318832397461  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4306936264038086  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8956546783447266  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.1199049949646  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.152135372161865  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8878002166748047  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.446859359741211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4472341537475586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9065303802490234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.162456035614014  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.19468641281128  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8996520042419434  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4542055130004883  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.454580307006836  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9155898094177246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.093078136444092  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.125308513641357  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9074230194091797  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.467104434967041  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4674792289733887  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9330086708068848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.245610237121582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.277840614318848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9281139373779297  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4805207252502441  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4808955192565918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9412693977355957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.04827642440796  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.08110523223877  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28060003
----------------------------------------after optimizer
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9649429321289062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.521374225616455
pure train time :  12.488285541534424
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.01656794548034668
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04701828956604004
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016649723052978516
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6229438781738281  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1785035133361816  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1788783073425293  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6472811698913574  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.820674896240234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.840240001678467  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.630286693572998  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1864771842956543  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.186851978302002  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6509265899658203  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.87974500656128  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.911975383758545  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6432843208312988  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2009143829345703  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.201289176940918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6647958755493164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.959314823150635  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.9915452003479  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.657656192779541  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2162361145019531  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2166109085083008  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.678703784942627  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.975260257720947  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.007490634918213  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6713705062866211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.227773666381836  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2281484603881836  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6892237663269043  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.890028476715088  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.922258853912354  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6818957328796387  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.238086223602295  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2384610176086426  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7016911506652832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.78060293197632  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.812833309173584  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6953144073486328  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.255077838897705  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2554526329040527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7189164161682129  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.905287742614746  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.93751811981201  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7113595008850098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2699708938598633  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.270345687866211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7303223609924316  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.043503284454346  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.07573366165161  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7225160598754883  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2809486389160156  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2813234329223633  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7424116134643555  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.913718700408936  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.9459490776062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7350654602050781  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2920646667480469  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2924394607543945  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7537102699279785  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.983331203460693  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.01556158065796  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7462372779846191  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3030247688293457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3033995628356934  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7661294937133789  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.063668251037598  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.095898628234863  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7584772109985352  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.320638656616211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3210134506225586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7845768928527832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.115127563476562  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.147357940673828  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7767133712768555  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3346467018127441  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3350214958190918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7925333976745605  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.888125896453857  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.920356273651123  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7860393524169922  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3438897132873535  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3442645072937012  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8060226440429688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.010374546051025  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.04260492324829  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7992057800292969  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.35420560836792  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3545804023742676  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8171100616455078  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.887348175048828  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.920223712921143  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8124580383300781  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.37017822265625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3705530166625977  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.835237979888916  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.010196208953857  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.042426586151123  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8286905288696289  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3809223175048828  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3812971115112305  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8432416915893555  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.879619598388672  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.911849975585938  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8364295959472656  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.395378589630127  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3957533836364746  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8637261390686035  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.00783061981201  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.040568351745605  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8557357788085938  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4144043922424316  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4147791862487793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8764114379882812  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.11755895614624  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.149789333343506  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8705458641052246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.429793357849121  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4301681518554688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8912062644958496  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.177589416503906  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.209819793701172  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.884131908416748  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4432721138000488  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4436469078063965  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9040522575378418  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.09398651123047  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.126216888427734  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8966035842895508  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.456869125366211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4572439193725586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9178028106689453  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.195160388946533  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.2273907661438  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9104709625244141  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4696049690246582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4699797630310059  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9293889999389648  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.181514263153076  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.213744640350342  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.923283576965332  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4778242111206055  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4781990051269531  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9387226104736328  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.08558177947998  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.117812156677246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28065656
----------------------------------------after optimizer
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9650063514709473  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3740999698638916
pure train time :  12.519354581832886
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.013175725936889648
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.033858299255371094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.013248205184936523
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6263980865478516  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.181197166442871  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1815719604492188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6472945213317871  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.769704818725586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.787949562072754  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6290512084960938  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1855616569519043  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.185936450958252  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6507401466369629  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.804719924926758  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.83752727508545  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6429924964904785  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2005057334899902  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.200880527496338  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6642265319824219  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.923874855041504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.95610523223877  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6570849418640137  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.214151382446289  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2145261764526367  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6775002479553223  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.968772888183594  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.00100326538086  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.669649600982666  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2284297943115234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.228804588317871  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6913900375366211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.901745796203613  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.93397617340088  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6837244033813477  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2434144020080566  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2437891960144043  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7047176361083984  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.970160007476807  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.002390384674072  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6972336769104004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2539830207824707  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2543578147888184  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7144312858581543  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.86817216873169  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.900402545928955  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7068195343017578  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.264641284942627  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2650160789489746  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7287507057189941  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.939818382263184  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.97204875946045  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7219820022583008  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.276473045349121  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2768478393554688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7391982078552246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.844071865081787  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.876302242279053  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.731412410736084  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.288794994354248  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2891697883605957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7543082237243652  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.810513019561768  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.842743396759033  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.746647834777832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.305593490600586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3059682846069336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7682352066040039  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.97786808013916  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.010098457336426  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7607741355895996  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.31691312789917  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3172879219055176  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.777977466583252  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.911792755126953  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.94402313232422  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7730145454406738  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3248605728149414  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.325235366821289  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7903294563293457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.89680576324463  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.929036140441895  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7832326889038086  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3436059951782227  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3439807891845703  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.811856746673584  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.094150066375732  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.126380443572998  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8041481971740723  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3651037216186523  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.365478515625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8248615264892578  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.16438341140747  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.196613788604736  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8186240196228027  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3804430961608887  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3808178901672363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8395934104919434  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.13376522064209  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.165995597839355  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8323192596435547  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3879752159118652  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.388350009918213  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8461565971374512  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.922757148742676  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.95498752593994  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.840609073638916  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3992724418640137  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3996472358703613  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8636407852172852  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.06034278869629  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.092573165893555  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8576092720031738  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4164338111877441  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4168086051940918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8777890205383301  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.072914123535156  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.105144500732422  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.870213508605957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4208917617797852  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4212665557861328  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8820896148681641  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.062336921691895  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.09456729888916  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8751177787780762  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4343562126159668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4347310066223145  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9037227630615234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.12824773788452  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.160478115081787  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8964014053344727  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4539504051208496  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4543251991271973  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9147462844848633  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.163607597351074  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.19583797454834  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9099235534667969  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4666471481323242  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4670219421386719  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9291267395019531  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.044282913208008  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.076513290405273  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9214305877685547  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4809141159057617  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4812889099121094  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9443860054016113  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.1897931098938  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.222023487091064  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28055069
----------------------------------------after optimizer
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9694085121154785  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2779040336608887
pure train time :  12.256221771240234
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.013910055160522461
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029877901077270508
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.013965606689453125
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.63055419921875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.187983512878418  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1883583068847656  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6485986709594727  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.83203649520874  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.851318836212158  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6307559013366699  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1908469200134277  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1912217140197754  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6540441513061523  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.994844913482666  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.02707529067993  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6463818550109863  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2049756050109863  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.205350399017334  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6647872924804688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.68143129348755  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.713661670684814  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6588268280029297  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2194857597351074  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.219860553741455  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6818809509277344  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.99200677871704  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.024237155914307  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6748018264770508  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2315788269042969  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2319536209106445  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6910543441772461  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.96805477142334  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.000285148620605  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6839408874511719  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2366456985473633  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.237020492553711  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7008237838745117  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.87749719619751  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.909727573394775  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.693079948425293  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.25368070602417  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2540555000305176  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7210478782653809  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.99745464324951  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.029685020446777  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7135114669799805  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2735328674316406  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2739076614379883  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7330431938171387  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.017738819122314  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.050360679626465  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7264652252197266  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2889227867126465  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2892975807189941  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7491211891174316  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.17514991760254  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.207380294799805  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7412624359130859  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.298039436340332  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2984142303466797  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7556071281433105  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.951636791229248  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.983867168426514  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7479009628295898  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.303295612335205  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3036704063415527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7664895057678223  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.81686496734619  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.849095344543457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7586607933044434  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3153676986694336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3157424926757812  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7800259590148926  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.010839462280273  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.04306983947754  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.772618293762207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3304085731506348  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3307833671569824  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7937822341918945  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.064282417297363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.09651279449463  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7863688468933105  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3441152572631836  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3444900512695312  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8070826530456543  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.097817420959473  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.13004779815674  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8004279136657715  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.358414649963379  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3587894439697266  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8207330703735352  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.015270709991455  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.04750108718872  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8136262893676758  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.372161865234375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3725366592407227  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8342390060424805  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.993998050689697  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.026228427886963  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8274712562561035  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3823628425598145  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.382737636566162  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8440346717834473  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.856328010559082  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.888558387756348  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8376855850219727  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3918466567993164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.392221450805664  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8570246696472168  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.0238995552063  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.056129932403564  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8511409759521484  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4045662879943848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4049410820007324  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8711953163146973  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.054646015167236  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.086876392364502  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8640179634094238  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4209704399108887  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4213452339172363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8876147270202637  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.12741708755493  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.159647464752197  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8798098564147949  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.437861442565918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4382362365722656  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9009604454040527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.060590267181396  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.092820644378662  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.893425464630127  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4494109153747559  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4497857093811035  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9118776321411133  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.15178394317627  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.184014320373535  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9053597450256348  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.462569236755371  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4629440307617188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.926638126373291  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.104902744293213  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.13713312149048  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.920811653137207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4798107147216797  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4801855087280273  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9426054954528809  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.046327590942383  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.07855796813965  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28056106
----------------------------------------after optimizer
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9665703773498535  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0852584838867188
pure train time :  12.005314111709595
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.013475894927978516
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030647754669189453
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.013533353805541992
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6291732788085938  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1893558502197266  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1897306442260742  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6509385108947754  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.96743392944336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.987361907958984  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6340475082397461  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.192641258239746  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1930160522460938  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6525306701660156  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.95483922958374  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.987069606781006  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6456336975097656  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2019381523132324  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.20231294631958  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.663360595703125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.82348918914795  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.856196880340576  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6551022529602051  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.208784580230713  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2091593742370605  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6734356880187988  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.76457977294922  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.796810150146484  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6663427352905273  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.221125602722168  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2215003967285156  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6874651908874512  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.837666034698486  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.869896411895752  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6800456047058105  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2386393547058105  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2390141487121582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7039108276367188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.93485736846924  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.967087745666504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6966400146484375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2542405128479004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.254615306854248  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7156782150268555  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.80671215057373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.838942527770996  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7085657119750977  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2704238891601562  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.270798683166504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7330441474914551  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.167937755584717  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.200168132781982  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7265300750732422  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2835326194763184  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.283907413482666  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.741814136505127  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.050118446350098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.082676887512207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7339215278625488  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2936668395996094  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.294041633605957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7567753791809082  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.927975177764893  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.960205554962158  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7497329711914062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3090391159057617  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3094139099121094  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7694344520568848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.053003311157227  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.085233688354492  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7625970840454102  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3173084259033203  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.317683219909668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7785248756408691  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.98755168914795  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.019782066345215  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7719383239746094  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3277359008789062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.328110694885254  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7935671806335449  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.946352005004883  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.97858238220215  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7871303558349609  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3412423133850098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3416171073913574  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8062624931335449  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.9663724899292  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.998602867126465  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7986650466918945  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3552556037902832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3556303977966309  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8212661743164062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.05720329284668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.089433670043945  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8144664764404297  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3764572143554688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3768320083618164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8399991989135742  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.136905193328857  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.169135570526123  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8329377174377441  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3876490592956543  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.388023853302002  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8457655906677246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.941136360168457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.973366737365723  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8387422561645508  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3996262550354004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.400001049041748  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8650164604187012  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.987548828125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.019779205322266  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8573684692382812  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4124670028686523  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.412841796875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8716893196105957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.975133419036865  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.00736379623413  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8670320510864258  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4222865104675293  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.422661304473877  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8873028755187988  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.017172813415527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.049403190612793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8799610137939453  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4393563270568848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4397311210632324  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9042515754699707  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.228710651397705  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.26094102859497  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8963384628295898  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4561481475830078  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4565229415893555  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9168381690979004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.215742111206055  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.24797248840332  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9099197387695312  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4646310806274414  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.465005874633789  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9248738288879395  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.028244972229004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.06047534942627  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9170570373535156  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.473215103149414  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4735898971557617  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9385571479797363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.05213499069214  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.084365367889404  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28048503
----------------------------------------after optimizer
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.964111328125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9555516242980957
pure train time :  11.967424392700195
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.01521921157836914
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03056955337524414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015273809432983398
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6278529167175293  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1853389739990234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.185713768005371  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.649724006652832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.787174224853516  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.80558156967163  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6311240196228027  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1953582763671875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1957330703735352  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6580824851989746  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.083657264709473  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.11588764190674  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6504268646240234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2090206146240234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.209395408630371  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6648745536804199  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.866591930389404  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.89882230758667  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6569633483886719  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2194833755493164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.219858169555664  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6810264587402344  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.976290225982666  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.00852060317993  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.673738956451416  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.236891269683838  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2372660636901855  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6944961547851562  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.960122108459473  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.99235248565674  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6869621276855469  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2445659637451172  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2449407577514648  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7016754150390625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.081656455993652  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.113886833190918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6940093040466309  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2493929862976074  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.249767780303955  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7118234634399414  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.823882579803467  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.856112957000732  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7068386077880859  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2634029388427734  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.263777732849121  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7284388542175293  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.00912857055664  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.041358947753906  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7207274436950684  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2773699760437012  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2777447700500488  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7408537864685059  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.855481147766113  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.88771152496338  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7349963188171387  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2915606498718262  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2919354438781738  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7549881935119629  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.90561008453369  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.937840461730957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7470879554748535  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3068623542785645  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.307237148284912  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7711811065673828  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.97492027282715  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.007150650024414  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7633204460144043  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.324510097503662  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3248848915100098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7850527763366699  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.070791244506836  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.1030216217041  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7776522636413574  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3357815742492676  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3361563682556152  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7948822975158691  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.880286693572998  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.912517070770264  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7863368988037109  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3405303955078125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3409051895141602  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8042540550231934  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.924059867858887  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.956793785095215  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7966575622558594  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3531560897827148  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3535308837890625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8192787170410156  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.98430109024048  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.01682138442993  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8118791580200195  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.368274211883545  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3686490058898926  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8320927619934082  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.021499633789062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.053730010986328  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8246917724609375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3822755813598633  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.382650375366211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8461880683898926  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.046775341033936  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.0790057182312  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8389730453491211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3960027694702148  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3963775634765625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.858738899230957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.137843132019043  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.17007350921631  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8520293235778809  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4093670845031738  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4097418785095215  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.872647762298584  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.069357872009277  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.101588249206543  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8650798797607422  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.414682388305664  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4150571823120117  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8776521682739258  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.97438335418701  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.006613731384277  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8696427345275879  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4282498359680176  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4286246299743652  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8989481925964355  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.083638668060303  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.11586904525757  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8916110992431641  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4460387229919434  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.446413516998291  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9075345993041992  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.133429050445557  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.165659427642822  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8998661041259766  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4572415351867676  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4576163291931152  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9237260818481445  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.050252437591553  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.08248281478882  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.915985107421875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.467689037322998  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4680638313293457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9303841590881348  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.94460391998291  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.976834297180176  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28054924
----------------------------------------after optimizer
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9557137489318848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8610007762908936
pure train time :  12.643601894378662
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.015419721603393555
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0383453369140625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015505075454711914
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6230459213256836  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1816396713256836  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1820144653320312  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6514735221862793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.942115783691406  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.960875988006592  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.634521484375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.188894271850586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1892690658569336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6502680778503418  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.77838897705078  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.810619354248047  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6430025100708008  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2015962600708008  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2019710540771484  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6671638488769531  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.740834712982178  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.773065090179443  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6594390869140625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.216507911682129  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2168827056884766  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6779212951660156  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.864583492279053  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.89681386947632  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.670926570892334  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2305612564086914  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.230936050415039  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6935310363769531  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.927324771881104  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.95955514907837  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6859211921691895  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.242525577545166  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2429003715515137  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.704010009765625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.89879560470581  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.931025981903076  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.697350025177002  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.259035587310791  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2594103813171387  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7225069999694824  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.00733709335327  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.039567470550537  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7149319648742676  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2758831977844238  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2762579917907715  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7342634201049805  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.994934558868408  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.027164936065674  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7266559600830078  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.285637378692627  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2860121726989746  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7455544471740723  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.998140335083008  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.030370712280273  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7385754585266113  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.299781322479248  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3001561164855957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7608609199523926  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.001962661743164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.03419303894043  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7531108856201172  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.307725429534912  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3081002235412598  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7667694091796875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.85491704940796  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.887147426605225  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7619438171386719  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3168540000915527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3172287940979004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7831320762634277  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.889662265777588  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.921892642974854  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7756252288818359  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3285179138183594  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.328892707824707  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7935972213745117  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.887951374053955  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.92018175125122  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7868690490722656  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.341233730316162  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3416085243225098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8084025382995605  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.039128303527832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.071358680725098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8012881278991699  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.353895664215088  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3542704582214355  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8205995559692383  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.929122924804688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.961838722229004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8123884201049805  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3687376976013184  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.369112491607666  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8367404937744141  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.989344596862793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.02157497406006  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.829770565032959  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.3894333839416504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.389808177947998  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8533406257629395  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.172359943389893  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.204590320587158  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8468985557556152  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4076604843139648  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4080352783203125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8680753707885742  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.146378993988037  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.178609371185303  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8594670295715332  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4196743965148926  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4200491905212402  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8797464370727539  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.03390598297119  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.066136360168457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.87322998046875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4351773262023926  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4355521202087402  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8960757255554199  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.17636203765869  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.208592414855957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8888239860534668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4403481483459473  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.440722942352295  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8983597755432129  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.829079627990723  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.86214590072632  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.8923740386962891  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4493885040283203  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.449763298034668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9179239273071289  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.188324451446533  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.221065998077393  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9109454154968262  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.468447208404541  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4688220024108887  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9325957298278809  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.266197204589844  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.29842758178711  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9248156547546387  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4809026718139648  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.4812774658203125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9434728622436523  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.216702938079834  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.24891996383667  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28052657
----------------------------------------after optimizer
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.9677739143371582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7494723796844482
pure train time :  12.248207092285156
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.017117738723754883
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03946113586425781
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.017180442810058594
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6262707710266113  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.190263271331787  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1906380653381348  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6558952331542969  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.100867748260498  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 25.12078619003296  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6378626823425293  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1950664520263672  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.1954412460327148  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6510953903198242  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.889225006103516  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.92145538330078  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6448421478271484  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2021126747131348  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2024874687194824  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6648874282836914  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.844839096069336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.8770694732666  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6576681137084961  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2131776809692383  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.213552474975586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6764578819274902  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.791465282440186  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.82369565963745  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6694679260253906  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2252411842346191  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2256159782409668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6897196769714355  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.86341094970703  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.895641326904297  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6828732490539551  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2350335121154785  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2354083061218262  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.6991729736328125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.783260345458984  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 24.81549072265625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.692131519317627  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2577743530273438  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 1.2581491470336914  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.85394287109375 GB
    Memory Allocated: 0.7277369499206543  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.264840126037598  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.297070503234863  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.7193450927734375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.2739315032958984  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.274306297302246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.7281689643859863  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 24.755876541137695  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 24.78810691833496  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.7205681800842285  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.278043270111084  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.2784180641174316  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.7434830665588379  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.004159450531006  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.03638982772827  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.7365908622741699  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.2950897216796875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.2954645156860352  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.7581863403320312  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 24.9778094291687  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.010039806365967  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.7515640258789062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.3112850189208984  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.311659812927246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.7728781700134277  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.08409357070923  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.116323947906494  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.7666440010070801  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.323009967803955  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.3233847618103027  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.7842702865600586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 24.89020824432373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 24.922438621520996  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.7776780128479004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.3335280418395996  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.3339028358459473  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.797215461730957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.041217803955078  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.073448181152344  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.7909450531005859  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.3458356857299805  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.3462104797363281  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8100275993347168  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.000979900360107  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.033210277557373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8030972480773926  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.3600497245788574  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.360424518585205  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8259782791137695  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.01130723953247  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.043537616729736  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8200783729553223  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.3786449432373047  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.3790197372436523  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8417267799377441  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 24.968456745147705  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.00068712234497  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8340020179748535  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.3884053230285645  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.388780117034912  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8498711585998535  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 24.963431358337402  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 24.995661735534668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8420381546020508  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.4022998809814453  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.402674674987793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8680481910705566  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.097978115081787  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.130208492279053  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8609442710876465  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.415722370147705  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.4160971641540527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8754334449768066  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 24.829185009002686  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 24.86141538619995  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8688735961914062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.4263458251953125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.4267206192016602  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8923444747924805  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.120285987854004  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.15251636505127  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8873100280761719  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.4434595108032227  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.4438343048095703  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.9059934616088867  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.00226879119873  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.034499168395996  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.8991508483886719  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.456350326538086  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.4567251205444336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.9213109016418457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.212583541870117  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 25.244813919067383  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.9142842292785645  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.4711942672729492  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 1.4715690612792969  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93011474609375 GB
    Memory Allocated: 0.9340038299560547  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.11340045928955  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.145630836486816  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9264025688171387  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4862256050109863  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.486600399017334  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9493756294250488  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.205984592437744  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.23820161819458  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28054561
----------------------------------------after optimizer
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9757919311523438  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6752521991729736
pure train time :  11.96379017829895
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.014479398727416992
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03341174125671387
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014530420303344727
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6324734687805176  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1910672187805176  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1914420127868652  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6518778800964355  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.959352016448975  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.97680377960205  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6327595710754395  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1889967918395996  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1893715858459473  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6503329277038574  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.706713676452637  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.738944053649902  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6438565254211426  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2027745246887207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2031493186950684  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.666633129119873  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.986717700958252  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.018948078155518  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6597275733947754  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2139129638671875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2142877578735352  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6759686470031738  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.969624042510986  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.001854419708252  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6684322357177734  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2235326766967773  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.223907470703125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6893229484558105  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.816892623901367  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.849123001098633  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6840729713439941  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2472529411315918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2476277351379395  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.712376594543457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.05476188659668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.086992263793945  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7045559883117676  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2601981163024902  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.260572910308838  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7170987129211426  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.962852001190186  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.99508237838745  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7096858024597168  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2650461196899414  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.265420913696289  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7294211387634277  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.7946457862854  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.826876163482666  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7222428321838379  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.281132698059082  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2815074920654297  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7467389106750488  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.97958755493164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.011817932128906  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7392663955688477  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.298670768737793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2990455627441406  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7598490715026855  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.97683095932007  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.009061336517334  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7541933059692383  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3104047775268555  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3107795715332031  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7719078063964844  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.901753902435303  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.93398427963257  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7645406723022461  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.325831413269043  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3262062072753906  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7898216247558594  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.190247058868408  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.222477436065674  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7821354866027832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3394460678100586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3398208618164062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7982864379882812  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.956344604492188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.988574981689453  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7910714149475098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3482661247253418  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3486409187316895  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8115615844726562  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.991743564605713  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.02397394180298  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.803560733795166  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3611278533935547  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3615026473999023  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8240880966186523  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.124096393585205  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.15632677078247  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8162860870361328  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3738861083984375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3742609024047852  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8365530967712402  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.97728395462036  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.009514331817627  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8303155899047852  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3870515823364258  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3874263763427734  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.849604606628418  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.149367332458496  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.18159770965576  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8426337242126465  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3980870246887207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3984618186950684  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8614840507507324  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.062262535095215  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.09449291229248  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8545870780944824  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4128713607788086  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4132461547851562  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8782558441162109  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.07678747177124  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.109017848968506  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.870821475982666  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.432732105255127  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4331068992614746  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8945837020874023  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.139265060424805  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.17149543762207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8870730400085449  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4431209564208984  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.443495750427246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9013395309448242  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.116486072540283  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.14871644973755  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8943667411804199  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4493060111999512  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4496808052062988  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.913360595703125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.919081687927246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.95131206512451  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.905601978302002  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4620990753173828  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4624738693237305  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9272956848144531  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.178576469421387  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.210806846618652  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9209184646606445  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4788341522216797  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4792089462280273  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9424386024475098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.001879692077637  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.034110069274902  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28060293
----------------------------------------after optimizer
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9673051834106445  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6096808910369873
pure train time :  11.960097789764404
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.014158487319946289
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030439138412475586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014251232147216797
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.629112720489502  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1853265762329102  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1857013702392578  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6485819816589355  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.825864791870117  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.845271587371826  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6304779052734375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1865324974060059  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1869072914123535  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6503190994262695  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.845781803131104  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.87801218032837  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.643805980682373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2008867263793945  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2012615203857422  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6650094985961914  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.903247356414795  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.93547773361206  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6579995155334473  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.216414451599121  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2167892456054688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6801848411560059  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.830095767974854  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.86232614517212  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6727700233459473  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2329258918762207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2333006858825684  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6945037841796875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.829363346099854  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.86159372329712  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6871533393859863  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.245741844177246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2461166381835938  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7057418823242188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.985641479492188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.017871856689453  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6979985237121582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2564477920532227  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2568225860595703  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7187113761901855  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.90204620361328  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.934276580810547  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7122116088867188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2695908546447754  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.269965648651123  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7312655448913574  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.863773345947266  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.89600372314453  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7235689163208008  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2816882133483887  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2820630073547363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7443122863769531  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.938931941986084  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.97116231918335  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7365450859069824  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2902145385742188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2905893325805664  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7529144287109375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.962894916534424  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.99512529373169  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7477421760559082  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.306086540222168  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3064613342285156  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7724175453186035  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.87938642501831  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.911616802215576  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7649269104003906  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3229589462280273  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.323333740234375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7859477996826172  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.17834711074829  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.210577487945557  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7781867980957031  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3355746269226074  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.335949420928955  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7979550361633301  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.074467182159424  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.10669755935669  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7903485298156738  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.350283145904541  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3506579399108887  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.812932014465332  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.02927303314209  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.061503410339355  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8057460784912109  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3645620346069336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3649368286132812  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8246641159057617  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.036459922790527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.068690299987793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8182225227355957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3729629516601562  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.373337745666504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8341817855834961  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.996763229370117  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.028993606567383  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8273487091064453  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3875298500061035  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3879046440124512  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8528680801391602  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.148479461669922  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.180709838867188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8458366394042969  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4055290222167969  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4059038162231445  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8654370307922363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.167304039001465  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.19953441619873  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8580856323242188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4188003540039062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.419175148010254  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8791589736938477  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.13420295715332  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.166433334350586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8734025955200195  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4307332038879395  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.431107997894287  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8900713920593262  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.16319179534912  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.195422172546387  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8831415176391602  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.437605857849121  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4379806518554688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9002456665039062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.98472547531128  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.016955852508545  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8927083015441895  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4515647888183594  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.451939582824707  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.917144775390625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.177820205688477  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.210050582885742  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9104876518249512  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4662652015686035  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4666399955749512  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9274239540100098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.10619020462036  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.13844633102417  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9216508865356445  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4753203392028809  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4756951332092285  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9395656585693359  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.1368350982666  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.169065475463867  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28063662
----------------------------------------after optimizer
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.963890552520752  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5363712310791016
pure train time :  11.918802738189697
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.014255046844482422
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029546022415161133
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014307022094726562
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6242685317993164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1796355247497559  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1800103187561035  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6464390754699707  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.734152793884277  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.753655910491943  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6293058395385742  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1908869743347168  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1912617683410645  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6556882858276367  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.047081470489502  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.079311847686768  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6491718292236328  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2104859352111816  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2108607292175293  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6690797805786133  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.052173614501953  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.08440399169922  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6616530418395996  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2205910682678223  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.22096586227417  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6794261932373047  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.940123558044434  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.9723539352417  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.671940803527832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.230534553527832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2309093475341797  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6925277709960938  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.84156847000122  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.873798847198486  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6851420402526855  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2407784461975098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2411532402038574  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7022452354431152  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.83473491668701  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.866965293884277  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6949763298034668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.251692771911621  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2520675659179688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7161083221435547  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.787744998931885  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.81997537612915  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7101445198059082  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2690682411193848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2694430351257324  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.733421802520752  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.134955883026123  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.16718626022339  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.726356029510498  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2832489013671875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2836236953735352  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7444562911987305  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.93213701248169  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.964367389678955  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7376194000244141  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.29766845703125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2980432510375977  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7608275413513184  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.89285898208618  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.925089359283447  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7537431716918945  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3087596893310547  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3091344833374023  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7688989639282227  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.901538848876953  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.93376922607422  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7610454559326172  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3172645568847656  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3176393508911133  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7823085784912109  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.906898498535156  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.939128875732422  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7754225730895996  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3319826126098633  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.332357406616211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7959299087524414  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.103559970855713  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.13579034805298  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7880325317382812  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3398208618164062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.340195655822754  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8033738136291504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.77561616897583  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.807846546173096  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7958145141601562  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.353745937347412  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3541207313537598  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8221020698547363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.04459810256958  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.076828479766846  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8143205642700195  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3739714622497559  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3743462562561035  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8362383842468262  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.08045196533203  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.112682342529297  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8286643028259277  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.386122703552246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3864974975585938  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8466315269470215  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.10151720046997  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.133747577667236  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8393802642822266  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3936347961425781  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3940095901489258  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8563246726989746  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.986079216003418  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.018309593200684  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8504962921142578  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4103145599365234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.410689353942871  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8762044906616211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.15097427368164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.183204650878906  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8692617416381836  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.425276756286621  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4256515502929688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8855733871459961  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.04944086074829  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.081671237945557  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8797564506530762  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.437042236328125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4374170303344727  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9011287689208984  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.048656940460205  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.08088731765747  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8937201499938965  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4521293640136719  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4525041580200195  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9149489402770996  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.121825218200684  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.15405559539795  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9101834297180176  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4685359001159668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4689106941223145  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9310193061828613  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.01132869720459  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.043559074401855  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9248538017272949  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4846911430358887  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4850659370422363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9467382431030273  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.234684467315674  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.26691484451294  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28064484
----------------------------------------after optimizer
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9718542098999023  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4789037704467773
pure train time :  12.017253160476685
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.016202926635742188
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0341641902923584
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016286611557006836
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.631159782409668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1887149810791016  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1890897750854492  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6495542526245117  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.95548963546753  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.9742693901062  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.631462574005127  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1868138313293457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1871886253356934  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6492695808410645  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.89263105392456  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.92505645751953  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6413655281066895  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2020049095153809  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2023797035217285  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6669754981994629  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.012929916381836  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.0451602935791  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6596016883850098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2189807891845703  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.219355583190918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6792716979980469  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.852088928222656  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.884319305419922  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6716165542602539  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2302279472351074  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.230602741241455  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6908364295959473  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.845746517181396  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.877976894378662  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6832313537597656  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2385563850402832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2389311790466309  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.700714111328125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.757822513580322  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.790052890777588  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6934881210327148  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2532544136047363  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.253629207611084  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7180242538452148  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.026702404022217  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.058932781219482  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7108321189880371  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2701845169067383  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.270559310913086  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7304401397705078  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.845057487487793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.87728786468506  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7238502502441406  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.279996395111084  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2803711891174316  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7407479286193848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.035273551940918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.067503929138184  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7342095375061035  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2910771369934082  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2914519309997559  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7550077438354492  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.917608737945557  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.949839115142822  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7477116584777832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3079838752746582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3083586692810059  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7712693214416504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.15846347808838  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.190693855285645  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7659873962402344  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3248252868652344  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.325200080871582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7847690582275391  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.25572395324707  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.287954330444336  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7765593528747559  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3350214958190918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3353962898254395  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7962193489074707  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.944265365600586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.97649574279785  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7907013893127441  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3461170196533203  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.346491813659668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8076796531677246  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.941823959350586  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.97405433654785  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8010220527648926  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3570122718811035  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3573870658874512  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8216056823730469  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.935041904449463  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.96727228164673  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8142743110656738  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3710761070251465  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3714509010314941  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8351192474365234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.9814510345459  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.013681411743164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8284177780151367  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3870248794555664  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.387399673461914  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8502836227416992  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.088470458984375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.12070083618164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8423547744750977  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.398177146911621  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3985519409179688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8596177101135254  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.04047393798828  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.072704315185547  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8527388572692871  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4109387397766113  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.411313533782959  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8752164840698242  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.154484748840332  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.187302589416504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8677859306335449  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.421248435974121  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4216232299804688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8831820487976074  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.946335315704346  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.97856569290161  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8755679130554199  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4345803260803223  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.43495512008667  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9011678695678711  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.096919536590576  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.129149913787842  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.893284797668457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4470500946044922  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4474248886108398  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.908048152923584  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.00653600692749  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.038766384124756  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9016356468200684  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4573578834533691  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4577326774597168  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9235882759094238  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.019695281982422  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.052143096923828  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9161014556884766  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4758687019348145  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.476243495941162  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9402213096618652  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.179938316345215  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.21215534210205  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28058075
----------------------------------------after optimizer
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9646730422973633  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.442063570022583
pure train time :  12.0288667678833
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.016937732696533203
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0401151180267334
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.017012834548950195
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6304459571838379  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.189039707183838  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1894145011901855  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6497678756713867  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.832921504974365  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.85234498977661  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6327781677246094  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1902270317077637  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1906018257141113  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.651888370513916  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.965089797973633  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.9973201751709  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.645514965057373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.204108715057373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2044835090637207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6667642593383789  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.96773052215576  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.999960899353027  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.659935474395752  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2178010940551758  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2181758880615234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6800379753112793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.89991331100464  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.932143688201904  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6725125312805176  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.227379322052002  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2277541160583496  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6904177665710449  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.781009197235107  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.813239574432373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6835784912109375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2403464317321777  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2407212257385254  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7057704925537109  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.831135749816895  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.86336612701416  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6983685493469238  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2567968368530273  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.257171630859375  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.720038890838623  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.872045516967773  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.90427589416504  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7130160331726074  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2716693878173828  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2720441818237305  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7340102195739746  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.943313121795654  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.97554349899292  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7275280952453613  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2866334915161133  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.287008285522461  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7480063438415527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.93199634552002  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.964226722717285  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7415575981140137  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2972874641418457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2976622581481934  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.758185863494873  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.940369129180908  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.972599506378174  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7514243125915527  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3131494522094727  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3135242462158203  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7774615287780762  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.00744342803955  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.039673805236816  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7703061103820801  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3251729011535645  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.325547695159912  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7834343910217285  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.820653438568115  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.85288381576538  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7760567665100098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.330115795135498  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3304905891418457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7952208518981934  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.895018100738525  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.92724847793579  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7898983955383301  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3466172218322754  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.346992015838623  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.812556266784668  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.96426296234131  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.996493339538574  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8051543235778809  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.361335277557373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3617100715637207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8246297836303711  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.00071954727173  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.032949924468994  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8172879219055176  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3725686073303223  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.37294340133667  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8364319801330566  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.103705883026123  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.13593626022339  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8291769027709961  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3912339210510254  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.391608715057373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8571162223815918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.269370555877686  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.30160093307495  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8503766059875488  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4065403938293457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4069151878356934  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8644733428955078  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.955809593200684  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.98803997039795  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8579497337341309  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.414762020111084  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4151368141174316  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8786358833312988  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.104028701782227  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.136716842651367  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8705301284790039  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4269943237304688  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4273691177368164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8919124603271484  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.082383632659912  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.114614009857178  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8843889236450195  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4443750381469727  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4447498321533203  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9080362319946289  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.22651720046997  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.258747577667236  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9005236625671387  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4596199989318848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4599947929382324  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9205336570739746  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.137410640716553  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.16964101791382  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9149317741394043  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.470710277557373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4710850715637207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9316244125366211  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.10549306869507  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.137925624847412  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9255871772766113  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4827227592468262  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4830975532531738  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9469680786132812  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.15689992904663  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.189679622650146  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28052775
----------------------------------------after optimizer
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9702777862548828  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3760862350463867
pure train time :  11.996834516525269
the output layer 
self.num_batch (get_in_degree_bucketing) 24
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
random partition time  0.015000581741333008
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03563117980957031
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015053749084472656
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6272501945495605  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1858439445495605  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1862187385559082  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6494007110595703  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.797338485717773  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.817326068878174  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.632875919342041  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.1904306411743164  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.190805435180664  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6518468856811523  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.847229957580566  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.879460334777832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6447062492370605  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2009472846984863  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.201322078704834  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6640129089355469  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.75940752029419  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.791637897491455  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6563630104064941  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2154335975646973  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.215808391571045  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6796011924743652  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.934342861175537  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.966573238372803  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6717753410339355  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2289352416992188  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2293100357055664  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6907572746276855  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.871581077575684  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.90381145477295  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.6831459999084473  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2383122444152832  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2386870384216309  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7011466026306152  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.787943840026855  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.82017421722412  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.694664478302002  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2512478828430176  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2516226768493652  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7169890403747559  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.025458335876465  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.05768871307373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7103762626647949  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2680120468139648  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2683868408203125  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7315034866333008  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.032089710235596  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.06432008743286  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7242865562438965  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2791271209716797  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2795019149780273  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7415060997009277  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.99161434173584  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.023844718933105  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7348523139953613  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2924909591674805  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.2928657531738281  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7576556205749512  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.94476556777954  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.976995944976807  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7512860298156738  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3089637756347656  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3093385696411133  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7713322639465332  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.948968410491943  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.98119878768921  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7655673027038574  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3230547904968262  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3234295845031738  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7854022979736328  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.030974864959717  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.063205242156982  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7788691520690918  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3337597846984863  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.334134578704834  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7970156669616699  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.020103454589844  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.05233383178711  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.7898101806640625  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.348680019378662  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3490548133850098  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8138775825500488  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.114420890808105  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.14665126800537  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8062357902526855  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3622722625732422  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3626470565795898  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8240532875061035  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.086918830871582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.119149208068848  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  15
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8166537284851074  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3733153343200684  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.373690128326416  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8372907638549805  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.9754638671875  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.007694244384766  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  16
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8308634757995605  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3868074417114258  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3871822357177734  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8501472473144531  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.978259563446045  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.01048994064331  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  17
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.842409610748291  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.3983516693115234  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.398726463317871  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8624119758605957  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.00778579711914  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.040016174316406  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  18
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8546228408813477  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4154448509216309  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4158196449279785  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8796091079711914  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.21020793914795  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.242438316345215  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  19
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.872401237487793  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4343934059143066  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4347681999206543  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8936662673950195  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.187230110168457  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.219460487365723  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  20
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8862309455871582  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.440537452697754  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4409122467041016  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8985753059387207  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.146491050720215  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.17872142791748  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  21
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.8912782669067383  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4468717575073242  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4472465515136719  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9125609397888184  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 24.998918056488037  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.031148433685303  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  22
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9067597389221191  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.464033603668213  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4644083976745605  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9284529685974121  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.057620525360107  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.089850902557373  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

step  23
----------------------------------------before batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9227352142333984  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4841885566711426  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 1.4845633506774902  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9470009803771973  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.241342067718506  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 25.273559093475342  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

number of input  28049393
----------------------------------------after optimizer
 Nvidia-smi: 43.93206787109375 GB
    Memory Allocated: 0.9713602066040039  GigaBytes
Max Memory Allocated: 25.96592378616333  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3421013355255127
pure train time :  11.986410140991211
epoch_time_list  [49.32217311859131, 48.89420795440674, 49.75068259239197, 52.795018434524536, 53.297881841659546, 49.91416645050049, 55.03168725967407, 50.704001665115356, 49.53549122810364, 49.004072427749634, 48.97136855125427, 51.14638829231262, 50.883734703063965, 49.435853242874146, 48.4911527633667, 48.531816244125366, 49.0300555229187, 49.81247353553772, 49.451518297195435, 49.20418691635132]

loading_time list   [0.8721847534179688, 0.8925206661224365, 0.8860840797424316, 0.7646682262420654, 1.169128179550171, 0.9267933368682861, 0.7607212066650391, 0.9343340396881104, 0.9262886047363281, 0.9179577827453613, 0.743156909942627, 0.7525694370269775, 1.1462032794952393, 1.0347297191619873, 0.8101222515106201, 0.8349609375, 0.7978007793426514, 0.8728845119476318, 0.8047084808349609, 0.8785996437072754]

 data loader gen time  31.539820671081543
	---backpack schedule time  [0.19269204139709473, 0.18829655647277832, 0.17844891548156738, 0.176100492477417, 0.19653868675231934, 0.17974209785461426, 0.17096161842346191, 0.1985764503479004, 0.17721962928771973, 0.1725175380706787, 0.17412543296813965, 0.17544269561767578, 0.20345139503479004, 0.18720293045043945, 0.17584490776062012, 0.1728193759918213, 0.17043733596801758, 0.1790006160736084, 0.19787001609802246, 0.18328380584716797]
	---connection_check_time_list  [5.8832361698150635, 5.895950555801392, 6.139481782913208, 7.808658599853516, 9.249803066253662, 6.860997915267944, 11.117440223693848, 6.346664190292358, 5.991096019744873, 6.020168781280518, 6.026025295257568, 7.024052143096924, 6.833891868591309, 6.047729015350342, 5.643806457519531, 5.620800256729126, 5.8439600467681885, 6.821847438812256, 6.365554332733154, 6.0305023193359375]
	---block_gen_time_list  [3.2661197185516357, 3.206422805786133, 2.9354372024536133, 3.1865553855895996, 3.126777410507202, 2.729928731918335, 2.9474895000457764, 3.075167417526245, 2.5902152061462402, 2.6859095096588135, 2.987881898880005, 2.8776938915252686, 3.0388290882110596, 2.9210710525512695, 2.733640670776367, 2.7363502979278564, 2.9950156211853027, 2.7082366943359375, 2.904395341873169, 2.8718037605285645]
training time  [16.526553630828857, 16.08914017677307, 17.01105284690857, 17.916436433792114, 17.15854263305664, 16.791119813919067, 17.555659770965576, 17.769481420516968, 17.181750297546387, 16.752803564071655, 16.591957092285156, 17.782667875289917, 17.114086151123047, 16.746224641799927, 16.632396936416626, 16.662384271621704, 16.682734727859497, 16.581692934036255, 16.60833239555359, 16.740326166152954]
---feature block loading time  [4.407780885696411, 4.814345598220825, 5.273389101028442, 5.283023118972778, 5.090624094009399, 4.71284031867981, 5.015473365783691, 5.201855182647705, 4.876674652099609, 4.701637029647827, 4.576794385910034, 5.086486101150513, 4.817216157913208, 4.7337822914123535, 4.625148296356201, 4.697870254516602, 4.621090412139893, 4.506181955337524, 4.561733961105347, 4.704988718032837]


epoch_time avg   50.152865558862686
loading_time avg   0.8944349437952042
 data loader gen time avg 32.250279664993286
	---backpack schedule time avg 0.18218965828418732
	---connection_check_time avg  6.740271210670471
	---block_gen_time avg  2.8706503808498383
training time  16.959510043263435
---feature block loading time  4.78314982354641
pure train time per /epoch  [12.08925986289978, 11.243251085281372, 11.70465087890625, 12.582101821899414, 12.018417119979858, 12.030437707901001, 12.488285541534424, 12.519354581832886, 12.256221771240234, 12.005314111709595, 11.967424392700195, 12.643601894378662, 12.248207092285156, 11.96379017829895, 11.960097789764404, 11.918802738189697, 12.017253160476685, 12.0288667678833, 11.996834516525269, 11.986410140991211]
pure train time average  12.15478948985829
num_input list  [28054321, 28057190, 28054798, 28053608, 28049201, 28056583, 28060003, 28065656, 28055069, 28056106, 28048503, 28054924, 28052657, 28054561, 28060293, 28063662, 28064484, 28058075, 28052775, 28049393]
num_input  average  28056093.1
