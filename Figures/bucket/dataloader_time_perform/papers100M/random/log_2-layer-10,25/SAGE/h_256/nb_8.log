main start at this time 1714079586.6461763
-----------------------------------------before load data 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
# Nodes: 111059956
# Edges: 1615685872
# Train: 1207179
# Val: 125265
# Test: 109727512
# Classes: 172

----------------------------------------start of run function 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.01820683479309082
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03856253623962402
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01827073097229004
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 1.22113037109375 GB
    Memory Allocated: 0.003025054931640625  GigaBytes
Max Memory Allocated: 0.003025054931640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.25042724609375 GB
    Memory Allocated: 1.0323219299316406  GigaBytes
Max Memory Allocated: 1.0323219299316406  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 2.26995849609375 GB
    Memory Allocated: 1.0334463119506836  GigaBytes
Max Memory Allocated: 1.0334463119506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.30902099609375 GB
    Memory Allocated: 1.0805554389953613  GigaBytes
Max Memory Allocated: 1.0805554389953613  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.51800537109375 GB
    Memory Allocated: 60.21444845199585  GigaBytes
Max Memory Allocated: 62.057740688323975  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.51800537109375 GB
    Memory Allocated: 60.311137676239014  GigaBytes
Max Memory Allocated: 62.057740688323975  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 64.85394287109375 GB
    Memory Allocated: 1.1853852272033691  GigaBytes
Max Memory Allocated: 62.057740688323975  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.85394287109375 GB
    Memory Allocated: 2.209977626800537  GigaBytes
Max Memory Allocated: 62.057740688323975  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.85394287109375 GB
    Memory Allocated: 2.2113332748413086  GigaBytes
Max Memory Allocated: 62.057740688323975  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.85394287109375 GB
    Memory Allocated: 1.2284421920776367  GigaBytes
Max Memory Allocated: 62.057740688323975  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.85589599609375 GB
    Memory Allocated: 60.19678735733032  GigaBytes
Max Memory Allocated: 62.131290435791016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.85589599609375 GB
    Memory Allocated: 60.29347610473633  GigaBytes
Max Memory Allocated: 62.131290435791016  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 66.18402099609375 GB
    Memory Allocated: 1.2184815406799316  GigaBytes
Max Memory Allocated: 62.131290435791016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 66.18402099609375 GB
    Memory Allocated: 2.248490810394287  GigaBytes
Max Memory Allocated: 62.131290435791016  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 66.18402099609375 GB
    Memory Allocated: 2.24961519241333  GigaBytes
Max Memory Allocated: 62.131290435791016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.18402099609375 GB
    Memory Allocated: 1.2710447311401367  GigaBytes
Max Memory Allocated: 62.131290435791016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.01019287109375 GB
    Memory Allocated: 60.43521595001221  GigaBytes
Max Memory Allocated: 62.383307456970215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.01019287109375 GB
    Memory Allocated: 60.53190469741821  GigaBytes
Max Memory Allocated: 62.383307456970215  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 65.34417724609375 GB
    Memory Allocated: 1.2595086097717285  GigaBytes
Max Memory Allocated: 62.383307456970215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.34417724609375 GB
    Memory Allocated: 2.281724452972412  GigaBytes
Max Memory Allocated: 62.383307456970215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.34417724609375 GB
    Memory Allocated: 2.2830424308776855  GigaBytes
Max Memory Allocated: 62.383307456970215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.34417724609375 GB
    Memory Allocated: 1.298780918121338  GigaBytes
Max Memory Allocated: 62.383307456970215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.34417724609375 GB
    Memory Allocated: 59.99568223953247  GigaBytes
Max Memory Allocated: 62.383307456970215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 65.34417724609375 GB
    Memory Allocated: 60.09237098693848  GigaBytes
Max Memory Allocated: 62.383307456970215  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 65.34417724609375 GB
    Memory Allocated: 1.2870783805847168  GigaBytes
Max Memory Allocated: 62.383307456970215  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.34417724609375 GB
    Memory Allocated: 2.320437431335449  GigaBytes
Max Memory Allocated: 62.383307456970215  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.34417724609375 GB
    Memory Allocated: 2.321561813354492  GigaBytes
Max Memory Allocated: 62.383307456970215  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.34417724609375 GB
    Memory Allocated: 1.345205307006836  GigaBytes
Max Memory Allocated: 62.383307456970215  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.05706787109375 GB
    Memory Allocated: 60.49670457839966  GigaBytes
Max Memory Allocated: 62.441121101379395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.05706787109375 GB
    Memory Allocated: 60.593393325805664  GigaBytes
Max Memory Allocated: 62.441121101379395  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.05706787109375 GB
    Memory Allocated: 1.3333563804626465  GigaBytes
Max Memory Allocated: 62.441121101379395  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.05706787109375 GB
    Memory Allocated: 2.3621044158935547  GigaBytes
Max Memory Allocated: 62.441121101379395  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.05706787109375 GB
    Memory Allocated: 2.363422393798828  GigaBytes
Max Memory Allocated: 62.441121101379395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.05706787109375 GB
    Memory Allocated: 1.3760838508605957  GigaBytes
Max Memory Allocated: 62.441121101379395  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 60.52133131027222  GigaBytes
Max Memory Allocated: 62.46927356719971  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 60.61802005767822  GigaBytes
Max Memory Allocated: 62.46927356719971  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 1.364701271057129  GigaBytes
Max Memory Allocated: 62.46927356719971  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 2.3948755264282227  GigaBytes
Max Memory Allocated: 62.46927356719971  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 2.3959999084472656  GigaBytes
Max Memory Allocated: 62.46927356719971  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 1.4131321907043457  GigaBytes
Max Memory Allocated: 62.46927356719971  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 60.57945489883423  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 60.676143646240234  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 1.401437759399414  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 2.430415630340576  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 2.4317336082458496  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 1.4475483894348145  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 60.44686985015869  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.05902099609375 GB
    Memory Allocated: 60.54355525970459  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

number of input  17253657
----------------------------------------after optimizer
 Nvidia-smi: 76.06097412109375 GB
    Memory Allocated: 1.5165061950683594  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.175342559814453
pure train time :  10.076520919799805
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.016469240188598633
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.036186933517456055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01651740074157715
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.06097412109375 GB
    Memory Allocated: 1.1878952980041504  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.06097412109375 GB
    Memory Allocated: 2.214867115020752  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.06097412109375 GB
    Memory Allocated: 2.216207981109619  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06097412109375 GB
    Memory Allocated: 1.2335381507873535  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06097412109375 GB
    Memory Allocated: 60.25937795639038  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.06097412109375 GB
    Memory Allocated: 60.32009696960449  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.06097412109375 GB
    Memory Allocated: 1.189526081085205  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.06097412109375 GB
    Memory Allocated: 2.2182388305664062  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.06097412109375 GB
    Memory Allocated: 2.2195940017700195  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06097412109375 GB
    Memory Allocated: 1.2383160591125488  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 60.23615503311157  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 60.33284378051758  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 1.2267303466796875  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 2.2573652267456055  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 2.258706569671631  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 1.2757091522216797  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 60.27693223953247  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 60.37362098693848  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 1.2654776573181152  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 2.2935118675231934  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 2.2947745323181152  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 1.3099699020385742  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 60.45060873031616  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.06292724609375 GB
    Memory Allocated: 60.54729747772217  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 1.2995057106018066  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 2.327662944793701  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 2.3288512229919434  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 1.3465495109558105  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 60.308122634887695  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 60.4048113822937  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 1.3350210189819336  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 2.3652329444885254  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 2.366464138031006  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 1.3842930793762207  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 60.50396919250488  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 60.60065793991089  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 1.3731517791748047  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 2.403858184814453  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 2.4050464630126953  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 1.4207682609558105  GigaBytes
Max Memory Allocated: 62.530452728271484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 60.658584117889404  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.06488037109375 GB
    Memory Allocated: 60.75527286529541  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 1.409250259399414  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 2.4342284202575684  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 2.435459613800049  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 1.4505667686462402  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 60.38301467895508  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 60.47970008850098  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

number of input  17256221
----------------------------------------after optimizer
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 1.515573501586914  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.7428131103515625
pure train time :  7.169989824295044
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.016754150390625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03275132179260254
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016799211502075195
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 1.1851253509521484  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 2.2108020782470703  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 2.2121381759643555  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 1.2334861755371094  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 60.08414602279663  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 60.14354848861694  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 1.1885251998901367  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 2.219085693359375  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 2.2204413414001465  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 76.06683349609375 GB
    Memory Allocated: 1.2406373023986816  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.40572643280029  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.5024151802063  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.2304458618164062  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.2580180168151855  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.2593331336975098  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.274942398071289  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.33029127120972  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.42698001861572  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.2634391784667969  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.2933692932128906  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.294705390930176  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.31303071975708  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.58253622055054  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.67922496795654  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.3014354705810547  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.3252744674682617  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.3265647888183594  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.3425936698913574  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.321683406829834  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.41837215423584  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.3310060501098633  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.3599538803100586  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.3612442016601562  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.3831596374511719  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.35254383087158  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.44923257827759  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.3743133544921875  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.4048476219177246  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.4061379432678223  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.4229645729064941  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.45791816711426  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.554606914520264  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.411853313446045  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.4407286643981934  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.442018985748291  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.4571857452392578  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.40798616409302  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.50467491149902  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

number of input  17251038
----------------------------------------after optimizer
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.5195302963256836  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.529721260070801
pure train time :  7.2005109786987305
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.01656508445739746
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.028499603271484375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016605377197265625
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.1872434616088867  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.2145252227783203  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.215880870819092  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.2333755493164062  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.28901147842407  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.35025215148926  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.1897211074829102  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.2184524536132812  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.2196192741394043  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.2380123138427734  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.217655658721924  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 60.31434440612793  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.227339744567871  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.255140781402588  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 2.2564964294433594  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 78.42425537109375 GB
    Memory Allocated: 1.2738471031188965  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.01800537109375 GB
    Memory Allocated: 60.50563383102417  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.01800537109375 GB
    Memory Allocated: 60.602322578430176  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 65.35198974609375 GB
    Memory Allocated: 1.262951374053955  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.35198974609375 GB
    Memory Allocated: 2.289666175842285  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.35198974609375 GB
    Memory Allocated: 2.290832996368408  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.35198974609375 GB
    Memory Allocated: 1.3090791702270508  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.35198974609375 GB
    Memory Allocated: 60.21406650543213  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 65.35198974609375 GB
    Memory Allocated: 60.310755252838135  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 65.35394287109375 GB
    Memory Allocated: 1.2995166778564453  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.35394287109375 GB
    Memory Allocated: 2.3288135528564453  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.35394287109375 GB
    Memory Allocated: 2.330122947692871  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.35394287109375 GB
    Memory Allocated: 1.349320411682129  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.05120849609375 GB
    Memory Allocated: 60.368741512298584  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.05120849609375 GB
    Memory Allocated: 60.46543025970459  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 66.05120849609375 GB
    Memory Allocated: 1.337890625  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 66.05120849609375 GB
    Memory Allocated: 2.3658246994018555  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 66.05120849609375 GB
    Memory Allocated: 2.3669915199279785  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.05120849609375 GB
    Memory Allocated: 1.3834033012390137  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.05120849609375 GB
    Memory Allocated: 60.357144832611084  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.05120849609375 GB
    Memory Allocated: 60.45383358001709  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 66.05120849609375 GB
    Memory Allocated: 1.3741531372070312  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 66.05120849609375 GB
    Memory Allocated: 2.40360689163208  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 66.05120849609375 GB
    Memory Allocated: 2.404916286468506  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.05120849609375 GB
    Memory Allocated: 1.4228706359863281  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 69.04144287109375 GB
    Memory Allocated: 60.450912952423096  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 69.04144287109375 GB
    Memory Allocated: 60.5476016998291  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 70.37152099609375 GB
    Memory Allocated: 1.4113521575927734  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.37152099609375 GB
    Memory Allocated: 2.4390015602111816  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.37152099609375 GB
    Memory Allocated: 2.4401683807373047  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.37152099609375 GB
    Memory Allocated: 1.4564900398254395  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.54253959655762  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.63922834396362  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

number of input  17248302
----------------------------------------after optimizer
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.518690586090088  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.29995059967041
pure train time :  9.280090570449829
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.014483928680419922
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.042261600494384766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014539718627929688
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.1857647895812988  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.20817232131958  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.209507465362549  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2281622886657715  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.032066822052  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.09343671798706  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.1847667694091797  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.215106964111328  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.216458320617676  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2398719787597656  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.397507190704346  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.49419593811035  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2289695739746094  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.26248836517334  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.263827323913574  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.279362678527832  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.58697032928467  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.683659076690674  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2699894905090332  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2933053970336914  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.294607162475586  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3080768585205078  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.40641260147095  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.50310134887695  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2963199615478516  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.327800750732422  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.3291397094726562  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3515830039978027  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.31760787963867  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.41429662704468  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3406686782836914  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.3680434226989746  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.369345188140869  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.383573055267334  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.380159854888916  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.47684860229492  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3725767135620117  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.4006400108337402  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.4019789695739746  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.420365333557129  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.388972759246826  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.48566150665283  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.4084978103637695  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.437166690826416  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.4384684562683105  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.4561195373535156  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.47434759140015  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.571033000946045  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

number of input  17249432
----------------------------------------after optimizer
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.5183873176574707  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.000028133392334
pure train time :  7.212030649185181
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.016530752182006836
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03034353256225586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016571044921875
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.1869807243347168  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2166781425476074  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.218029499053955  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2358412742614746  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.50805473327637  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.56936311721802  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.1921868324279785  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2227745056152344  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.224093437194824  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2401442527770996  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.27648067474365  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.37316942214966  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.229668140411377  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.253739356994629  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2550950050354004  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2706165313720703  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.130577087402344  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.22726583480835  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2600350379943848  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.290283203125  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2915005683898926  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3132166862487793  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.443087100982666  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.53977584838867  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3018817901611328  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.3301730155944824  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.3314919471740723  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3470911979675293  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.37770080566406  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.47438955307007  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3352651596069336  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.369391918182373  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.3706092834472656  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3881516456604004  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.51274919509888  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.60943794250488  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.377598762512207  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.4026875495910645  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.4040064811706543  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.4157042503356934  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.436545848846436  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.53323459625244  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.4039850234985352  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.431335926055908  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.432553291320801  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.453078269958496  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.28046655654907  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.37715196609497  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

number of input  17258433
----------------------------------------after optimizer
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.5158939361572266  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7380118370056152
pure train time :  7.204278230667114
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.014823675155639648
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.031795501708984375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014860868453979492
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.186211109161377  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.219226837158203  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2205824851989746  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2397994995117188  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.44029521942139  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.5009708404541  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.1954402923583984  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.229985237121582  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2313289642333984  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2441835403442383  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.44324588775635  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.53993463516235  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2328038215637207  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2609405517578125  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2621006965637207  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2732234001159668  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.23522090911865  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.33190965652466  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.261725902557373  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2861313819885254  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2872915267944336  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3050041198730469  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.26959753036499  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.366286277770996  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2944941520690918  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.322742462158203  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.3239026069641113  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3454103469848633  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.37450838088989  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.4711971282959  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3337254524230957  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.3611183166503906  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.362442970275879  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3799753189086914  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.2525053024292  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.349194049835205  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3713946342468262  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.400740623474121  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.4019007682800293  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.4202852249145508  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.43952035903931  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.53620910644531  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.4086971282958984  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.4311342239379883  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.4324588775634766  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.4489421844482422  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.41217660903931  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.50886535644531  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

number of input  17254375
----------------------------------------after optimizer
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.5119600296020508  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.5147407054901123
pure train time :  7.11557412147522
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.016983985900878906
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030520200729370117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.017023563385009766
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.1816377639770508  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2074108123779297  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.208766460418701  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2326197624206543  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.29585552215576  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.356297969818115  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.187757968902588  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.215677261352539  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.217010498046875  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2369427680969238  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.263699531555176  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.36038827896118  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.22536039352417  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.255019187927246  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2563648223876953  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.274280071258545  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.416075229644775  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.51276397705078  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2630491256713867  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2946667671203613  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.295994281768799  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3121938705444336  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.49520301818848  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.59189176559448  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.300809383392334  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.3292832374572754  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.330597400665283  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3446197509765625  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.22202777862549  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.318716526031494  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3332786560058594  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.359290599822998  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.3606181144714355  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3777756690979004  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.25797367095947  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.35466241836548  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3660778999328613  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.39691162109375  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.398076057434082  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.4178528785705566  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.46934938430786  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.56603813171387  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.4061355590820312  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.4354324340820312  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.436746597290039  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.4518427848815918  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.50830078125  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.604989528656006  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

number of input  17256733
----------------------------------------after optimizer
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.5140371322631836  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.364199161529541
pure train time :  7.468322038650513
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.01685047149658203
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0371701717376709
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016904830932617188
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.187513828277588  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2123794555664062  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2137279510498047  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2307257652282715  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.26645803451538  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.32787370681763  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.1868267059326172  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2181529998779297  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.219491481781006  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2404422760009766  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.39500284194946  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.49169158935547  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2289772033691406  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2562155723571777  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2575430870056152  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.271921157836914  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.264384746551514  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.36107349395752  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2605137825012207  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2905802726745605  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2919187545776367  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3103241920471191  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.18175935745239  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.2784481048584  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.301098346710205  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.3304929733276367  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.331820487976074  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.347581386566162  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.44957494735718  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.546263694763184  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3358535766601562  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.3672990798950195  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.3686275482177734  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3850407600402832  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.47918367385864  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.57587242126465  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.3745512962341309  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.4002532958984375  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.4015755653381348  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.415809154510498  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.37586450576782  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.47255325317383  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.406383991241455  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.4355039596557617  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.436831474304199  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.4572138786315918  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.512569427490234  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.60925817489624  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

number of input  17257797
----------------------------------------after optimizer
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.519782543182373  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.286072254180908
pure train time :  7.49620509147644
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.01764082908630371
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03375506401062012
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.017685651779174805
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.1880640983581543  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.218204975128174  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2195606231689453  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2367448806762695  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.23751163482666  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.298213481903076  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.1919398307800293  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2187676429748535  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.2201294898986816  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2357368469238281  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.34568548202515  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 60.44237422943115  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.224409580230713  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.259385585784912  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 2.260715961456299  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 71.96917724609375 GB
    Memory Allocated: 1.2799077033996582  GigaBytes
Max Memory Allocated: 62.6122727394104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.10980224609375 GB
    Memory Allocated: 60.70102262496948  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.10980224609375 GB
    Memory Allocated: 60.79771137237549  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 65.44964599609375 GB
    Memory Allocated: 1.2693605422973633  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.44964599609375 GB
    Memory Allocated: 2.2935900688171387  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.44964599609375 GB
    Memory Allocated: 2.2948708534240723  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.44964599609375 GB
    Memory Allocated: 1.305981159210205  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.44964599609375 GB
    Memory Allocated: 60.11185169219971  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 65.44964599609375 GB
    Memory Allocated: 60.20854043960571  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 1.2947335243225098  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 2.3242931365966797  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 2.3256235122680664  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 1.3472094535827637  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 60.38648176193237  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 60.48317050933838  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 1.3354482650756836  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 2.3616256713867188  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 2.3629064559936523  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 1.378960132598877  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 60.303998947143555  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 60.40068769454956  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 1.3677783012390137  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 2.392549991607666  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 2.393876552581787  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.45159912109375 GB
    Memory Allocated: 1.4134116172790527  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 66.14886474609375 GB
    Memory Allocated: 60.34097671508789  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 66.14886474609375 GB
    Memory Allocated: 60.4376654624939  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 67.47503662109375 GB
    Memory Allocated: 1.4024062156677246  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 67.47503662109375 GB
    Memory Allocated: 2.432274341583252  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 67.47503662109375 GB
    Memory Allocated: 2.4335551261901855  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.47503662109375 GB
    Memory Allocated: 1.4545178413391113  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 67.47503662109375 GB
    Memory Allocated: 60.46365833282471  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 67.47503662109375 GB
    Memory Allocated: 60.560343742370605  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

number of input  17252328
----------------------------------------after optimizer
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.517343521118164  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0845794677734375
pure train time :  8.17340898513794
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.017601490020751953
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.032747745513916016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.017647743225097656
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.188692569732666  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.2186732292175293  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.220028877258301  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.236527442932129  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.30675935745239  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.367534160614014  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.1953020095825195  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.220832347869873  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.222541332244873  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.2381839752197266  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.12758779525757  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.224276542663574  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.2283844947814941  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.25888729095459  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.2602429389953613  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.2802515029907227  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.50412321090698  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.60081195831299  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.2697978019714355  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.2994866371154785  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.3008222579956055  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.3160982131958008  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.37716484069824  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.47385358810425  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.3063640594482422  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.330050468444824  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.3313779830932617  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.3473200798034668  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.25659656524658  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.35328531265259  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.3357563018798828  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.3691458702087402  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.370481491088867  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.3925724029541016  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.40874767303467  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.505436420440674  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.3816304206848145  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.407576084136963  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.4089035987854004  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.4212393760681152  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.41636371612549  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.513052463531494  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.4108290672302246  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.4392075538635254  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.4405431747436523  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.4602928161621094  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.41836452484131  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.51504993438721  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

number of input  17253485
----------------------------------------after optimizer
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.5224928855895996  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9601590633392334
pure train time :  7.487337112426758
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.017865419387817383
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.044272422790527344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.017937660217285156
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.1867008209228516  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.2187252044677734  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.220073699951172  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.2381434440612793  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.47578048706055  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.53711223602295  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.1944403648376465  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.2295894622802734  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.2309188842773438  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.2448740005493164  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.596304416656494  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.6929931640625  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.234161376953125  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.260803699493408  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.2620654106140137  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.2725563049316406  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.187572956085205  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.28426170349121  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.26094388961792  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.2935705184936523  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.294832229614258  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.314058780670166  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.41790056228638  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.51458930969238  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.3022937774658203  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.3282904624938965  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.329552173614502  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.3426189422607422  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.25432348251343  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.351012229919434  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.3313312530517578  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.35872220993042  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.3599839210510254  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.3798189163208008  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.421677589416504  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.51836633682251  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.36879301071167  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.3912429809570312  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.392411231994629  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.4107108116149902  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.271822452545166  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 60.36851119995117  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.399099349975586  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.422700881958008  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 2.4238691329956055  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.80316162109375 GB
    Memory Allocated: 1.4471592903137207  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.253082275390625  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.34976768493652  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

number of input  17250924
----------------------------------------after optimizer
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.5092058181762695  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8650197982788086
pure train time :  7.509561777114868
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.01763772964477539
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03792142868041992
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.017694950103759766
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.1816697120666504  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.20798397064209  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.2093396186828613  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.2321281433105469  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.16246461868286  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.22388315200806  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.1885991096496582  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.218188762664795  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.219557285308838  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.2389893531799316  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.2925329208374  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.38922166824341  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.229074478149414  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.2641706466674805  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.265524387359619  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.2817978858947754  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.43621635437012  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.53290510177612  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.2707386016845703  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.298954486846924  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.30029296875  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.3108820915222168  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.253440856933594  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.3501296043396  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.2993388175964355  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.31746768951416  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.318612575531006  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.3359417915344238  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.16378211975098  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.26047086715698  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.3253021240234375  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.3581767082214355  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.3593215942382812  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.387690544128418  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.56378936767578  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.66047811508179  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.3765854835510254  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.4069442749023438  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.4080891609191895  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.4210457801818848  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.263832569122314  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 60.36052131652832  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.4093780517578125  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.4360580444335938  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 2.4372029304504395  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.85003662109375 GB
    Memory Allocated: 1.4528660774230957  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 69.55511474609375 GB
    Memory Allocated: 60.64076280593872  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 69.55511474609375 GB
    Memory Allocated: 60.73744821548462  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

number of input  17253811
----------------------------------------after optimizer
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.5157661437988281  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7478299140930176
pure train time :  7.687053918838501
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.015218257904052734
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03413677215576172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015267610549926758
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.1854586601257324  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2178025245666504  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2189950942993164  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2389488220214844  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.453632831573486  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.51431751251221  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.194282054901123  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2176456451416016  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2189455032348633  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2330517768859863  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.04989194869995  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.14658069610596  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2215209007263184  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2523202896118164  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2535128593444824  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2760725021362305  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.52390956878662  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.62059831619263  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2651386260986328  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.293910026550293  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2952098846435547  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3103456497192383  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.36865472793579  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.4653434753418  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2992362976074219  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.325169563293457  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.326362133026123  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3432879447937012  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.268332958221436  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.36502170562744  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3328957557678223  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.363431930541992  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.364731788635254  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3851079940795898  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.38340997695923  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.480098724365234  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3745946884155273  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.402298927307129  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.403491497039795  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4185771942138672  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.199097633361816  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.29578638076782  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4069185256958008  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.436128616333008  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.4373717308044434  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4555768966674805  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.47058296203613  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.56727170944214  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

number of input  17256755
----------------------------------------after optimizer
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.5202999114990234  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6816227436065674
pure train time :  7.555042266845703
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.014058589935302734
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.031824588775634766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014111042022705078
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.1897616386413574  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.217649459838867  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.218982696533203  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2361721992492676  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.283082008361816  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.34209203720093  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.1908202171325684  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2186450958251953  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.219806671142578  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2376904487609863  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.34430503845215  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.440993785858154  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.229116439819336  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2552223205566406  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2563838958740234  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2744364738464355  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.26355171203613  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.36024045944214  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2633695602416992  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.293971538543701  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.295133113861084  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3150849342346191  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.5388388633728  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.63552761077881  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3051180839538574  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3344149589538574  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3355765342712402  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3508872985839844  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.37369918823242  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.47038793563843  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.339247226715088  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3664212226867676  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3675827980041504  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3841633796691895  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.38308095932007  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.479769706726074  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3734478950500488  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.404135227203369  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.405296802520752  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4245405197143555  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.49313259124756  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.589821338653564  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4128551483154297  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.4421520233154297  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.4433135986328125  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4583778381347656  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.2298378944397  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.326523303985596  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

number of input  17255112
----------------------------------------after optimizer
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.5212721824645996  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6109824180603027
pure train time :  7.5736610889434814
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.014393806457519531
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03217005729675293
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014438867568969727
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.187161922454834  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.213076591491699  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2144322395324707  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2315788269042969  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.23331594467163  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.294930934906006  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.1884560585021973  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2203493118286133  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2217302322387695  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2415943145751953  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.33388614654541  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.430574893951416  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.230029582977295  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.259702205657959  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2610573768615723  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.274846076965332  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.243608474731445  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.34029722213745  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2652473449707031  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.292084217071533  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2934398651123047  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3094940185546875  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.389644145965576  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.48633289337158  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2992711067199707  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3299031257629395  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.331237316131592  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.350186824798584  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.42977428436279  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.5264630317688  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3392887115478516  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.368980884552002  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3703179359436035  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3855252265930176  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.52341270446777  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.62010145187378  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.374438762664795  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.403735637664795  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.4050660133361816  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4211130142211914  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.42469310760498  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.521381855010986  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4093008041381836  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.434441089630127  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.4357752799987793  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.452162265777588  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.40289783477783  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.49958658218384  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

number of input  17257433
----------------------------------------after optimizer
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.5156230926513672  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.545193672180176
pure train time :  7.548652410507202
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.013562440872192383
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03199172019958496
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.013611793518066406
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.1837711334228516  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2151565551757812  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2165069580078125  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2378063201904297  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.466293811798096  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.527315616607666  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.1947174072265625  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2240142822265625  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2253451347351074  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2396631240844727  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.265910148620605  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.36259889602661  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.22930908203125  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.258000373840332  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2593560218811035  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2762885093688965  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.30870532989502  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.405394077301025  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2644777297973633  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2937746047973633  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.295105457305908  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.312032699584961  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.14950895309448  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.24619770050049  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.300398826599121  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.324054718017578  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.325401782989502  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3417491912841797  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.24166917800903  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.33835792541504  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3301668167114258  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3571925163269043  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3583550453186035  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3804388046264648  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.43491554260254  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.531604290008545  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3699712753295898  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3988256454467773  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.4001564979553223  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4190301895141602  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.437114238739014  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.53380298614502  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4072332382202148  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.4381394386291504  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.4393019676208496  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.456242561340332  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.49281644821167  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.58950185775757  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

number of input  17256222
----------------------------------------after optimizer
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.5201191902160645  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4796104431152344
pure train time :  7.664489030838013
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.017160654067993164
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04111289978027344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.017223358154296875
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.1905980110168457  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2183990478515625  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.219742774963379  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2354092597961426  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.4660964012146  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.52634572982788  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.1900606155395508  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.219451904296875  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.220778465270996  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2386183738708496  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.1028208732605  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.199509620666504  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.226837158203125  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2575693130493164  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.258924961090088  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2760038375854492  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.40727424621582  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.503962993621826  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2652311325073242  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.294528007507324  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2958545684814453  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3110661506652832  GigaBytes
Max Memory Allocated: 62.66018199920654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.72121524810791  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.817903995513916  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2999649047851562  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3276281356811523  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3289241790771484  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3452415466308594  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.21353530883789  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.3102240562439  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3347220420837402  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3626022338867188  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.36392879486084  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3820199966430664  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.357998847961426  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.45468759536743  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.370194911956787  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3982224464416504  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.399420738220215  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4172577857971191  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.41098356246948  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.50767230987549  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4056129455566406  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.433795928955078  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.4349942207336426  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4527473449707031  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.34118843078613  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.43787384033203  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

number of input  17256894
----------------------------------------after optimizer
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.5152945518493652  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.433349609375
pure train time :  7.477347373962402
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.016667604446411133
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03614687919616699
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016713857650756836
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.1866888999938965  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.216268539428711  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2176241874694824  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2358970642089844  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.3276309967041  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.38864183425903  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.192000389099121  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.219604015350342  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.221297264099121  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2373886108398438  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.192158699035645  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.28884744644165  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.225792407989502  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.258302688598633  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2596497535705566  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2774701118469238  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.33207035064697  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.42875909805298  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2659869194030762  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.29630708694458  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2976627349853516  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.310837745666504  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.24191236495972  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.33860111236572  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2990107536315918  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3243155479431152  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.325662612915039  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3409247398376465  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.20749521255493  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.30418395996094  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3298020362854004  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3572144508361816  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.358570098876953  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3790736198425293  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.48694038391113  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.58362913131714  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3682894706726074  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.39532470703125  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3966660499572754  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4150581359863281  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.605090618133545  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.70177936553955  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.403963565826416  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.4322056770324707  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.4335265159606934  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.452226161956787  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.49770641326904  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.59439516067505  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

number of input  17255384
----------------------------------------after optimizer
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.514805793762207  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.381160020828247
pure train time :  7.493312835693359
the output layer 
self.num_batch (get_in_degree_bucketing) 8
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  8
random partition time  0.01964092254638672
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03601408004760742
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.019685983657836914
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.186866283416748  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.216163158416748  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.217500686645508  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2355313301086426  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.10266160964966  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.163676738739014  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.1910953521728516  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2194862365722656  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.220841884613037  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2372665405273438  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.22450542449951  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.32119417190552  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2254385948181152  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2493948936462402  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.250732421875  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2682180404663086  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.333969593048096  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.4306583404541  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2565703392028809  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.284970760345459  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.2863264083862305  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3080906867980957  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.28718328475952  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.38387203216553  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.2969050407409668  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.323409080505371  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.324746608734131  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3420791625976562  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.43496084213257  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.531649589538574  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3307671546936035  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.3579444885253906  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.359300136566162  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3784432411193848  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.282506465911865  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.37919521331787  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.3667855262756348  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.398775577545166  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.400113105773926  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4188413619995117  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.67701292037964  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.773701667785645  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4072012901306152  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.4371814727783203  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 2.438490867614746  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.4522290229797363  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.47455310821533  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 60.57124185562134  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

number of input  17249462
----------------------------------------after optimizer
 Nvidia-smi: 70.88909912109375 GB
    Memory Allocated: 1.5155377388000488  GigaBytes
Max Memory Allocated: 62.68005609512329  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3417744636535645
pure train time :  7.485287189483643
epoch_time_list  [45.5756561756134, 42.98330545425415, 43.16107225418091, 46.94406986236572, 44.53774547576904, 43.304250717163086, 43.393125772476196, 47.27228856086731, 43.93512153625488, 43.75631928443909, 43.606181383132935, 43.98521327972412, 43.88485145568848, 45.12498426437378, 44.7648446559906, 45.30175495147705, 45.799819469451904, 43.79499101638794, 42.47038507461548, 43.05505299568176]

loading_time list   [0.8552827835083008, 0.8913078308105469, 0.7937638759613037, 0.810077428817749, 1.108457326889038, 0.8315389156341553, 0.8132491111755371, 0.828538179397583, 0.848783016204834, 0.8483219146728516, 0.8354935646057129, 0.8086268901824951, 0.8962669372558594, 0.9480075836181641, 0.869969367980957, 0.8145513534545898, 0.8093447685241699, 1.0868651866912842, 0.807873010635376, 0.7903831005096436]

 data loader gen time  32.015650033950806
	---backpack schedule time  [0.1949143409729004, 0.18384838104248047, 0.18012785911560059, 0.17398428916931152, 0.20144104957580566, 0.1789534091949463, 0.17685317993164062, 0.17679238319396973, 0.19102859497070312, 0.18108606338500977, 0.1782245635986328, 0.20740509033203125, 0.1920018196105957, 0.18371129035949707, 0.17490291595458984, 0.17658567428588867, 0.1781148910522461, 0.19243121147155762, 0.18140912055969238, 0.1847057342529297]
	---connection_check_time_list  [5.897701740264893, 5.758399724960327, 5.768012523651123, 7.26967978477478, 6.801149368286133, 5.9454240798950195, 5.927709579467773, 9.778297662734985, 6.1669228076934814, 5.464938402175903, 6.217014789581299, 6.452477931976318, 5.502647161483765, 6.804274320602417, 7.1378278732299805, 7.976867437362671, 8.214999914169312, 6.603616952896118, 5.481722354888916, 5.952165126800537]
	---block_gen_time_list  [3.4738738536834717, 3.3987362384796143, 3.5598177909851074, 3.627239465713501, 3.9238107204437256, 3.590061664581299, 3.925856113433838, 3.6347439289093018, 3.601590633392334, 3.5461137294769287, 3.5603229999542236, 3.6419661045074463, 3.778265953063965, 3.5861265659332275, 3.6106953620910645, 3.612304449081421, 3.5696558952331543, 3.4518229961395264, 3.4691274166107178, 3.491335391998291]
training time  [12.795900821685791, 10.340695858001709, 10.30020546913147, 12.401589155197144, 9.837751626968384, 10.258515119552612, 10.054064512252808, 10.253740072250366, 10.530020713806152, 11.167069911956787, 10.257185935974121, 10.370667219161987, 10.969592332839966, 10.52113938331604, 10.441407203674316, 10.24786901473999, 10.529973268508911, 10.060065984725952, 10.161756753921509, 10.232513666152954]
---feature block loading time  [2.7096524238586426, 3.156757354736328, 3.0864315032958984, 3.1085078716278076, 2.6112208366394043, 3.040168046951294, 2.9281766414642334, 2.76979398727417, 3.019430160522461, 2.9794766902923584, 2.7545578479766846, 2.846557140350342, 3.2733705043792725, 2.9468839168548584, 2.8496248722076416, 2.6822845935821533, 2.8475725650787354, 2.566598653793335, 2.653590440750122, 2.733757972717285]


epoch_time avg   44.24918311834335
loading_time avg   0.8716418892145157
 data loader gen time avg 32.99296525120735
	---backpack schedule time avg 0.18472793698310852
	---connection_check_time avg  6.651753485202789
	---block_gen_time avg  3.624612495303154
training time  10.368333294987679
---feature block loading time  2.843941554427147
pure train time per /epoch  [10.076520919799805, 7.169989824295044, 7.2005109786987305, 9.280090570449829, 7.212030649185181, 7.204278230667114, 7.11557412147522, 7.468322038650513, 7.49620509147644, 8.17340898513794, 7.487337112426758, 7.509561777114868, 7.687053918838501, 7.555042266845703, 7.5736610889434814, 7.548652410507202, 7.664489030838013, 7.477347373962402, 7.493312835693359, 7.485287189483643]
pure train time average  7.613626746570363
num_input list  [17253657, 17256221, 17251038, 17248302, 17249432, 17258433, 17254375, 17256733, 17257797, 17252328, 17253485, 17250924, 17253811, 17256755, 17255112, 17257433, 17256222, 17256894, 17255384, 17249462]
num_input  average  17254189.9
