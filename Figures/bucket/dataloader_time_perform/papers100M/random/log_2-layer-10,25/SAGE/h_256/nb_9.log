main start at this time 1714080619.521605
-----------------------------------------before load data 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
# Nodes: 111059956
# Edges: 1615685872
# Train: 1207179
# Val: 125265
# Test: 109727512
# Classes: 172

----------------------------------------start of run function 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.013373136520385742
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.040022850036621094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.013424158096313477
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 1.22113037109375 GB
    Memory Allocated: 0.003025054931640625  GigaBytes
Max Memory Allocated: 0.003025054931640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.18988037109375 GB
    Memory Allocated: 0.9703397750854492  GigaBytes
Max Memory Allocated: 0.9703397750854492  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 2.18988037109375 GB
    Memory Allocated: 0.9717750549316406  GigaBytes
Max Memory Allocated: 0.9717750549316406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.24456787109375 GB
    Memory Allocated: 1.0161466598510742  GigaBytes
Max Memory Allocated: 1.0161466598510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 58.08831787109375 GB
    Memory Allocated: 55.044376373291016  GigaBytes
Max Memory Allocated: 56.68709182739258  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 58.08831787109375 GB
    Memory Allocated: 55.130321979522705  GigaBytes
Max Memory Allocated: 56.68709182739258  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 59.27581787109375 GB
    Memory Allocated: 1.1102356910705566  GigaBytes
Max Memory Allocated: 56.68709182739258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.27581787109375 GB
    Memory Allocated: 2.073890209197998  GigaBytes
Max Memory Allocated: 56.68709182739258  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.27581787109375 GB
    Memory Allocated: 2.0754127502441406  GigaBytes
Max Memory Allocated: 56.68709182739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.27581787109375 GB
    Memory Allocated: 1.1510124206542969  GigaBytes
Max Memory Allocated: 56.68709182739258  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.32464599609375 GB
    Memory Allocated: 54.95432233810425  GigaBytes
Max Memory Allocated: 56.68709182739258  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.32464599609375 GB
    Memory Allocated: 55.04026746749878  GigaBytes
Max Memory Allocated: 56.68709182739258  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 60.50433349609375 GB
    Memory Allocated: 1.1386098861694336  GigaBytes
Max Memory Allocated: 56.68709182739258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.50433349609375 GB
    Memory Allocated: 2.105527877807617  GigaBytes
Max Memory Allocated: 56.68709182739258  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.50433349609375 GB
    Memory Allocated: 2.1066503524780273  GigaBytes
Max Memory Allocated: 56.68709182739258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.50433349609375 GB
    Memory Allocated: 1.1858553886413574  GigaBytes
Max Memory Allocated: 56.68709182739258  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.46917724609375 GB
    Memory Allocated: 55.19035005569458  GigaBytes
Max Memory Allocated: 56.91985273361206  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.46917724609375 GB
    Memory Allocated: 55.27629518508911  GigaBytes
Max Memory Allocated: 56.91985273361206  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.46917724609375 GB
    Memory Allocated: 1.1731047630310059  GigaBytes
Max Memory Allocated: 56.91985273361206  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.46917724609375 GB
    Memory Allocated: 2.1356945037841797  GigaBytes
Max Memory Allocated: 56.91985273361206  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.46917724609375 GB
    Memory Allocated: 2.136960983276367  GigaBytes
Max Memory Allocated: 56.91985273361206  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.46917724609375 GB
    Memory Allocated: 1.2132987976074219  GigaBytes
Max Memory Allocated: 56.91985273361206  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.51605224609375 GB
    Memory Allocated: 55.02430295944214  GigaBytes
Max Memory Allocated: 56.91985273361206  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 65.51605224609375 GB
    Memory Allocated: 55.11024808883667  GigaBytes
Max Memory Allocated: 56.91985273361206  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 65.51605224609375 GB
    Memory Allocated: 1.2003893852233887  GigaBytes
Max Memory Allocated: 56.91985273361206  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.51605224609375 GB
    Memory Allocated: 2.1697773933410645  GigaBytes
Max Memory Allocated: 56.91985273361206  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.51605224609375 GB
    Memory Allocated: 2.1708998680114746  GigaBytes
Max Memory Allocated: 56.91985273361206  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.51605224609375 GB
    Memory Allocated: 1.2514009475708008  GigaBytes
Max Memory Allocated: 56.91985273361206  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.35394287109375 GB
    Memory Allocated: 55.25342130661011  GigaBytes
Max Memory Allocated: 56.97910022735596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 79.35394287109375 GB
    Memory Allocated: 55.33936643600464  GigaBytes
Max Memory Allocated: 56.97910022735596  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 79.35394287109375 GB
    Memory Allocated: 1.2384562492370605  GigaBytes
Max Memory Allocated: 56.97910022735596  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 79.35394287109375 GB
    Memory Allocated: 2.2105140686035156  GigaBytes
Max Memory Allocated: 56.97910022735596  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 79.35394287109375 GB
    Memory Allocated: 2.211780548095703  GigaBytes
Max Memory Allocated: 56.97910022735596  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 79.35394287109375 GB
    Memory Allocated: 1.2856512069702148  GigaBytes
Max Memory Allocated: 56.97910022735596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 58.54925537109375 GB
    Memory Allocated: 55.39124631881714  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 58.54925537109375 GB
    Memory Allocated: 55.47719144821167  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 1.2739744186401367  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 2.2407097816467285  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 2.2418322563171387  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 1.3129081726074219  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 55.329866886138916  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 55.41581201553345  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 1.3006176948547363  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 2.269298553466797  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 2.2704243659973145  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 1.3469524383544922  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 55.38611698150635  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 55.47206211090088  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 1.3341960906982422  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 2.3016409873962402  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 2.3027634620666504  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 1.3776631355285645  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 55.367294788360596  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.73284912109375 GB
    Memory Allocated: 55.45323991775513  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

number of input  18255255
----------------------------------------after optimizer
 Nvidia-smi: 59.73480224609375 GB
    Memory Allocated: 1.4418578147888184  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.175734043121338
pure train time :  11.144917249679565
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.015179872512817383
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03335404396057129
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01521921157836914
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 59.73480224609375 GB
    Memory Allocated: 1.1112375259399414  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.73480224609375 GB
    Memory Allocated: 2.0779318809509277  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.73480224609375 GB
    Memory Allocated: 2.0794544219970703  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.73480224609375 GB
    Memory Allocated: 1.155261516571045  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.73480224609375 GB
    Memory Allocated: 55.167685985565186  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.73480224609375 GB
    Memory Allocated: 55.22185039520264  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 60.91644287109375 GB
    Memory Allocated: 1.1141901016235352  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.91644287109375 GB
    Memory Allocated: 2.081989288330078  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.91644287109375 GB
    Memory Allocated: 2.082988739013672  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.91644287109375 GB
    Memory Allocated: 1.1591548919677734  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 55.143134117126465  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 55.229079246520996  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 1.1468968391418457  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 2.1148324012756348  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 2.116333484649658  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 1.1923561096191406  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 55.05462121963501  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 55.14056634902954  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 1.1795969009399414  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 2.147535800933838  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 2.1485352516174316  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 1.223473072052002  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 55.246299266815186  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 55.33224439620972  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 1.2110342979431152  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 2.1768956184387207  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 2.178396701812744  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 1.2538166046142578  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 55.160701274871826  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 55.24664640426636  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 1.2416248321533203  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 2.208800792694092  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 2.2098002433776855  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.44769287109375 GB
    Memory Allocated: 1.2867989540100098  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.44964599609375 GB
    Memory Allocated: 55.11018085479736  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.44964599609375 GB
    Memory Allocated: 55.196125984191895  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 62.44964599609375 GB
    Memory Allocated: 1.2772231101989746  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.44964599609375 GB
    Memory Allocated: 2.2475767135620117  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.44964599609375 GB
    Memory Allocated: 2.249077796936035  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.44964599609375 GB
    Memory Allocated: 1.3252787590026855  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.93597412109375 GB
    Memory Allocated: 55.3853120803833  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.93597412109375 GB
    Memory Allocated: 55.47125720977783  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.93597412109375 GB
    Memory Allocated: 1.3131742477416992  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.93597412109375 GB
    Memory Allocated: 2.2813353538513184  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.93597412109375 GB
    Memory Allocated: 2.282334804534912  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.93597412109375 GB
    Memory Allocated: 1.3548822402954102  GigaBytes
Max Memory Allocated: 57.118821144104004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.98284912109375 GB
    Memory Allocated: 55.38574028015137  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 65.98284912109375 GB
    Memory Allocated: 55.4716854095459  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 1.3427925109863281  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 2.3090972900390625  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 2.310598373413086  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 1.3858237266540527  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 55.39051818847656  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 55.476463317871094  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

number of input  18262471
----------------------------------------after optimizer
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 1.4439001083374023  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.743391990661621
pure train time :  7.4674224853515625
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.01408839225769043
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029618263244628906
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01412653923034668
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 1.1105608940124512  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 2.0747299194335938  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 2.0762524604797363  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 1.152799129486084  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 54.869529247283936  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 54.92360877990723  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 1.1133108139038086  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 2.081859588623047  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 2.0828590393066406  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 1.161576271057129  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 55.285274028778076  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 55.37121915817261  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 1.1491961479187012  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 2.116694927215576  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 2.1182174682617188  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 1.1930665969848633  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 55.25058364868164  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 55.33652877807617  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 1.1801905632019043  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 2.146878719329834  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 2.148571491241455  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 1.2239418029785156  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 55.15419387817383  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 55.24013900756836  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 1.2116098403930664  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 2.1790614128112793  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 2.180583953857422  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 65.98480224609375 GB
    Memory Allocated: 1.2566423416137695  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.36607599258423  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.45202112197876  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.2444424629211426  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.209383964538574  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.2110767364501953  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.2864723205566406  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.190470695495605  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.27641582489014  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.2741284370422363  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.2445144653320312  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.246037006378174  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.3237695693969727  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.259881019592285  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.345826148986816  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.3112354278564453  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.2791852951049805  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.2808780670166016  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.3533287048339844  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.216758728027344  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.302703857421875  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.3408265113830566  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.307992458343506  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.3095149993896484  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.384221076965332  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.23393774032593  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.31988286972046  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

number of input  18255288
----------------------------------------after optimizer
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.4420161247253418  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.526861667633057
pure train time :  7.467199802398682
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.016379117965698242
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03354382514953613
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01642775535583496
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.111128330230713  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.0772643089294434  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.0782885551452637  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.1540040969848633  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.23694181442261  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.29133653640747  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.1127991676330566  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.082752227783203  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.0842747688293457  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.1619014739990234  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.1537389755249  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.239684104919434  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.149003505706787  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.1127429008483887  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.1137423515319824  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.1869473457336426  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.18073844909668  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.26668357849121  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.1741962432861328  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.1421337127685547  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.1435084342956543  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.223130702972412  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.11423969268799  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.20018482208252  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.2108349800109863  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.1757936477661133  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.176793098449707  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.2518601417541504  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.22161674499512  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.30756187438965  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.239081859588623  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.208965301513672  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.2103400230407715  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.2887611389160156  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.285380363464355  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.37132549285889  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.276045322418213  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.2414817810058594  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.242481231689453  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.316103458404541  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.12365770339966  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.20960283279419  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.3053030967712402  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.273495674133301  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.2748703956604004  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.3528032302856445  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.30262899398804  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.38857412338257  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.3402862548828125  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.3076281547546387  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.3086276054382324  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.3834481239318848  GigaBytes
Max Memory Allocated: 57.122100830078125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.418678283691406  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 55.50462341308594  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

number of input  18252728
----------------------------------------after optimizer
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.441713809967041  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.3007121086120605
pure train time :  7.617376089096069
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.013783693313598633
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04034733772277832
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.013837099075317383
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.1112861633300781  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.0705318450927734  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.071906566619873  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.1479177474975586  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 54.87716197967529  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 54.93105173110962  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.1061949729919434  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.0778236389160156  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 2.079346179962158  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 68.16448974609375 GB
    Memory Allocated: 1.1631174087524414  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.262794971466064  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.348740100860596  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.1504096984863281  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.120209217071533  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.121208667755127  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.192451000213623  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.20628309249878  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.29222822189331  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.1797261238098145  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.14617919921875  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.1471915245056152  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.2208023071289062  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.27614450454712  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.36208963394165  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.208451747894287  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.1782350540161133  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.179234504699707  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.2561779022216797  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.381155014038086  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.46710014343262  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.2438111305236816  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.207071304321289  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.2080836296081543  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.281693458557129  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 54.9392876625061  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.025232791900635  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.2688241004943848  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.2356319427490234  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.236631393432617  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.3167238235473633  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.21791696548462  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.30386209487915  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.3052749633789062  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.2724695205688477  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.273481845855713  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.350041389465332  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.31523036956787  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.4011754989624  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.3378353118896484  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.3055806159973145  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.306580066680908  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.3827447891235352  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.35246753692627  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.4384126663208  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

number of input  18249245
----------------------------------------after optimizer
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.4426202774047852  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.999802589416504
pure train time :  7.522387742996216
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.016869544982910156
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.033212900161743164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016918420791625977
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.1132822036743164  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.081425666809082  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.0824379920959473  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.1581144332885742  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.24890756607056  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.301204681396484  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.1151342391967773  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.0839157104492188  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.0854382514953613  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.1606740951538086  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.218796730041504  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.304741859436035  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.1478056907653809  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.113208770751953  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.114208221435547  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.1882858276367188  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.05899238586426  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.14493751525879  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.1765475273132324  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.143557071685791  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.1450114250183105  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.2229785919189453  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.21572399139404  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.301669120788574  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.2102432250976562  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.180250644683838  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.1812500953674316  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.257169246673584  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.29771280288696  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.383657932281494  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.2447633743286133  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.2087578773498535  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.210212230682373  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.283583641052246  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.21785068511963  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.30379581451416  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.2716221809387207  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.2410459518432617  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.2420454025268555  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.3209595680236816  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.22833251953125  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.31427764892578  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.308140754699707  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.276352882385254  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.2778072357177734  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.351759433746338  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.35783290863037  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.4437780380249  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.3396010398864746  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.3063507080078125  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.3073501586914062  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.382033348083496  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.16450214385986  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.250447273254395  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

number of input  18261423
----------------------------------------after optimizer
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.4412007331848145  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.735459327697754
pure train time :  7.57744026184082
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.016269922256469727
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03303813934326172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016313791275024414
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.1110591888427734  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.082620620727539  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.0840749740600586  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.1607117652893066  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.220547676086426  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 55.27407217025757  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.1185336112976074  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.092344284057617  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 2.093379020690918  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 70.34808349609375 GB
    Memory Allocated: 1.164769172668457  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.31300449371338  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.39894962310791  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1522011756896973  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.1199841499328613  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.121438503265381  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1909608840942383  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.122583866119385  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.208528995513916  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1780495643615723  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.1421327590942383  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.143167495727539  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2183313369750977  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.19860553741455  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.28455066680908  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2055168151855469  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.171889305114746  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.1729445457458496  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2527832984924316  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.1754264831543  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.26137161254883  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2405848503112793  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.208484172821045  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.2100067138671875  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2869315147399902  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.1792516708374  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.265196800231934  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2741703987121582  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.23567533493042  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.2367305755615234  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.311647891998291  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 54.93862724304199  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.02457237243652  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2995657920837402  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.2699131965637207  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.2714357376098633  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.353254795074463  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.40109395980835  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.48703908920288  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.3407249450683594  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.3025403022766113  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.303595542907715  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.3761115074157715  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.26314926147461  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.34909439086914  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

number of input  18256081
----------------------------------------after optimizer
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.4351563453674316  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.5151925086975098
pure train time :  7.99372673034668
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.016258955001831055
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.042258262634277344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01631927490234375
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1066017150878906  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.071549415588379  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.0730719566345215  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1545777320861816  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.117419719696045  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.170523166656494  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.112027645111084  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.076465129852295  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.0774645805358887  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1553850173950195  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.129756450653076  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.21570158004761  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.142977237701416  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.1133694648742676  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.1143922805786133  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1933536529541016  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.348567485809326  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.43451261520386  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1805248260498047  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.1475648880004883  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.149087429046631  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.222060203552246  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.245505809783936  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.33145093917847  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2092313766479492  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.181682586669922  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.1827054023742676  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2588353157043457  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.282968044281006  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.36891317367554  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2460641860961914  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.2114005088806152  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.212923049926758  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.283796787261963  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.11758995056152  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.203535079956055  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2718462944030762  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.237307071685791  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.2383298873901367  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.315810203552246  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.05410146713257  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.1400465965271  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.3071355819702148  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.278355598449707  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.2798781394958496  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.3577871322631836  GigaBytes
Max Memory Allocated: 57.15185022354126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.471932888031006  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.55787801742554  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.3452134132385254  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.311622142791748  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.3126449584960938  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.3842692375183105  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.30837059020996  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.39431571960449  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

number of input  18261359
----------------------------------------after optimizer
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.4431304931640625  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3710129261016846
pure train time :  7.760071277618408
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.015440225601196289
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03917407989501953
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015487909317016602
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1100764274597168  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.0735630989074707  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.0750856399536133  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1520466804504395  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.04829454421997  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.10248422622681  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1106057167053223  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.0818305015563965  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.0828299522399902  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1622123718261719  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.29791736602783  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.38386249542236  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1494364738464355  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.116422653198242  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.117661952972412  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.18983793258667  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.12464189529419  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.21058702468872  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.1771373748779297  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.1457271575927734  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.146726608276367  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2228846549987793  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.064459800720215  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.150404930114746  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2106552124023438  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.1715550422668457  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.1727943420410156  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2475509643554688  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.03246259689331  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 55.11840772628784  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2383136749267578  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.2138428688049316  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 2.2148423194885254  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 72.53363037109375 GB
    Memory Allocated: 1.2971282005310059  GigaBytes
Max Memory Allocated: 57.207849979400635  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 58.95550537109375 GB
    Memory Allocated: 55.52098035812378  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 58.95550537109375 GB
    Memory Allocated: 55.60692548751831  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 58.95550537109375 GB
    Memory Allocated: 1.2851595878601074  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 58.95550537109375 GB
    Memory Allocated: 2.2540674209594727  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 58.95550537109375 GB
    Memory Allocated: 2.2553067207336426  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 58.95550537109375 GB
    Memory Allocated: 1.323141098022461  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.57659912109375 GB
    Memory Allocated: 55.28331232070923  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.57659912109375 GB
    Memory Allocated: 55.36925745010376  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 60.75628662109375 GB
    Memory Allocated: 1.3130345344543457  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.75628662109375 GB
    Memory Allocated: 2.275261878967285  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.75628662109375 GB
    Memory Allocated: 2.276261329650879  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.75628662109375 GB
    Memory Allocated: 1.3504705429077148  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.75628662109375 GB
    Memory Allocated: 55.09402322769165  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.75628662109375 GB
    Memory Allocated: 55.17996835708618  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 60.75823974609375 GB
    Memory Allocated: 1.337843894958496  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.75823974609375 GB
    Memory Allocated: 2.306835174560547  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.75823974609375 GB
    Memory Allocated: 2.308074474334717  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.75823974609375 GB
    Memory Allocated: 1.3892221450805664  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.3696928024292  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.45563793182373  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

number of input  18259573
----------------------------------------after optimizer
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.447524070739746  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2722954750061035
pure train time :  8.096455335617065
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.01488184928894043
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029636383056640625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01498270034790039
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.1131958961486816  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.079875946044922  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.0813984870910645  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.1555233001708984  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 54.953986167907715  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.00785541534424  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.1136994361877441  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.0840859413146973  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.0859851837158203  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.1621828079223633  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.27738380432129  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.36332893371582  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.1494550704956055  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.117981433868408  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.119503974914551  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.1916184425354004  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.24296188354492  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.32890701293945  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.1787934303283691  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.146533966064453  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.148433208465576  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.2227778434753418  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.24279260635376  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.32873773574829  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.2099332809448242  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.1755809783935547  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.1771035194396973  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.2518815994262695  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.204286098480225  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.290231227874756  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.2390046119689941  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.2084360122680664  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.209535598754883  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.2872991561889648  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.21969556808472  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.30564069747925  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.2754225730895996  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.2374825477600098  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.2390050888061523  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.3128294944763184  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.07220458984375  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.15814971923828  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.3000974655151367  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.264894485473633  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.2659788131713867  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.3467373847961426  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.13396596908569  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 55.219911098480225  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.3341732025146484  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.3027658462524414  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 2.3038501739501953  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.48089599609375 GB
    Memory Allocated: 1.3823442459106445  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.31384038925171  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.39978551864624  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

number of input  18253322
----------------------------------------after optimizer
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.4413080215454102  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0747146606445312
pure train time :  8.045766353607178
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.01676321029663086
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.033226728439331055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016820669174194336
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.112602710723877  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.081082820892334  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.0826053619384766  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.1573834419250488  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.12074136734009  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.17465019226074  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.117711067199707  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.0825905799865723  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.083590030670166  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.1579561233520508  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 54.958258628845215  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.044203758239746  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.1465544700622559  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.116546154022217  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.1180686950683594  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.1965842247009277  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.2896990776062  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.37564420700073  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.1842122077941895  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.1542439460754395  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.1555228233337402  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.2284116744995117  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.32168912887573  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.407634258270264  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.2155709266662598  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.178917407989502  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.1804399490356445  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.2534942626953125  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.05611181259155  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.142056941986084  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.2411656379699707  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.209221839904785  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.210500717163086  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.2900052070617676  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.28569984436035  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.37164497375488  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.2778992652893066  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.244719982147217  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 2.2462425231933594  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 1.3212246894836426  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.04272174835205  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52581787109375 GB
    Memory Allocated: 55.12866687774658  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3074684143066406  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2758431434631348  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2769274711608887  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3529977798461914  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.44242238998413  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.52836751937866  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3410120010375977  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.307039260864258  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.3083181381225586  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3832097053527832  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.13482475280762  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.22076988220215  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

number of input  18257823
----------------------------------------after optimizer
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.442072868347168  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9528086185455322
pure train time :  7.786509990692139
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.01698756217956543
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.051424503326416016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01705145835876465
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1100707054138184  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0818848609924316  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.083407402038574  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1605110168457031  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.33011341094971  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.384183406829834  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1188836097717285  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.092890739440918  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0938901901245117  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1649155616760254  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.18270683288574  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.26865196228027  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1526007652282715  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.118030071258545  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1194958686828613  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1888847351074219  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.15073871612549  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.23668384552002  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1766777038574219  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.144944190979004  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1459436416625977  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2234125137329102  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.07628679275513  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.16223192214966  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.210679054260254  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.180445671081543  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1819114685058594  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2570123672485352  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.2098274230957  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.295772552490234  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2442731857299805  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.209742546081543  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2107419967651367  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2841320037841797  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.116607666015625  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.202552795410156  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2732915878295898  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.237534523010254  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2385387420654297  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3164434432983398  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.215463161468506  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.30140829086304  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3039593696594238  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.26716947555542  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2684507369995117  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3475875854492188  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.24085474014282  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.32679986953735  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.334944248199463  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.296693801879883  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2976980209350586  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3775687217712402  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.069217681884766  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.1551628112793  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

number of input  18253518
----------------------------------------after optimizer
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.4362940788269043  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8526370525360107
pure train time :  7.771519899368286
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.01623702049255371
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03721785545349121
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01629924774169922
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1055593490600586  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0720300674438477  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0735526084899902  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.155160903930664  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.074355125427246  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.12838411331177  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1137638092041016  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0813398361206055  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0825963020324707  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1589813232421875  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.11917495727539  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.20512008666992  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.147726058959961  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1188573837280273  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1201138496398926  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1956663131713867  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.29599857330322  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.381943702697754  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.183133602142334  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1558895111083984  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1571459770202637  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2291250228881836  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.25424098968506  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.34018611907959  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2162189483642578  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.174576759338379  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.175833225250244  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2461705207824707  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 54.88971996307373  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 54.97566509246826  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2333974838256836  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1949105262756348  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1961669921875  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2809205055236816  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.09138250350952  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.17732763290405  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2683238983154297  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2405338287353516  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.241790294647217  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.323408603668213  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.37768316268921  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.46362829208374  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3109288215637207  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.277975082397461  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.279231548309326  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.350107192993164  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.17363882064819  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.259583950042725  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.337590217590332  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.3052124977111816  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.306468963623047  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3831329345703125  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.49662113189697  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.582566261291504  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

number of input  18255044
----------------------------------------after optimizer
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.4423794746398926  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7447168827056885
pure train time :  7.820732831954956
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.01619720458984375
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03257489204406738
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016245126724243164
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.112569808959961  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0853123664855957  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0868349075317383  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1627120971679688  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.33495855331421  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.38810205459595  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1208834648132324  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0853142738342285  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0872297286987305  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1573619842529297  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.01426601409912  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.10021114349365  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.144556999206543  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1110763549804688  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.112370491027832  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1904044151306152  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.11491298675537  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.2008581161499  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.179081916809082  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1485095024108887  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.149803638458252  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2263684272766113  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.23147439956665  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.31741952896118  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.213545322418213  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1789965629577637  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.180290699005127  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.25437593460083  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.15332221984863  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.239267349243164  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.243964672088623  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.21010160446167  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.211395740509033  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2889981269836426  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.106360912323  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.19230604171753  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.276473045349121  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2412772178649902  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2425713539123535  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3199443817138672  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.04461622238159  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.13056135177612  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3073368072509766  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2753162384033203  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2766103744506836  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3548741340637207  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.280170917510986  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.36611604690552  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.342026710510254  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.311026096343994  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.3123202323913574  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3877143859863281  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.30756092071533  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.39350605010986  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

number of input  18258836
----------------------------------------after optimizer
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.4456720352172852  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.676614761352539
pure train time :  8.00193476676941
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.015565633773803711
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03196287155151367
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01562643051147461
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1132068634033203  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0797653198242188  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0812878608703613  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.155369758605957  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.08356714248657  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.13748836517334  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1142559051513672  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.078103542327881  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0793113708496094  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1556382179260254  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.06770658493042  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.15365171432495  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1429142951965332  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1097588539123535  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.111116409301758  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.190439224243164  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.1172833442688  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.20322847366333  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1775760650634766  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1471738815307617  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1483817100524902  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2245664596557617  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.217177391052246  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.30312252044678  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.211766242980957  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.181762218475342  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.182832717895508  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2564091682434082  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.261451721191406  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.34739685058594  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.24367094039917  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2100272178649902  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2112350463867188  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2845449447631836  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.171207904815674  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.257153034210205  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2721762657165527  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.238781452178955  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.239837169647217  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.316659927368164  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.2436203956604  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.32956552505493  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3038368225097656  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2752346992492676  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2763051986694336  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3530211448669434  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.36619520187378  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.45214033126831  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3403491973876953  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.305635452270508  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.3066911697387695  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3785362243652344  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.045472145080566  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.1314172744751  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

number of input  18258833
----------------------------------------after optimizer
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.4379510879516602  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.606419324874878
pure train time :  7.742923259735107
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.015791893005371094
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03324127197265625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015844345092773438
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1098823547363281  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.075240135192871  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0767626762390137  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1547951698303223  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.056931495666504  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.110225677490234  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1122970581054688  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.081658363342285  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.082813262939453  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1602873802185059  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.06018400192261  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.14612913131714  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1480422019958496  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.116891384124756  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.118046283721924  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.191896915435791  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.157193660736084  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.243138790130615  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1790213584899902  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1428823471069336  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1440372467041016  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.218374252319336  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 54.95825433731079  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.04419946670532  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2068324089050293  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.176969051361084  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.178123950958252  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2575321197509766  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.410268783569336  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.49621391296387  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2454643249511719  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2123141288757324  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2134690284729004  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.286543369293213  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.16015100479126  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.24609613418579  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2741351127624512  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2464818954467773  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2476367950439453  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3243718147277832  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.4373722076416  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.52331733703613  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3120765686035156  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2795658111572266  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2807207107543945  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3515896797180176  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.256725788116455  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.342670917510986  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3392276763916016  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.301517963409424  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.302672863006592  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3784022331237793  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.183974266052246  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.26991939544678  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

number of input  18258942
----------------------------------------after optimizer
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.4366016387939453  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.540379524230957
pure train time :  7.788291931152344
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.01713848114013672
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04137682914733887
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01720452308654785
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1063175201416016  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0768699645996094  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.078305244445801  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.159264087677002  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.266080379486084  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.32004261016846  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.117748737335205  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0861330032348633  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.087655544281006  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1600337028503418  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.07546901702881  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.16141414642334  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1480979919433594  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1153602600097656  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1163597106933594  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1908531188964844  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.19685935974121  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.28280448913574  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1784687042236328  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1475014686584473  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.148611068725586  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2246894836425781  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.07990884780884  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.16585397720337  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2125229835510254  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1758508682250977  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1768503189086914  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.251089096069336  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.1341118812561  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.220057010650635  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.238318920135498  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.205625534057617  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.206735134124756  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2867670059204102  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.17452335357666  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.26046848297119  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2743525505065918  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2371230125427246  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2381224632263184  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3140873908996582  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.17846059799194  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.264405727386475  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3021187782287598  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.271392345428467  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2725019454956055  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3534512519836426  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.23394966125488  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.319894790649414  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.340665340423584  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.3106560707092285  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.3116555213928223  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3856406211853027  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.322937965393066  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.4088830947876  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

number of input  18261792
----------------------------------------after optimizer
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.4440650939941406  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.475881814956665
pure train time :  8.012880802154541
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.018134117126464844
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03417015075683594
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.018176555633544922
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1137542724609375  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0791573524475098  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0802669525146484  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1542677879333496  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.212082862854004  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.26615333557129  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1126041412353516  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0837926864624023  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.085315227508545  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1631722450256348  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.10680294036865  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.192748069763184  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.150820255279541  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1196227073669434  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.120622158050537  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1922731399536133  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.05000925064087  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.1359543800354  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.179335117340088  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.147756576538086  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1492791175842285  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2238926887512207  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.284321308135986  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.37026643753052  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2118139266967773  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.178454875946045  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1802115440368652  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.254676342010498  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.296133041381836  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.38207817077637  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2422599792480469  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2082653045654297  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2097878456115723  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2857427597045898  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.0914945602417  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.17743968963623  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2751340866088867  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2430381774902344  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2447948455810547  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3216471672058105  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.300825119018555  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.386770248413086  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3094286918640137  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.275550365447998  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2770729064941406  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3517675399780273  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.108394622802734  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.194339752197266  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3391599655151367  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.306142807006836  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.3074417114257812  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.384141445159912  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.21731615066528  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.303261280059814  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

number of input  18260889
----------------------------------------after optimizer
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.44183349609375  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.429265260696411
pure train time :  8.009899377822876
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.016449928283691406
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029201984405517578
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01648879051208496
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1106176376342773  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0790624618530273  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0800647735595703  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.156179428100586  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.13245487213135  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.1869535446167  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1149659156799316  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.080124855041504  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0816473960876465  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1565518379211426  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 54.9971399307251  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.08308506011963  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1438331604003906  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.114044666290283  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.115945816040039  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1936216354370117  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.081143379211426  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.16708850860596  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1808185577392578  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.149528980255127  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1510515213012695  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.22332763671875  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.20199775695801  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.28794288635254  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.210984706878662  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.17800235748291  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.179903507232666  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2539896965026855  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 54.9256010055542  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.01154613494873  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2414288520812988  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.205533981323242  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2070565223693848  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2825226783752441  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.21940088272095  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.30534601211548  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2704639434814453  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.239030361175537  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.240931510925293  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3197088241577148  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.386849880218506  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.47279500961304  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3081045150756836  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2748422622680664  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.276364803314209  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.350292682647705  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.38569402694702  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.47163915634155  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3377723693847656  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.303964138031006  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.3056955337524414  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3818120956420898  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.28130388259888  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.36724901199341  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

number of input  18256011
----------------------------------------after optimizer
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.4404501914978027  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3739094734191895
pure train time :  7.798853874206543
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
random partition time  0.01510167121887207
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02998638153076172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015140295028686523
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1105632781982422  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.078780174255371  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.0803027153015137  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1567139625549316  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 54.985676765441895  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.03987121582031  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1166305541992188  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.084620952606201  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.085620403289795  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.160247802734375  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 54.9906702041626  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.07661533355713  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1475224494934082  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1118969917297363  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.113412857055664  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.1888298988342285  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.1650013923645  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.25094652175903  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.176088809967041  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.141378402709961  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1423778533935547  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2208352088928223  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.02049970626831  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.10644483566284  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2083287239074707  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.174287796020508  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.1758036613464355  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2539253234863281  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.291409492492676  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.37735462188721  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.241929054260254  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.208451747894287  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.209451198577881  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.286369800567627  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.249417304992676  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.33536243438721  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.2737321853637695  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2408838272094727  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2423996925354004  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3192291259765625  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.195069313049316  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.28101444244385  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.306365966796875  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2751903533935547  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.2761898040771484  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3519206047058105  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.43710899353027  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.523054122924805  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3398466110229492  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.310370922088623  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 2.311886787414551  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.3867058753967285  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.38615417480469  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 55.47209930419922  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

number of input  18255401
----------------------------------------after optimizer
 Nvidia-smi: 63.52777099609375 GB
    Memory Allocated: 1.4458208084106445  GigaBytes
Max Memory Allocated: 57.26145553588867  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.335160732269287
pure train time :  8.058858156204224
epoch_time_list  [46.38187551498413, 43.564738035202026, 42.98474073410034, 44.04643249511719, 44.65803289413452, 43.20198464393616, 44.23301434516907, 47.31158781051636, 43.27122211456299, 43.84468078613281, 43.47441005706787, 43.70285367965698, 42.59293818473816, 42.921961069107056, 42.70896506309509, 43.46478986740112, 43.22445464134216, 43.72048807144165, 42.81311511993408, 42.69407629966736]

loading_time list   [0.8689272403717041, 1.054823875427246, 0.8038241863250732, 0.8307192325592041, 1.1191158294677734, 0.8135218620300293, 1.0265262126922607, 0.9897124767303467, 0.8227970600128174, 1.0522022247314453, 1.0144505500793457, 0.8477475643157959, 0.8545904159545898, 0.8262538909912109, 1.044626235961914, 0.850045919418335, 0.9011111259460449, 1.0095317363739014, 1.0349762439727783, 0.7717170715332031]

 data loader gen time  30.63796830177307
	---backpack schedule time  [0.1877446174621582, 0.17913436889648438, 0.17487144470214844, 0.18436217308044434, 0.1835041046142578, 0.17959833145141602, 0.18393516540527344, 0.1951897144317627, 0.18422794342041016, 0.17536306381225586, 0.18137764930725098, 0.21109414100646973, 0.18817639350891113, 0.17824053764343262, 0.17584729194641113, 0.17745637893676758, 0.19890522956848145, 0.18027853965759277, 0.17123699188232422, 0.17246651649475098]
	---connection_check_time_list  [5.866586208343506, 6.044400215148926, 5.746216535568237, 6.770040035247803, 7.160555601119995, 5.8458263874053955, 6.144809007644653, 9.988605737686157, 5.497456789016724, 5.603151559829712, 6.2972893714904785, 6.554325580596924, 5.402881383895874, 5.353854656219482, 5.673479795455933, 6.661590099334717, 5.634242057800293, 5.612130165100098, 5.5497589111328125, 5.245104074478149]
	---block_gen_time_list  [2.7687840461730957, 2.7401232719421387, 2.624203681945801, 2.6339199542999268, 2.9069037437438965, 2.627375841140747, 2.6638572216033936, 2.621506690979004, 2.626206636428833, 2.7303571701049805, 2.5862514972686768, 2.607536792755127, 2.5604918003082275, 2.607297897338867, 2.5065269470214844, 2.5356152057647705, 2.580353260040283, 2.840672016143799, 2.573843002319336, 2.490265369415283]
training time  [13.946578741073608, 10.730972051620483, 10.824047327041626, 10.690344095230103, 10.420597314834595, 10.870184183120728, 11.248400449752808, 10.550889492034912, 11.30228590965271, 11.407938241958618, 10.584685802459717, 10.532414197921753, 10.789715766906738, 11.182757139205933, 10.541183233261108, 10.482122898101807, 11.097775936126709, 11.245980501174927, 10.74786114692688, 11.266212701797485]
---feature block loading time  [2.7907841205596924, 3.248819589614868, 3.343083381652832, 3.0588977336883545, 2.8843839168548584, 3.278691530227661, 3.2357027530670166, 2.7775371074676514, 3.1903574466705322, 3.345860481262207, 2.783416509628296, 2.745136260986328, 2.954336404800415, 3.1650476455688477, 2.783599615097046, 2.6771786212921143, 3.0684890747070312, 3.2189247608184814, 2.93630313873291, 3.1909098625183105]


epoch_time avg   43.614910915493965
loading_time avg   0.936182901263237
 data loader gen time avg 31.76908926665783
	---backpack schedule time avg 0.18355612456798553
	---connection_check_time avg  6.139066323637962
	---block_gen_time avg  2.6290663182735443
training time  10.89193780720234
---feature block loading time  3.0147421956062317
pure train time per /epoch  [11.144917249679565, 7.4674224853515625, 7.467199802398682, 7.617376089096069, 7.522387742996216, 7.57744026184082, 7.99372673034668, 7.760071277618408, 8.096455335617065, 8.045766353607178, 7.786509990692139, 7.771519899368286, 7.820732831954956, 8.00193476676941, 7.742923259735107, 7.788291931152344, 8.012880802154541, 8.009899377822876, 7.798853874206543, 8.058858156204224]
pure train time average  7.847389922422521
num_input list  [18255255, 18262471, 18255288, 18252728, 18249245, 18261423, 18256081, 18261359, 18259573, 18253322, 18257823, 18253518, 18255044, 18258836, 18258833, 18258942, 18261792, 18260889, 18256011, 18255401]
num_input  average  18257191.7
