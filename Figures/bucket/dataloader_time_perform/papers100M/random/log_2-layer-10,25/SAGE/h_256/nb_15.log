main start at this time 1714082651.6819782
-----------------------------------------before load data 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
# Nodes: 111059956
# Edges: 1615685872
# Train: 1207179
# Val: 125265
# Test: 109727512
# Classes: 172

----------------------------------------start of run function 
 Nvidia-smi: 0.80816650390625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.014501333236694336
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03665804862976074
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014559745788574219
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 1.22113037109375 GB
    Memory Allocated: 0.003025054931640625  GigaBytes
Max Memory Allocated: 0.003025054931640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.95550537109375 GB
    Memory Allocated: 0.7374000549316406  GigaBytes
Max Memory Allocated: 0.7374000549316406  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.95550537109375 GB
    Memory Allocated: 0.7379999160766602  GigaBytes
Max Memory Allocated: 0.7379999160766602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.00238037109375 GB
    Memory Allocated: 0.7673454284667969  GigaBytes
Max Memory Allocated: 0.7673454284667969  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 39.32659912109375 GB
    Memory Allocated: 36.854397773742676  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 39.32659912109375 GB
    Memory Allocated: 36.90596580505371  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 40.04339599609375 GB
    Memory Allocated: 0.8285946846008301  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 40.04339599609375 GB
    Memory Allocated: 1.559156894683838  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 40.04339599609375 GB
    Memory Allocated: 1.5597567558288574  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 40.04339599609375 GB
    Memory Allocated: 0.8539977073669434  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 41.08636474609375 GB
    Memory Allocated: 36.61919403076172  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 41.08636474609375 GB
    Memory Allocated: 36.670761585235596  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 41.08636474609375 GB
    Memory Allocated: 0.8462095260620117  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 41.08636474609375 GB
    Memory Allocated: 1.5770196914672852  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 41.08636474609375 GB
    Memory Allocated: 1.5776195526123047  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 41.08636474609375 GB
    Memory Allocated: 0.8765521049499512  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 41.08636474609375 GB
    Memory Allocated: 36.76439905166626  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 41.08636474609375 GB
    Memory Allocated: 36.81596660614014  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 41.08636474609375 GB
    Memory Allocated: 0.8671936988830566  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 41.08636474609375 GB
    Memory Allocated: 1.5974493026733398  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 41.08636474609375 GB
    Memory Allocated: 1.5980491638183594  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 41.08636474609375 GB
    Memory Allocated: 0.8966875076293945  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.60784912109375 GB
    Memory Allocated: 36.60197830200195  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 42.60784912109375 GB
    Memory Allocated: 36.65354585647583  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 42.60784912109375 GB
    Memory Allocated: 0.8869228363037109  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 42.60784912109375 GB
    Memory Allocated: 1.6198763847351074  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 42.60784912109375 GB
    Memory Allocated: 1.620476245880127  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 42.60784912109375 GB
    Memory Allocated: 0.919316291809082  GigaBytes
Max Memory Allocated: 37.84433603286743  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 36.898356437683105  GigaBytes
Max Memory Allocated: 37.93798208236694  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 36.94992399215698  GigaBytes
Max Memory Allocated: 37.93798208236694  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 0.9100770950317383  GigaBytes
Max Memory Allocated: 37.93798208236694  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 1.6426596641540527  GigaBytes
Max Memory Allocated: 37.93798208236694  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 1.6432595252990723  GigaBytes
Max Memory Allocated: 37.93798208236694  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 0.9390544891357422  GigaBytes
Max Memory Allocated: 37.93798208236694  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 36.929443359375  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 36.98111295700073  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 0.929354190826416  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 1.6562905311584473  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 1.6568903923034668  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 0.952850341796875  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 36.738962173461914  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 36.79052972793579  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 0.9460663795471191  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 1.678786277770996  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 1.6793861389160156  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 44.14300537109375 GB
    Memory Allocated: 0.9810657501220703  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 45.18988037109375 GB
    Memory Allocated: 36.796101093292236  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 45.18988037109375 GB
    Memory Allocated: 36.84766864776611  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 45.19183349609375 GB
    Memory Allocated: 0.9714908599853516  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 45.19183349609375 GB
    Memory Allocated: 1.7081384658813477  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 45.19183349609375 GB
    Memory Allocated: 1.7087383270263672  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 45.19183349609375 GB
    Memory Allocated: 1.0054821968078613  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.41448974609375 GB
    Memory Allocated: 36.92831373214722  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 53.41448974609375 GB
    Memory Allocated: 36.979881286621094  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 53.41448974609375 GB
    Memory Allocated: 0.9951772689819336  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 53.41448974609375 GB
    Memory Allocated: 1.7327642440795898  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 53.41448974609375 GB
    Memory Allocated: 1.7333641052246094  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 53.41448974609375 GB
    Memory Allocated: 1.0269956588745117  GigaBytes
Max Memory Allocated: 37.97385835647583  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 37.09700059890747  GigaBytes
Max Memory Allocated: 38.138797760009766  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 37.14856815338135  GigaBytes
Max Memory Allocated: 38.138797760009766  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.015571117401123  GigaBytes
Max Memory Allocated: 38.138797760009766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.7446651458740234  GigaBytes
Max Memory Allocated: 38.138797760009766  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.745265007019043  GigaBytes
Max Memory Allocated: 38.138797760009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.0379257202148438  GigaBytes
Max Memory Allocated: 38.138797760009766  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 36.846181869506836  GigaBytes
Max Memory Allocated: 38.138797760009766  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 36.89774942398071  GigaBytes
Max Memory Allocated: 38.138797760009766  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.0262317657470703  GigaBytes
Max Memory Allocated: 38.138797760009766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.7653083801269531  GigaBytes
Max Memory Allocated: 38.138797760009766  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.7659082412719727  GigaBytes
Max Memory Allocated: 38.138797760009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.0670990943908691  GigaBytes
Max Memory Allocated: 38.138797760009766  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 37.195576190948486  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 37.24714374542236  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.0577311515808105  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.7902121543884277  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.7908120155334473  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.081998348236084  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 37.07206344604492  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 37.1236310005188  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.072352409362793  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.806471824645996  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.8070716857910156  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.1048402786254883  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 37.01292276382446  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 37.06449031829834  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.0934548377990723  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.8261680603027344  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.826767921447754  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.1228885650634766  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 36.973387241363525  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 37.0249547958374  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

number of input  23052596
----------------------------------------after optimizer
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.1676850318908691  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.175308704376221
pure train time :  11.007606506347656
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.016787290573120117
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03283333778381348
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016832828521728516
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 0.8305220603942871  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.5633931159973145  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.563992977142334  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 0.8606338500976562  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 36.71192169189453  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 36.743048667907715  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 0.8346781730651855  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.5651593208312988  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.5657591819763184  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 0.8615927696228027  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 36.73304748535156  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 36.78461503982544  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 0.8521723747253418  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.5898346900939941  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 1.5904345512390137  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 54.94378662109375 GB
    Memory Allocated: 0.888847827911377  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 36.96762800216675  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 37.019195556640625  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 0.8799943923950195  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 1.610884666442871  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 1.6114845275878906  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 0.9031453132629395  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 36.69338274002075  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 36.74495029449463  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 0.8961939811706543  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 1.6280517578125  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 1.6286516189575195  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 0.9272136688232422  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 36.68812322616577  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 36.73969078063965  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 0.9170780181884766  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 1.650247573852539  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 1.6508474349975586  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 0.947939395904541  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 36.78515291213989  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 36.83672046661377  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 0.9380998611450195  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 1.671849250793457  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 1.6724491119384766  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 0.9680900573730469  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 37.00524950027466  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 37.056817054748535  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 0.9613790512084961  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 1.6924810409545898  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 1.6930809020996094  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 0.9879570007324219  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 36.75574541091919  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 36.807312965393066  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 0.9798846244812012  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 1.7107748985290527  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 1.7113747596740723  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47503662109375 GB
    Memory Allocated: 1.0087885856628418  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47894287109375 GB
    Memory Allocated: 36.65037250518799  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 56.47894287109375 GB
    Memory Allocated: 36.701940059661865  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 56.47894287109375 GB
    Memory Allocated: 0.9996023178100586  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 56.47894287109375 GB
    Memory Allocated: 1.7328786849975586  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 56.47894287109375 GB
    Memory Allocated: 1.7334785461425781  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47894287109375 GB
    Memory Allocated: 1.0313053131103516  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47894287109375 GB
    Memory Allocated: 36.91240072250366  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 56.47894287109375 GB
    Memory Allocated: 36.96431541442871  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 56.47894287109375 GB
    Memory Allocated: 1.0238423347473145  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 56.47894287109375 GB
    Memory Allocated: 1.7620344161987305  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 56.47894287109375 GB
    Memory Allocated: 1.76263427734375  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 56.47894287109375 GB
    Memory Allocated: 1.0581932067871094  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 57.53167724609375 GB
    Memory Allocated: 37.093262672424316  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 57.53167724609375 GB
    Memory Allocated: 37.14483022689819  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 57.53167724609375 GB
    Memory Allocated: 1.0492510795593262  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 57.53167724609375 GB
    Memory Allocated: 1.7822003364562988  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 57.53167724609375 GB
    Memory Allocated: 1.7828001976013184  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 57.53167724609375 GB
    Memory Allocated: 1.0733146667480469  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 57.53167724609375 GB
    Memory Allocated: 37.00791358947754  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 57.53167724609375 GB
    Memory Allocated: 37.059481143951416  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 57.53167724609375 GB
    Memory Allocated: 1.0650877952575684  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 57.53167724609375 GB
    Memory Allocated: 1.8013429641723633  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 57.53167724609375 GB
    Memory Allocated: 1.8019428253173828  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 57.53167724609375 GB
    Memory Allocated: 1.0978460311889648  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.157965660095215  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.20953321456909  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0911550521850586  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.8189821243286133  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.8195819854736328  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1120977401733398  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.74077129364014  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.792338848114014  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1056160926818848  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.8391461372375488  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.8397459983825684  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1407618522644043  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.152464389801025  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.20402812957764  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

number of input  23057359
----------------------------------------after optimizer
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1796441078186035  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.742184638977051
pure train time :  9.048245906829834
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.015400886535644531
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03194880485534668
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015454769134521484
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.831815242767334  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.566938877105713  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.5675387382507324  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8641300201416016  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.61353015899658  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.64418077468872  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8371748924255371  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.5632457733154297  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.5638456344604492  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8581967353820801  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.60264444351196  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.65421199798584  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8479743003845215  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.5842785835266113  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.5848784446716309  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8884425163269043  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.944252490997314  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.99582004547119  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8802332878112793  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6135454177856445  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.614145278930664  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9073910713195801  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.80454778671265  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.85611534118652  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8966050148010254  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6294174194335938  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6300172805786133  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9264826774597168  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.965442180633545  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.01700973510742  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9156532287597656  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6462125778198242  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6468124389648438  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9435305595397949  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.81241035461426  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.863977909088135  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9328842163085938  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6669082641601562  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6675081253051758  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9665708541870117  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.01682376861572  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.0683913230896  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9559640884399414  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.691431999206543  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6920318603515625  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9876570701599121  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.100539684295654  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.15210723876953  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9768314361572266  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7057032585144043  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7063031196594238  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0004878044128418  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.88400650024414  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.93557405471802  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9903097152709961  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7215042114257812  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7221040725708008  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0227084159851074  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.760045528411865  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.81161308288574  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0154438018798828  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7471976280212402  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7477974891662598  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0461130142211914  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.83502435684204  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.88659191131592  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.036489486694336  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7728548049926758  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7734546661376953  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.071253776550293  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.96878528594971  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.020352840423584  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0620551109313965  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.794281005859375  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7948808670043945  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0880126953125  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.89075326919556  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.942320823669434  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.077277660369873  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.8115406036376953  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.8121404647827148  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1093878746032715  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.84176969528198  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.89333724975586  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1005468368530273  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.8331003189086914  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.833700180053711  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1289935111999512  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.02784442901611  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.079408168792725  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

number of input  23049593
----------------------------------------after optimizer
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1667404174804688  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.530107498168945
pure train time :  9.746315240859985
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.013966798782348633
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.054572105407714844
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01405787467956543
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8301525115966797  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.5593171119689941  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.5599169731140137  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8569955825805664  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.88153266906738  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.912869453430176  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8307628631591797  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.5678377151489258  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.5684375762939453  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8687500953674316  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.78960657119751  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.84117412567139  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8581399917602539  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.5965938568115234  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.597193717956543  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8902688026428223  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.93315124511719  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.984718799591064  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8822574615478516  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6113200187683105  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.61191987991333  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9028058052062988  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.57750129699707  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.62906885147095  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.8957443237304688  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.624464511871338  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6250643730163574  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9255037307739258  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.94255447387695  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.99412202835083  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9151525497436523  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.648348331451416  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6489481925964355  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9501457214355469  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.91267442703247  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.96424198150635  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9394402503967285  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.673151969909668  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6737518310546875  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9702143669128418  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.94986915588379  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.001436710357666  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.960686206817627  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6912932395935059  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.6918931007385254  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9883942604064941  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.70878314971924  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.760350704193115  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9778289794921875  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7089285850524902  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7095284461975098  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0091562271118164  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.80856943130493  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.86013698577881  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 0.9976301193237305  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7346253395080566  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7352252006530762  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0343947410583496  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.097426414489746  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.14915990829468  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0254836082458496  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7562031745910645  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.756803035736084  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0500235557556152  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.77080726623535  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.82237482070923  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0384292602539062  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7725224494934082  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7731223106384277  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0726423263549805  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.94358730316162  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.9951548576355  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.063718318939209  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.796426773071289  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.7970266342163086  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0931806564331055  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 36.95612621307373  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 37.00769376754761  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.0845065116882324  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.82081937789917  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.8214192390441895  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 59.00628662109375 GB
    Memory Allocated: 1.1189751625061035  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 37.18372631072998  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 37.23529386520386  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.107649326324463  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.8370418548583984  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.837641716003418  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.1315617561340332  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.91229724884033  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.96386098861694  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

number of input  23050452
----------------------------------------after optimizer
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.1696491241455078  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.298779487609863
pure train time :  9.255988359451294
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.014386177062988281
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04244852066040039
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014456033706665039
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.8274450302124023  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.556474208831787  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.5570740699768066  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.8563327789306641  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.69188213348389  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.72276544570923  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.830014705657959  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.5598363876342773  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.5604362487792969  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.8600010871887207  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.58480739593506  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.636374950408936  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.8523197174072266  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.5869150161743164  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.587514877319336  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.8864846229553223  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.87809610366821  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.92966365814209  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.8768415451049805  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.6122841835021973  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.6128840446472168  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.9079256057739258  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.8808798789978  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.93244743347168  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.8976383209228516  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.6319165229797363  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.6325163841247559  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.9273204803466797  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.91879177093506  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.970359325408936  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.9167213439941406  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.6529450416564941  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.6535449028015137  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.9496736526489258  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 37.06558704376221  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 37.117154598236084  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.9391579627990723  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.6668238639831543  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.6674237251281738  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.961578369140625  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.83100175857544  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 36.882569313049316  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.949763298034668  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.6871914863586426  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 1.687791347503662  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 60.48284912109375 GB
    Memory Allocated: 0.9905352592468262  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 37.095295429229736  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 37.14686298370361  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9823446273803711  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7129240036010742  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7135238647460938  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0064263343811035  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.67674112319946  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.72830867767334  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9981255531311035  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7304878234863281  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7310876846313477  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0317144393920898  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.81249141693115  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.86405897140503  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0206727981567383  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.754420280456543  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7550201416015625  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0530438423156738  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.93940544128418  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.99097299575806  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.045076847076416  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7789521217346191  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7795519828796387  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0761590003967285  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.942155838012695  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.99372339248657  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0658583641052246  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7961230278015137  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7967228889465332  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0932278633117676  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.96886491775513  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 37.020432472229004  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0840296745300293  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.817582607269287  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.8181824684143066  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.1182780265808105  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.92846870422363  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.98003625869751  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.1064338684082031  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.8388161659240723  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.8394160270690918  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.136237621307373  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 37.02317762374878  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 37.07474136352539  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

number of input  23050320
----------------------------------------after optimizer
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.1743721961975098  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.9997453689575195
pure train time :  9.54361343383789
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.014464139938354492
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03014826774597168
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014515161514282227
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8295760154724121  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.5663228034973145  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.566922664642334  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8636741638183594  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.92941904067993  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.9611611366272  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8384561538696289  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.5699381828308105  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.57053804397583  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.863215446472168  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.84471035003662  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.8962779045105  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8529114723205566  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.5837211608886719  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.5843210220336914  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8829789161682129  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.7263069152832  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.77787446975708  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8733248710632324  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6077609062194824  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.608360767364502  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9076719284057617  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.73126840591431  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.782835960388184  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8970346450805664  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6282386779785156  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6288385391235352  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9245386123657227  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.782212257385254  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.83377981185913  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.913877010345459  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6430244445800781  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6436243057250977  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.942540168762207  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.70579433441162  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.7573618888855  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9317526817321777  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.666841983795166  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6674418449401855  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9684572219848633  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.9936089515686  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 37.04517650604248  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9570069313049316  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6917738914489746  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6923737525939941  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9875855445861816  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.97019863128662  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 37.0217661857605  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9767727851867676  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7087922096252441  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7093920707702637  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0047307014465332  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.73002767562866  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.78159523010254  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9960732460021973  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7271289825439453  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7277288436889648  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0258750915527344  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 37.07312488555908  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 37.12469244003296  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0147757530212402  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7521405220031738  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7527403831481934  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0517797470092773  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.78314781188965  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.834715366363525  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0403494834899902  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.772425651550293  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7730255126953125  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0657892227172852  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 37.02089071273804  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 37.072458267211914  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0557126998901367  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7879142761230469  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7885141372680664  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.086555004119873  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 37.08892250061035  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 37.14049005508423  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0764083862304688  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.8081302642822266  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.808730125427246  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.1066217422485352  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.94081354141235  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.99238109588623  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0953006744384766  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.8269624710083008  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.8275623321533203  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.1260948181152344  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.91206693649292  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.9636344909668  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

number of input  23051441
----------------------------------------after optimizer
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.1641387939453125  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.734424591064453
pure train time :  9.518433332443237
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.014130115509033203
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.032779693603515625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014190435409545898
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8289957046508789  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.5678610801696777  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.5684609413146973  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8665685653686523  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.891972064971924  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.92357397079468  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8395290374755859  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.5741982460021973  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.5747981071472168  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8655266761779785  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.86077070236206  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.91233825683594  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8563947677612305  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.5932064056396484  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.593806266784668  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8890957832336426  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.84201908111572  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.8935866355896  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.8813061714172363  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6162500381469727  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6168498992919922  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9104962348937988  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.9403510093689  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.99191856384277  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9003539085388184  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6328949928283691  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6334948539733887  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.928929328918457  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.71078014373779  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.76234769821167  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9181065559387207  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.648972511291504  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6495723724365234  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9474306106567383  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.8262038230896  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.87784957885742  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9355349540710449  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.664811611175537  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6654114723205566  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.965184211730957  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.80389451980591  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.855462074279785  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.954188346862793  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.6884469985961914  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.689046859741211  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9901618957519531  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.88108158111572  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.9326491355896  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9786362648010254  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7106904983520508  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7112903594970703  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0076427459716797  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.87166690826416  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 36.92323446273804  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 0.9961514472961426  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.729257583618164  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.7298574447631836  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01605224609375 GB
    Memory Allocated: 1.0287675857543945  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.77606153488159  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.82762908935547  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0183219909667969  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7503762245178223  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7509760856628418  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0477666854858398  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.835378646850586  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.88694620132446  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0373706817626953  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7673044204711914  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.767904281616211  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0657382011413574  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.83236885070801  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.883936405181885  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0547542572021484  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7901382446289062  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7907381057739258  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0906982421875  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.98890972137451  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.04047727584839  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0797114372253418  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.8124909400939941  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.8130908012390137  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.107595443725586  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.089030742645264  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.14059829711914  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0984201431274414  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.8252129554748535  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.825812816619873  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.122903823852539  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.98962116241455  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.04118871688843  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

number of input  23054832
----------------------------------------after optimizer
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.1629877090454102  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.5112693309783936
pure train time :  9.590937376022339
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.013617515563964844
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03269767761230469
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.013682365417480469
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8242130279541016  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5560088157653809  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5566086769104004  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8585176467895508  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.72847127914429  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.759986877441406  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8330011367797852  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5653386116027832  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5659384727478027  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8629627227783203  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.94558095932007  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.997148513793945  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8531737327575684  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5837345123291016  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.584334373474121  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8815116882324219  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.70698118209839  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.758548736572266  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.87152099609375  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.60479736328125  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6053972244262695  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9043779373168945  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.76948642730713  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.821053981781006  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8935790061950684  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6276741027832031  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6282739639282227  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9247241020202637  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.89943027496338  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.950997829437256  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9176383018493652  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6508874893188477  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6514873504638672  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9469523429870605  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.91783857345581  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.96940612792969  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.936589241027832  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6695899963378906  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6701898574829102  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9665141105651855  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.91808748245239  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.96965503692627  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9558382034301758  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6924529075622559  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6930527687072754  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9897499084472656  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.95047378540039  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.00204133987427  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9792141914367676  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7135891914367676  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.714189052581787  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0078864097595215  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.857840061187744  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.90940761566162  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9975261688232422  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.728217601776123  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7288174629211426  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0247626304626465  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.82289457321167  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.87446212768555  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0142860412597656  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.743173599243164  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7437734603881836  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.043715476989746  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.75231122970581  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.80387878417969  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0334925651550293  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7689146995544434  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.769514560699463  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.070197582244873  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.99187707901001  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.04344463348389  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0599627494812012  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7923216819763184  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.792921543121338  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0870380401611328  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.0204062461853  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.07197380065918  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0786304473876953  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.816967487335205  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.8175673484802246  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.1147832870483398  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.0945405960083  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.14610815048218  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.1041016578674316  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.8353185653686523  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.8359184265136719  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.1272754669189453  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.00561857223511  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.057186126708984  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

number of input  23060614
----------------------------------------after optimizer
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.1660079956054688  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.372389078140259
pure train time :  9.550934076309204
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.015046834945678711
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03998517990112305
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015094757080078125
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8299942016601562  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5598678588867188  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5604677200317383  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8590564727783203  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.63650465011597  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.66666316986084  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8305559158325195  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5611138343811035  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.561713695526123  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.861732006072998  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.8160343170166  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.86760187149048  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8518843650817871  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5875892639160156  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5881891250610352  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8872194290161133  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.860971450805664  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.91253900527954  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8787803649902344  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6121530532836914  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.612752914428711  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9065971374511719  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.92189073562622  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.9734582901001  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8957948684692383  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6292333602905273  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6298332214355469  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9260993003845215  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.84445858001709  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.89602613449097  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9165229797363281  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.646019458770752  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6466193199157715  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9426131248474121  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.62354278564453  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.67511034011841  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9329061508178711  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6713428497314453  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6719427108764648  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9720196723937988  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.02905559539795  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.080623149871826  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9627161026000977  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6892213821411133  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6898212432861328  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9808263778686523  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.685314655303955  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.73688220977783  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9725499153137207  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7098121643066406  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7104120254516602  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.01350736618042  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.07205390930176  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.123621463775635  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0032753944396973  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7395439147949219  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7401437759399414  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0324792861938477  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.06457185745239  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.11613941192627  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.022496223449707  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7556109428405762  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7562108039855957  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0494341850280762  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.869505405426025  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.9210729598999  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0384550094604492  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7731456756591797  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7737455368041992  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.070164680480957  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.94652986526489  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.99809741973877  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0620546340942383  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7894868850708008  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.7900867462158203  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.0855302810668945  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.858837604522705  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.91040515899658  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.075343132019043  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.8065094947814941  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.8071093559265137  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.109175205230713  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.91493034362793  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.96649789810181  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.1018476486206055  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.8373231887817383  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.8379230499267578  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.1362876892089844  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.00955677032471  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.06112051010132  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

number of input  23053565
----------------------------------------after optimizer
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.1759400367736816  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.285050630569458
pure train time :  9.586116552352905
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.012960433959960938
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03084874153137207
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.013006925582885742
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8345990180969238  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5694446563720703  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5700445175170898  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8633050918579102  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.7561469078064  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.785959243774414  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8350300788879395  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5697941780090332  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5703940391540527  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8651385307312012  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.76227331161499  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.81384086608887  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8551187515258789  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5877408981323242  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.5883407592773438  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8831725120544434  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.80371809005737  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.85528564453125  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8734269142150879  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.605309009552002  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6059088706970215  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9028663635253906  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.74894618988037  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 36.80051374435425  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.8939700126647949  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6298012733459473  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6304011344909668  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9282264709472656  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.04838705062866  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 37.09995460510254  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9182543754577637  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.6538376808166504  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 1.65443754196167  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 62.01800537109375 GB
    Memory Allocated: 0.9483251571655273  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.060587882995605  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.11215543746948  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9379429817199707  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6664953231811523  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6670951843261719  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9609770774841309  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.59334850311279  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.64491605758667  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.950009822845459  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6851558685302734  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.685755729675293  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9871306419372559  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.932859897613525  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.9844274520874  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9771437644958496  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7101497650146484  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.710749626159668  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0052528381347656  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.041754722595215  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.09332227706909  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9947271347045898  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7286486625671387  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7292485237121582  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0262064933776855  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.879491329193115  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.93105888366699  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0155959129333496  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.744767665863037  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7453675270080566  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0409178733825684  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.67958164215088  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.731149196624756  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0327324867248535  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.762669563293457  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7632694244384766  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0637030601501465  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.0265417098999  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.07810926437378  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.054610252380371  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7851948738098145  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.785794734954834  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0853734016418457  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.78420162200928  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.835769176483154  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0755319595336914  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.806966781616211  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8075666427612305  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.106588363647461  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.0630841255188  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.114651679992676  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0983023643493652  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8337574005126953  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8343572616577148  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.1331496238708496  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.95539474487305  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.006962299346924  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

number of input  23053442
----------------------------------------after optimizer
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.170701026916504  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0900325775146484
pure train time :  9.574435710906982
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.01468348503112793
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029651403427124023
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014729738235473633
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8330879211425781  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.5692448616027832  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.5698447227478027  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8636736869812012  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.9557523727417  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.98705530166626  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8367629051208496  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.5667877197265625  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.567387580871582  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8608417510986328  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.56725072860718  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.618818283081055  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8509364128112793  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.581695556640625  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.5822954177856445  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8816423416137695  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.67210245132446  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.72367000579834  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8720459938049316  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6052179336547852  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6058177947998047  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9045019149780273  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.913978576660156  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.96554613113403  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8939146995544434  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6289024353027344  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.629502296447754  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9258246421813965  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.899322509765625  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.9508900642395  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9149565696716309  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6491446495056152  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6497445106506348  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9447040557861328  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.94270420074463  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.994271755218506  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9348592758178711  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6691350936889648  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6697349548339844  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9650120735168457  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.947813510894775  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.99938106536865  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9544582366943359  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6845436096191406  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6851434707641602  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9809207916259766  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.81417465209961  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.865742206573486  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9702706336975098  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7017779350280762  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7023777961730957  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0019454956054688  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.92912769317627  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.98069524765015  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9914164543151855  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7266902923583984  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.727290153503418  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0252165794372559  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.940858364105225  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.9924259185791  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0177369117736816  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7509312629699707  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7515311241149902  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0456151962280273  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.807011127471924  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.8585786819458  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.034975528717041  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.767843246459961  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7684431076049805  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0651464462280273  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.8032660484314  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.85483360290527  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.054738998413086  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7894096374511719  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7900094985961914  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0869011878967285  GigaBytes
Max Memory Allocated: 38.24010896682739  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.2001690864563  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.251736640930176  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0786004066467285  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8087544441223145  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.809354305267334  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.1040749549865723  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.987502098083496  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.03906965255737  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.09511137008667  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8275794982910156  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8281793594360352  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.127418041229248  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.94839572906494  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.99995946884155  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

number of input  23055640
----------------------------------------after optimizer
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.1657633781433105  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.96053409576416
pure train time :  9.612712383270264
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.014431953430175781
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030382871627807617
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014579534530639648
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8307466506958008  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.565969467163086  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.5665693283081055  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8628659248352051  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.80315589904785  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.833813190460205  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8362293243408203  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.5747690200805664  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.575368881225586  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8699336051940918  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.045252323150635  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.09681987762451  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8615059852600098  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.5986151695251465  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.599215030670166  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8903884887695312  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.80705976486206  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.85862731933594  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8794984817504883  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6115198135375977  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6121196746826172  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9050612449645996  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.77595233917236  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.82751989364624  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8947296142578125  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6271710395812988  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6277709007263184  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9263887405395508  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.90944957733154  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.96101713180542  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9156665802001953  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6500415802001953  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6506414413452148  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9468502998352051  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.76663160324097  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.818199157714844  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9375901222229004  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6731328964233398  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6737327575683594  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9691143035888672  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.981441497802734  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.03300905227661  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9587063789367676  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.693763256072998  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6943631172180176  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9884915351867676  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.87968969345093  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.931257247924805  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9783048629760742  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7058258056640625  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.706425666809082  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9999351501464844  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.67705154418945  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.72861909866333  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9916162490844727  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7251148223876953  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7257146835327148  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0278925895690918  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.00079107284546  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.052358627319336  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0173096656799316  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7502975463867188  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7508974075317383  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0474801063537598  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.042768478393555  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.09433603286743  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0374641418457031  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7673377990722656  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7679376602172852  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0639386177062988  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.8629207611084  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.914488315582275  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0559630393981934  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7836456298828125  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.784245491027832  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.083414077758789  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.87536811828613  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.92693567276001  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0741229057312012  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8054289817810059  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8060288429260254  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.107388973236084  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.886412143707275  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.93797969818115  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0971498489379883  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8250045776367188  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8256044387817383  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.1232876777648926  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.7919716835022  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.843539237976074  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

number of input  23049557
----------------------------------------after optimizer
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.1616482734680176  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.862992525100708
pure train time :  9.583921194076538
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.01427459716796875
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03723597526550293
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01434183120727539
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8257389068603516  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.557023048400879  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.5576229095458984  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8588628768920898  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.742823123931885  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.77387475967407  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8335175514221191  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.5669493675231934  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.567549228668213  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8649392127990723  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.69630432128906  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.74787187576294  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8563232421875  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.5903639793395996  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.5909638404846191  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8862385749816895  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.76633071899414  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.81794309616089  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8762021064758301  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6087470054626465  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.609346866607666  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9041271209716797  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.88269329071045  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.934260845184326  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8941383361816406  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6318855285644531  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6324853897094727  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9295320510864258  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.90658521652222  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.958152770996094  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9219441413879395  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6598920822143555  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.660491943359375  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9515342712402344  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.965599060058594  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.01716661453247  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9421772956848145  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.67225980758667  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6728596687316895  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9642000198364258  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.697826862335205  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.74939441680908  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9547734260559082  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.6834940910339355  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.684093952178955  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9835720062255859  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.8651647567749  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.91673231124878  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9737405776977539  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7012372016906738  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7018370628356934  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0017752647399902  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.84034776687622  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.8919153213501  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.9933242797851562  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.722381591796875  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7229814529418945  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.024085521697998  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.773964405059814  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.82553195953369  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0146293640136719  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.752415657043457  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7530155181884766  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0541491508483887  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.1533784866333  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.20494604110718  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.045057773590088  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7820277214050293  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7826275825500488  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0735297203063965  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.92730236053467  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.978869915008545  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0638184547424316  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7965140342712402  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.7971138954162598  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0888047218322754  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.93269395828247  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.98426151275635  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.0804905891418457  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8089251518249512  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8095250129699707  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.1054797172546387  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 36.95450782775879  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.006075382232666  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.09556245803833  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8290901184082031  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.8296899795532227  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.1318721771240234  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.1842622756958  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 37.23582983016968  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

number of input  23051408
----------------------------------------after optimizer
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.170454978942871  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7510595321655273
pure train time :  9.543822526931763
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.01407623291015625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0313565731048584
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014120817184448242
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8310608863830566  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.5719537734985352  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 1.5725536346435547  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 63.07464599609375 GB
    Memory Allocated: 0.8690366744995117  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.06672477722168  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.098127365112305  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8417854309082031  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.571176528930664  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5717763900756836  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8604259490966797  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.6266450881958  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.67821264266968  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8500375747680664  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5813226699829102  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5819225311279297  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8821296691894531  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.795918464660645  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.84748601913452  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.874056339263916  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6048450469970703  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6054449081420898  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9037351608276367  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.79976177215576  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.85132932662964  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8949809074401855  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6302094459533691  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6308093070983887  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9296464920043945  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.93725252151489  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.98882007598877  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9213542938232422  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6556363105773926  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.656236171722412  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9506072998046875  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.90849828720093  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.960065841674805  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9406375885009766  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6727547645568848  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6733546257019043  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9699273109436035  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.895259857177734  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.94682741165161  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9583969116210938  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6896071434020996  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6902070045471191  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9886088371276855  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.858903884887695  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.91047143936157  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9788970947265625  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7085790634155273  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7091789245605469  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0082511901855469  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.68877983093262  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.740347385406494  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9973225593566895  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7321228981018066  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7327227592468262  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.033365249633789  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.96169424057007  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.013261795043945  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0220141410827637  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7548065185546875  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.755406379699707  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0516972541809082  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.896793365478516  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.94836091995239  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.04286527633667  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.77272367477417  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7733235359191895  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0698022842407227  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.63389253616333  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.68546009063721  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0584025382995605  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.79225492477417  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7928547859191895  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0933141708374023  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.967427253723145  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.01899480819702  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0818862915039062  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8133950233459473  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8139948844909668  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1104717254638672  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.09853935241699  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.15010690689087  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1008434295654297  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8355231285095215  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.836122989654541  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1349358558654785  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.10113763809204  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.15270137786865  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

number of input  23052670
----------------------------------------after optimizer
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1730375289916992  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6808183193206787
pure train time :  9.55463457107544
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.014066934585571289
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.031320810317993164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014109611511230469
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8317203521728516  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.563917636871338  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5645174980163574  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8585500717163086  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.77987241744995  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.811767578125  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.832787036895752  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.566718578338623  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5673184394836426  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8638248443603516  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.715030670166016  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.76659822463989  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8547840118408203  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5817675590515137  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5823674201965332  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8771586418151855  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.8667311668396  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.91829872131348  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8690071105957031  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.607154369354248  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6077542304992676  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.909942626953125  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.99222707748413  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.04379463195801  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9012103080749512  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6302170753479004  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.63081693649292  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9212837219238281  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.65937519073486  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.71105337142944  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9138226509094238  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.651902198791504  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6525020599365234  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9526662826538086  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.98457050323486  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.03613805770874  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9416418075561523  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.671410083770752  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6720099449157715  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.96337890625  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.7861213684082  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.83768892288208  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9542760848999023  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6908550262451172  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6914548873901367  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9919357299804688  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.03784990310669  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.089417457580566  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.982236385345459  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7143993377685547  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7149991989135742  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0070610046386719  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.84191608428955  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.89348363876343  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9986629486083984  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7318158149719238  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7324156761169434  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0290050506591797  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.992751121520996  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.04431867599487  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0205421447753906  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7512149810791016  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.751814842224121  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0473761558532715  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.00595712661743  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.05752468109131  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0382556915283203  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7741107940673828  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7747106552124023  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0732321739196777  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.93522357940674  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.986791133880615  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.062821865081787  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.795827865600586  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7964277267456055  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0897321701049805  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.96673011779785  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.01829767227173  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.079918384552002  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8099732398986816  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8105731010437012  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1075739860534668  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.830533027648926  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.8821005821228  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0975394248962402  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8322043418884277  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8328042030334473  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1335358619689941  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.91834878921509  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.9699125289917  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

number of input  23056640
----------------------------------------after optimizer
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1713356971740723  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6148290634155273
pure train time :  9.506171464920044
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.014514923095703125
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.031469106674194336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014558792114257812
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8331642150878906  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5642805099487305  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.56488037109375  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8596639633178711  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.73679208755493  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.76722860336304  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8333711624145508  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5661392211914062  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5667390823364258  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8650712966918945  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.76033353805542  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.8119010925293  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.85711669921875  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5932602882385254  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.593860149383545  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8905129432678223  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.74382257461548  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.795390129089355  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8802523612976074  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6140031814575195  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.614603042602539  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9080924987792969  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.77147102355957  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.82303857803345  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.897860050201416  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6314268112182617  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6320266723632812  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9277124404907227  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.796942710876465  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.84851026535034  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9188776016235352  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6475110054016113  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6481108665466309  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9439339637756348  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.713115215301514  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.76468276977539  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9353542327880859  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6702055931091309  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6708054542541504  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.971625804901123  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.96348333358765  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.01505088806152  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9613199234008789  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6942806243896484  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.694880485534668  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.989717960357666  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.03408908843994  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.08565664291382  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9801702499389648  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.718010425567627  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7186102867126465  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.01515531539917  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.03870153427124  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.09026908874512  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0044431686401367  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.733076572418213  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7336764335632324  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0252599716186523  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.76948022842407  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.82104778289795  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.016359806060791  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7539968490600586  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7545967102050781  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0555009841918945  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.08962106704712  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.141188621520996  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0438446998596191  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7773723602294922  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7779722213745117  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0699810981750488  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.99938440322876  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.05095195770264  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0596270561218262  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7925615310668945  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.793161392211914  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0890583992004395  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.948320388793945  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.99988794326782  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0789456367492676  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8122477531433105  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.81284761428833  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1095194816589355  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.05784225463867  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.10940980911255  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.09975004196167  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.828383445739746  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8289833068847656  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1253318786621094  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.91675567626953  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.96831941604614  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

number of input  23058891
----------------------------------------after optimizer
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1631388664245605  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5553927421569824
pure train time :  9.55135440826416
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.014007329940795898
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03133845329284668
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014051675796508789
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8264083862304688  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.560286521911621  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5608863830566406  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8628377914428711  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.76365375518799  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.79567337036133  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.835355281829834  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5720281600952148  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5726280212402344  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8690152168273926  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.933735370635986  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.98530292510986  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8593430519104004  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5937180519104004  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.59431791305542  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8882050514221191  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.80563831329346  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.857205867767334  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8768749237060547  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.609870433807373  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6104702949523926  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9063081741333008  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.738080978393555  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.78964853286743  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8959622383117676  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.62742280960083  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6280226707458496  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9254231452941895  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.965171813964844  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.01673936843872  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9144330024719238  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6471714973449707  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6477713584899902  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9465084075927734  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.66456890106201  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.71613645553589  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9354467391967773  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6695709228515625  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.670170783996582  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9676632881164551  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.87461805343628  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.926185607910156  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9567346572875977  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.685826301574707  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6864261627197266  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9827108383178711  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.859808921813965  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.91137647628784  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9716429710388184  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7003769874572754  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.700976848602295  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0021018981933594  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.72817850112915  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.77974605560303  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9913234710693359  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7265748977661133  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7271747589111328  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.028684139251709  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.996962547302246  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.04853010177612  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0174427032470703  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7497715950012207  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7503714561462402  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0453834533691406  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.05107593536377  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.10264348983765  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0367093086242676  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.767354965209961  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7679548263549805  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0658292770385742  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.79008722305298  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.841654777526855  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0542850494384766  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.787320613861084  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7879204750061035  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0881919860839844  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.96157789230347  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.013145446777344  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0801582336425781  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8148698806762695  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.815469741821289  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.112661361694336  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.01876735687256  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.070334911346436  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1023759841918945  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8369297981262207  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8375296592712402  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1331868171691895  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.045939922332764  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.097503662109375  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

number of input  23056884
----------------------------------------after optimizer
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1738948822021484  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4888389110565186
pure train time :  9.638886213302612
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.015325307846069336
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.038277387619018555
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015386343002319336
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8335990905761719  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5646977424621582  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5652976036071777  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8608102798461914  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.771865367889404  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.80175590515137  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.832402229309082  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5658044815063477  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5664043426513672  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8649148941040039  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.90698289871216  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.958550453186035  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8553009033203125  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5925331115722656  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5931329727172852  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8892889022827148  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.887314319610596  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.93888187408447  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8785481452941895  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.611558437347412  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6121582984924316  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9048881530761719  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.6330885887146  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.68465614318848  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8954868316650391  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6313114166259766  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.631911277770996  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9284510612487793  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.840779304504395  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.89234685897827  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9180264472961426  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6507072448730469  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6513071060180664  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9450855255126953  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.985793590545654  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.03736114501953  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9343156814575195  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.667971134185791  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6685709953308105  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9655437469482422  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.04287672042847  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.094444274902344  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9553112983703613  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6896233558654785  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.690223217010498  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9865765571594238  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.119163513183594  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.17073106765747  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9765644073486328  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.706014633178711  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7066144943237305  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0017404556274414  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.66990375518799  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.721471309661865  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9912233352661133  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7242794036865234  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.724879264831543  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0249409675598145  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.81003189086914  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.86159944534302  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.014582633972168  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.748164176940918  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7487640380859375  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.045285701751709  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.043184757232666  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.09475231170654  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.034764289855957  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7672638893127441  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7678637504577637  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0645685195922852  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.88822603225708  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.93979358673096  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0538606643676758  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.78570556640625  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7863054275512695  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0840930938720703  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.89429235458374  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.94585990905762  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0723576545715332  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8034563064575195  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.804056167602539  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1027746200561523  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.78708553314209  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.83865308761597  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0909724235534668  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8244118690490723  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8250117301940918  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.124192714691162  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.029218673706055  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.08078622817993  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

number of input  23059102
----------------------------------------after optimizer
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.160848617553711  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.441363573074341
pure train time :  9.565507173538208
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.012929677963256836
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.035253286361694336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.012972354888916016
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8299627304077148  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5643377304077148  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5649375915527344  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8601417541503906  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.67764377593994  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.71005630493164  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8351411819458008  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5694003105163574  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.570000171661377  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8644871711730957  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.95609951019287  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.00766706466675  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8553333282470703  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5864276885986328  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5870275497436523  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8819794654846191  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.755874156951904  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.80744171142578  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.871312141418457  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6032681465148926  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.603868007659912  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9013752937316895  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.63545370101929  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.687021255493164  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8930244445800781  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6276302337646484  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.628230094909668  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9249520301818848  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.75560283660889  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.807170391082764  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9167852401733398  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6517281532287598  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6523280143737793  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9464802742004395  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.94749927520752  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.9990668296814  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9366474151611328  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6713066101074219  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6719064712524414  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9656510353088379  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.814510345458984  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.86607789993286  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9575209617614746  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.688615322113037  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6892151832580566  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9835772514343262  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.69310665130615  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.74467420578003  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9736824035644531  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7065787315368652  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7071785926818848  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0048422813415527  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.958927631378174  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.01049518585205  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9957332611083984  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7226471900939941  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7232470512390137  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0189495086669922  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.77704477310181  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.828612327575684  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.009416103363037  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7449655532836914  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.745565414428711  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0475239753723145  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.15271520614624  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.20428276062012  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0401959419250488  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.771186351776123  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7717862129211426  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0648937225341797  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.94888401031494  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.00045156478882  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0554924011230469  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7887558937072754  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.789355754852295  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0871729850769043  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.10565423965454  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.15722179412842  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0781140327453613  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.813344955444336  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8139448165893555  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1093764305114746  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.96675109863281  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.01831865310669  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.103104591369629  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8341565132141113  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8347563743591309  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1282272338867188  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.990498065948486  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.0420618057251  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

number of input  23050425
----------------------------------------after optimizer
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1659374237060547  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3857035636901855
pure train time :  9.58806562423706
the output layer 
self.num_batch (get_in_degree_bucketing) 15
get_in_degree_bucketing dst global nid length 1207179
len(bkt)  132028
len(bkt)  86214
len(bkt)  63905
len(bkt)  51188
len(bkt)  42783
len(bkt)  37196
len(bkt)  32534
len(bkt)  29230
len(bkt)  25982
len(bkt)  23894
len(bkt)  21638
len(bkt)  19992
len(bkt)  18412
len(bkt)  17082
len(bkt)  15873
len(bkt)  14921
len(bkt)  13503
len(bkt)  12864
len(bkt)  11987
len(bkt)  11400
len(bkt)  10745
len(bkt)  9899
len(bkt)  9352
len(bkt)  8764
len(bkt)  233722
total indegree bucketing result ,  955108
total zero degree bucketing result ,  252071
the number of total output nodes match !!!! 
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
random partition time  0.014756441116333008
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02881312370300293
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.014798402786254883
step  0
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8286576271057129  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.563032627105713  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5636324882507324  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8611927032470703  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.64763832092285  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.67896842956543  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  1
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8349952697753906  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5674552917480469  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5680551528930664  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8623752593994141  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.7082200050354  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.75978755950928  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  2
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8522090911865234  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5845451354980469  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.5851449966430664  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8813943862915039  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.69322347640991  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.74479103088379  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  3
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8719253540039062  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6015877723693848  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6021876335144043  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.898536205291748  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.77493143081665  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.82649898529053  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  4
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.8889565467834473  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.621842861175537  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6224427223205566  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9223365783691406  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.93727731704712  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.988844871520996  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  5
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9121103286743164  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.641031265258789  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6416311264038086  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9382128715515137  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.74931287765503  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.800880432128906  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  6
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.928184986114502  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.662559986114502  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6631598472595215  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9637351036071777  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.83325529098511  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.884822845458984  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  7
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9534177780151367  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.683225154876709  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.6838250160217285  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9791927337646484  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.86847686767578  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.92004442214966  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  8
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9685573577880859  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7046947479248047  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7052946090698242  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0052447319030762  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.0889778137207  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.14054536819458  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  9
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 0.9954929351806641  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7254180908203125  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.726017951965332  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0193676948547363  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.87826633453369  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.92983388900757  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  10
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0090913772583008  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.740473747253418  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7410736083984375  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0406007766723633  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.79614877700806  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.847716331481934  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  11
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0302066802978516  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7663159370422363  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7669157981872559  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0660228729248047  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.16238784790039  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.21395540237427  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  12
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0565123558044434  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.7892985343933105  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.78989839553833  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0842804908752441  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.1134467124939  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.16501426696777  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  13
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0725188255310059  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.802912712097168  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8035125732421875  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1001591682434082  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.80192232131958  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 36.85348987579346  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

step  14
----------------------------------------before batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.0908784866333008  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8290386199951172  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

<class 'torch.Tensor'>
cuda:0
----------------------------------------after  batch labels to device
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.8296384811401367  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1300873756408691  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.187561988830566  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 37.23912954330444  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

number of input  23046195
----------------------------------------after optimizer
 Nvidia-smi: 64.61175537109375 GB
    Memory Allocated: 1.1686182022094727  GigaBytes
Max Memory Allocated: 38.24254655838013  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.347853899002075
pure train time :  9.53800630569458
epoch_time_list  [47.69123840332031, 46.050679206848145, 47.63678431510925, 50.315009355545044, 45.30167269706726, 44.566736698150635, 45.54947757720947, 46.49418020248413, 45.079766273498535, 45.017791986465454, 45.18956112861633, 47.32302165031433, 45.33788585662842, 45.369184255599976, 44.9631769657135, 45.32126498222351, 46.86546802520752, 45.961976528167725, 45.705190658569336, 45.09687638282776]

loading_time list   [0.8764469623565674, 0.8991718292236328, 0.6617991924285889, 1.4522240161895752, 0.7975130081176758, 0.5562729835510254, 0.6306426525115967, 0.6126763820648193, 0.7186145782470703, 0.6290960311889648, 0.6252105236053467, 0.6697700023651123, 0.844184160232544, 0.7474362850189209, 0.6986465454101562, 0.6756112575531006, 0.7060437202453613, 0.8963167667388916, 0.7276830673217773, 0.7373876571655273]

 data loader gen time  30.9455509185791
	---backpack schedule time  [0.18892812728881836, 0.1812593936920166, 0.17609500885009766, 0.17254877090454102, 0.1558067798614502, 0.1350548267364502, 0.14525055885314941, 0.16611742973327637, 0.1779477596282959, 0.1665654182434082, 0.15162420272827148, 0.16688013076782227, 0.1704118251800537, 0.14032649993896484, 0.15039610862731934, 0.16814947128295898, 0.1677248477935791, 0.2055208683013916, 0.16931962966918945, 0.17039871215820312]
	---connection_check_time_list  [6.005985260009766, 5.949750900268555, 6.500235557556152, 10.665979146957397, 6.035352945327759, 5.862921237945557, 6.803940296173096, 7.63054895401001, 5.6292173862457275, 5.565549850463867, 5.5766496658325195, 7.708982229232788, 5.842832326889038, 5.5766921043396, 5.534296274185181, 5.7026026248931885, 7.06589412689209, 6.080278396606445, 5.582906246185303, 5.515828371047974]
	---block_gen_time_list  [3.509937047958374, 3.410963535308838, 3.310999870300293, 3.1464009284973145, 2.7520408630371094, 2.635767698287964, 2.6601572036743164, 2.963040828704834, 2.9643309116363525, 3.0168042182922363, 3.1960575580596924, 3.2400994300842285, 3.024513006210327, 3.228271961212158, 2.8843584060668945, 3.0294108390808105, 3.3174850940704346, 3.175994396209717, 3.3841447830200195, 2.8918089866638184]
training time  [14.838653326034546, 13.317199230194092, 14.477477788925171, 12.781558752059937, 13.547905683517456, 13.33321475982666, 13.245088338851929, 13.073856830596924, 13.542842864990234, 13.517987966537476, 13.43433690071106, 13.277651309967041, 13.314420461654663, 13.444024085998535, 13.362338781356812, 13.34118127822876, 13.286343097686768, 13.28415584564209, 13.475568771362305, 13.386239290237427]
---feature block loading time  [3.8136825561523438, 4.249333381652832, 4.69903302192688, 3.4911253452301025, 3.974184513092041, 3.784543991088867, 3.621551513671875, 3.494413137435913, 3.9255940914154053, 3.9099085330963135, 3.791008234024048, 3.663266897201538, 3.74225115776062, 3.8603086471557617, 3.824227809906006, 3.7620391845703125, 3.6277992725372314, 3.698456287384033, 3.8679113388061523, 3.828458547592163]


epoch_time avg   45.57145199179649
loading_time avg   0.7045691013336182
 data loader gen time avg 31.468443289399147
	---backpack schedule time avg 0.1629684418439865
	---connection_check_time avg  6.107155814766884
	---block_gen_time avg  3.022767886519432
training time  13.366697266697884
---feature block loading time  3.7734951972961426
pure train time per /epoch  [11.007606506347656, 9.048245906829834, 9.746315240859985, 9.255988359451294, 9.54361343383789, 9.518433332443237, 9.590937376022339, 9.550934076309204, 9.586116552352905, 9.574435710906982, 9.612712383270264, 9.583921194076538, 9.543822526931763, 9.55463457107544, 9.506171464920044, 9.55135440826416, 9.638886213302612, 9.565507173538208, 9.58806562423706, 9.53800630569458]
pure train time average  9.547267100390266
num_input list  [23052596, 23057359, 23049593, 23050452, 23050320, 23051441, 23054832, 23060614, 23053565, 23053442, 23055640, 23049557, 23051408, 23052670, 23056640, 23058891, 23056884, 23059102, 23050425, 23046195]
num_input  average  23053581.3
